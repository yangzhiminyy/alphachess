(self.webpackChunk_genie_chat_webview_app=self.webpackChunk_genie_chat_webview_app||[]).push([[2239],{861:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.TextField=void 0,a(62799);const s=a(60139),c=i(a(48431));n.TextField=c.forwardRef((({leftIcon:e,rightIcon:n,...a},r)=>c.createElement(s.TextField.Root,{ref:r,...a,autoComplete:"off",className:`${a.className||""} text-field`},e&&c.createElement(s.TextField.Slot,null,e),n&&c.createElement(s.TextField.Slot,null,n))))},883:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=r(a(76427));n.default=o.default},1179:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.DropdownType=void 0,n.Dropdown=function Dropdown(e){const[n,a]=(0,u.useState)(e.activeKey||""),[r,o]=(0,u.useState)((e.options||[]).map((n=>({...n,active:String(n.key)===String(e.activeKey)}))));return(0,u.useEffect)((()=>{a(e.activeKey||""),o(e.options.map((n=>({...n,active:String(n.key)===String(e.activeKey)}))))}),[e.activeKey,e.options]),c.createElement(s.DropdownMenu.Root,{open:e.open,onOpenChange:e.onOpenChange},c.createElement(s.DropdownMenu.Trigger,null,e.children),c.createElement(s.DropdownMenu.Content,{className:"dropdown"},e.header,r.map(((r,l)=>{var i;return r.type===d.Separator?c.createElement(s.DropdownMenu.Separator,{key:r.key||l}):r.type===d.SeparatorLabel?c.createElement(s.DropdownMenu.Label,{key:r.key||l,style:{color:"gray"}},r.labelAlias||r.label):c.createElement(s.DropdownMenu.Item,{onClick:n=>{var a;n.stopPropagation(),null===(a=e.onChange)||void 0===a||a.call(e,r)},shortcut:r.shortcut,key:r.key||l,className:n===String(r.key||l)?"active":"",onMouseEnter:()=>{a(String(r.key||l)),o(e.options.map((e=>({...e,active:String(e.key||l)===String(r.key||l)}))))}},(null===(i=e.itemRender)||void 0===i?void 0:i.call(e,r))||r.label)}))))},a(13173);const s=a(60139),c=i(a(48431)),u=a(48431);var d;!function(e){e.Default="default",e.Separator="separator",e.SeparatorLabel="separatorLabel"}(d||(n.DropdownType=d={}))},1418:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(4046),n)},1466:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconLeft=void 0;const o=r(a(48431));n.IconLeft=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M10.3469 3.30566L5.65283 7.99972L10.3469 12.6938",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},1752:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.DevMode=DevMode,a(45974);const c=a(15985),u=a(84176),d=a(69022),f=a(19606),m=s(a(48431)),p=a(15389),v=a(35372),getTag=(e,n)=>e.tagName===n?e:e.parentElement?getTag(e.parentElement,n):void 0;function DevMode(){(0,v.useActivePage)();const{formatMessage:e}=(0,f.useIntl)(),{state:n=[]}=(0,p.useLocation)(),[a,r]=m.useState({}),o={input:"text",nInput:"number",date:"date",datetime:"datetime-local",month:"month"},getArgs=(e,n)=>e.map((e=>m.createElement("label",{className:"arg-item "+(e.required?"required":""),key:e.argName},e.argName,": ",((e,n)=>{switch(e.type){case"input":case"nInput":case"date":case"datetime":case"month":return m.createElement("input",{value:a[n+e.argName]||e.value,className:"arg-input",type:o[e.type],required:e.required,onInput:o=>{o.stopPropagation(),r({...a,[n+e.argName]:o.target.value})},maxLength:225,onClick:e=>e.stopPropagation()});case"select":return m.createElement("select",{required:e.required,className:"arg-input",onClick:e=>e.stopPropagation(),onChange:o=>{o.stopPropagation(),r({...a,[n+e.argName]:o.target.value})}},(e.options||[]).map((e=>"object"!=typeof e?m.createElement("option",{value:e,key:e},e):m.createElement("option",{value:e.value,key:e.value},e.label))))}})(e,n)))),clickDebugItem=e=>{const n=getTag(e.target,"LI"),r=getTag(e.target,"UL"),o=null==r?void 0:r.dataset.service;if(n&&n.dataset.debug&&o){const{method:e,args:r,key:l}=JSON.parse(n.dataset.debug),i=c.ContainerUtil.get(d.DevService),s=[];if(!r.every((e=>{const n=a[l+e.argName]||e.value;return(!e.required||null!==n&&""!==n&&void 0!==n&&0!==n)&&(s.push(n),!0)})))return;i.exec(o,e,s)}};return m.createElement("div",null,n.map((n=>m.createElement("div",{className:"service-container",key:n.key},m.createElement("h4",{className:"service-title"},e({id:n.group})),m.createElement("ul",{className:"method-group","data-service":n.key,onClick:clickDebugItem},n.methods.map((n=>m.createElement("li",{className:"method-item","data-debug":JSON.stringify(n),key:n.key},m.createElement("span",{className:"method-name"},e({id:n.label})),getArgs(n.args,n.key)))))))))}let h=class{};h=i([(0,u.View)({index:!1,path:"/dev",component:DevMode})],h),n.default=h},1991:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(39232),n),o(a(56797),n),o(a(42810),n)},2700:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.ChatSelectMode=function ChatSelectMode(){const e=s.ContainerUtil.get(h.ChatModeController),n=(0,d.useContext)(v.GlobalContext),a=(0,u.useIntl)(),t=e=>a.formatMessage({id:e}),[r,o]=(0,d.useState)(""),[l,i]=(0,d.useState)("craft"),[g,y]=(0,d.useState)(!1),[b,_]=(0,d.useState)(!1),[C,E]=(0,d.useState)({}),[w,O]=(0,d.useState)(!1),M={craft:d.default.createElement(p.CraftIcon,null),ask:d.default.createElement(p.AskIcon,null)},S={craft:f.isMacOs?"⌘​I":"Alt+I",ask:f.isMacOs?"⌘​L":"Alt+L"},P={isPlan:{labelAlias:t("Generating Plan"),label:"isPlan",tip:t("After enabling, it will automatically generate a task plan for you")},autoRun:{labelAlias:t("Auto Run"),label:"autoRun",tip:t("After enabling, the terminal will automatically run commands for you without manual confirmation")},autoModifyFile:{labelAlias:t("Auto Modify"),label:"autoModifyFile",tip:t("After enabling, it will automatically modify files for you without manual confirmation")},...w?{codebase:{labelAlias:t("Search Codebase"),label:"codebase",tip:t("After enabling, the plugin will automatically perform intent recognition and index the local codebase")}}:{}},capitalizeFirstLetter=e=>{const[n,...a]=e;return n.toUpperCase()+a.join("")},T=Object.keys(C).map((e=>({label:d.default.createElement("div",null,capitalizeFirstLetter(e)," ",d.default.createElement("span",{style:{color:"#808080"}},S[e]||"")),value:e,key:e}))),j=Object.fromEntries(Object.keys(C).map((e=>[e,Object.keys(C[e]).filter((e=>!!P[e])).map((n=>({...P[n],value:C[e][n]})))]))),k=j[l]||j[Object.keys(j)[0]]||[],I=T.find((e=>e.value===r)),itemRender=(e,n=!0)=>{var a;return d.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",gap:45}},d.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:4}},M[e.value],d.default.createElement("span",null,e.label),d.default.createElement("span",null,e.shortcut)),n&&d.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:6}},(null===(a=j[e.value])||void 0===a?void 0:a.length)>0&&d.default.createElement(p.SettingIcon,{style:{visibility:e.active?"visible":"hidden"},onClick:n=>{i(e.value),n.stopPropagation(),_(!0),y(!1)}}),r===e.value&&d.default.createElement(p.CheckIcon,null)))},getBaseInfo=async()=>{await(async()=>{const n=await e.getChatModeSettings();n&&E(n)})()};return(0,d.useEffect)((()=>{getBaseInfo();const n=[e.onDidWindowStateChange((e=>e&&getBaseInfo())),e.onDidChangeModeSettings(getBaseInfo),e.onDidChangeCodebaseStatus(O)];return()=>n.forEach((e=>e.unsubscribe()))}),[]),(0,d.useEffect)((()=>{(async()=>{if(!T.length)return;const n=await e.getChatMode();T.find((e=>e.value===n))?o(n):(o(c.ChatType.CRAFT),e.updateChatMode(c.ChatType.CRAFT))})();const a={};Object.values(C).forEach((e=>{Object.assign(a,e)})),null==n||n.setGlobalState({...n.globalState,...a})}),[C]),d.default.createElement(d.default.Fragment,null,d.default.createElement(m.Dropdown,{header:d.default.createElement("div",{className:"chat-mode-setting-header"},d.default.createElement(p.ChevronLeftIcon,{style:{cursor:"pointer"},onClick:()=>{_(!1),y(!0)}}),d.default.createElement("span",null,capitalizeFirstLetter(l)," ",t("settings"))),options:k,itemRender:n=>{const a=document.getElementById("chat-container"),r=null==a?void 0:a.clientWidth,o=d.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",height:"100%",alignItems:"center"},onClick:e=>e.stopPropagation()},d.default.createElement("label",{htmlFor:n.label,style:{flex:1,cursor:"pointer"}},d.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:4,paddingRight:45}},d.default.createElement("span",null,n.labelAlias))),d.default.createElement(m.Switch,{id:n.label,size:"1",checked:n.value,onClick:e=>e.stopPropagation(),onCheckedChange:a=>{const r=n.label;C[l][r]=a,E({...C}),e.updateChatModeSettings(C)}}));return r>h.SHOW_SETTING_TIP_MIN_WIDTH?d.default.createElement(m.Tooltip,{side:"right",sideOffset:20,content:n.tip,style:{width:189}},o):o},open:b,onOpenChange:e=>{_(e)}},d.default.createElement("div",null)),d.default.createElement(m.Dropdown,{open:g,onOpenChange:e=>{y(e)},options:T,itemRender,onChange:n=>{o(n.value),e.updateChatMode(n.value)},activeKey:String((null==I?void 0:I.key)||"")},d.default.createElement("div",{className:"chat-model-button"},d.default.createElement("span",{className:"current-chat-model"},I?itemRender(I,!1):t("Not Selected")),d.default.createElement("div",{className:"chat-model-button-icon"}))))},a(38506);const s=a(15985),c=a(69022),u=a(19606),d=i(a(48431)),f=a(81878),m=a(64900),p=a(48924),v=a(99095),h=a(50473)},3760:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),a(8622);const o=a(15985),l=a(69022),i=a(19606),s=r(a(48431)),c=a(64900),u=a(19600),d=a(88246);n.default=({official_url:e,name:n,logo_url:a,tag:r,description:f,installStatus:m,installMcpServer:p})=>{const v=(0,i.useIntl)(),translations=e=>v.formatMessage({id:e});return s.default.createElement("div",{className:"mcp-market-card"},s.default.createElement("div",{className:"mcp-market-card-header"},s.default.createElement("div",{className:"mcp-market-card-title"},a&&s.default.createElement("div",{className:"mcp-market-card-title-icon"},s.default.createElement(u.Avatar,{src:a,size:"small"})),s.default.createElement("div",{className:"mcp-market-card-title-text",onClick:()=>(async e=>{o.ContainerUtil.get(l.McpViewService).openExternal(e)})(e)},s.default.createElement("div",{className:"mcp-market-card-title-text-title"},n)),s.default.createElement("div",{className:"mcp-market-card-title-tag"},r)),s.default.createElement("div",{className:"mcp-market-card-extra"},m===d.InstallStatus.Installed&&s.default.createElement(c.Button,{size:"small",variant:"secondary",disabled:!0},translations("Installed")),m===d.InstallStatus.Installing&&s.default.createElement(c.Button,{size:"small",variant:"secondary",disabled:!0},translations("Installing")),m===d.InstallStatus.Uninstalled&&s.default.createElement(c.Button,{size:"small",variant:"secondary",onClick:()=>p(n)},translations("Install")))),s.default.createElement("div",{className:"mcp-market-card-body"},f))}},4046:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.CompatibilityShim=CompatibilityShim,a(20636);const c=a(15985),u=a(59659),d=a(69022),f=a(19606),m=s(a(48431)),p=a(63306);function CompatibilityShim(){const e=(0,f.useIntl)(),n=c.ContainerUtil.get(d.ChatViewService),[a,r]=(0,m.useState)(!0);(0,m.useEffect)((()=>{n.checkCompatibility().then(r)}),[]);const o={tip:e.formatMessage({id:"The extension requires VSCode 1.70 or later to function properly. Please upgrade your VSCode version."})};return m.default.createElement("div",{className:"code-buddy-compatibility-shim",style:{display:a?"none":"flex"}},m.default.createElement("div",{className:"code-buddy-compatibility-shim-text"},o.tip))}let v=class{};v=i([(0,u.Widget)({area:p.ChatBodyConversionArea.CompatibilityShim,component:CompatibilityShim})],v),n.default=v},4841:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ChatMessageRenderer=void 0,n.ChatMessageRenderer=Symbol("ChatMessageRenderer")},4882:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.messageContextSubject=n.CurrentConversationContext=n.CurrentMessageContext=void 0;const r=a(48431),o=a(97317);n.CurrentMessageContext=(0,r.createContext)({message:void 0}),n.CurrentConversationContext=(0,r.createContext)({messages:[],allVersions:[]}),n.messageContextSubject=new o.Subject},4896:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconDelete=void 0;const o=r(a(48431));n.IconDelete=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("g",null,o.default.createElement("path",{d:"M3.625 3.91699V13.8337H12.375V3.91699H3.625Z",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M6.8335 6.83301V10.6247",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M9.1665 6.83301V10.6247",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M2.1665 3.91699H13.8332",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M5.66663 3.91667L6.62592 1.5H9.39328L10.3333 3.91667H5.66663Z",strokeWidth:"1.3",strokeLinecap:"round"})))},4913:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.ChatInputControllerImpl=void 0;const l=a(15985),i=a(76243),s=a(69022),c=a(63306),u=a(73e3),d=a(20421),f=a(50473),m=a(18196);let p=class ChatInputControllerImpl{constructor(){this.variables=[],this.remoteCommands=[],this.knowledges=[],this.currentConversationId="",this.t=e=>e,this.ignoreClearInput=!1,this.triggers=["@","/"],this.isEnableAutoAddCurrentFile=!0,this.remoteAgents=[],this.commands=[],this.agents=[],this.models=[]}init(){this.getBaseInfo().finally((()=>{this.chatViewService.handleWebviewReady()})),this.newChatViewServie.ignoreClearInputSubject.subscribe((e=>{this.ignoreClearInput=!!e})),this.chatViewService.conversationObserver.subscribe((e=>{this.updateConversationId(e.id)})),this.configViewService.onDidChange((({key:e,value:n})=>{var a;e===i.CHAT_SELECTED_MODE&&(null===(a=this.chatInputApi)||void 0===a||a.focus())})),this.chatViewService.addFileObserver.subscribe((e=>{var n,a;if(e){let r=e.fileInfos.map((n=>({label:n.relativePath,value:n.fileName,type:e.type,selection:n.selection,code:n.code,mentionType:n.type||f.IMentionType.file})));e.type===s.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE?this.currentFileInfo=r[0]:(null===(n=this.chatInputApi)||void 0===n||n.focus(),this.isEnableAutoAddCurrentFile=!1),this.isEnableAutoAddCurrentFile||(r=r.filter((e=>e.type!==s.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE))),null===(a=this.chatInputApi)||void 0===a||a.addContexts(r)}})),this.chatViewService.codeActionObserver.subscribe((async e=>{var n,a,r,o,l,i;if(e){if(!1===(null===(n=e.options)||void 0===n?void 0:n.autoSend)&&e.prompt)return void(null===(a=this.chatInputApi)||void 0===a||a.input(e.prompt));this.currentFileInfo||await this.chatViewService.triggerSelectionChange(),null===(r=this.chatInputApi)||void 0===r||r.focus();const c=[];e.command&&c.push({type:"command",content:`/${e.command} `,expandContent:(null===(o=this.commands.find((n=>n.name===e.command)))||void 0===o?void 0:o.expand)||""}),e.prompt&&c.push({type:"normal",content:e.prompt,expandContent:e.prompt});const u={command:e.command,range:e.range,inputPhrase:c};(null===(l=e.fileInfos)||void 0===l?void 0:l.length)&&(u.selectionContexts=[],e.fileInfos.forEach((e=>{u.selectionContexts.push({label:e.relativePath,value:e.fileName,type:s.ChatSelectionInfoType.SELECT_FILE,mentionType:e.type||f.IMentionType.file}),c.push({type:"normal",content:" ",expandContent:" "},{type:e.type||f.IMentionType.file,content:`@${e.fileName}`,expandContent:`@${e.type||f.IMentionType.file}:${e.relativePath} `})}))),this.sendRequest(u,{code:e.code,disableRecordHistory:!0,autoAddCurrentFile:!e.range&&!(null===(i=e.fileInfos)||void 0===i?void 0:i.length)})}})),u.chatActionSubject.subscribe((e=>{var n;e&&(null===(n=this.chatInputApi)||void 0===n||n.focus(),this.sendRequest({inputText:e.prompt,chatType:e.chatType,codebase:e.codebase}))})),this.chatViewService.conversationObserver.subscribe((e=>{var n,a;this.isEnableAutoAddCurrentFile=!e.id,e.id||null===(n=this.chatInputApi)||void 0===n||n.updateContexts((e=>[...e.filter((e=>e.type===s.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE))])),this.chatViewService.triggerSelectionChange(),null===(a=this.chatInputApi)||void 0===a||a.focus()})),this.chatViewService.visibleObserver.subscribe((e=>{var n;e&&(null===(n=this.chatInputApi)||void 0===n||n.focus())}))}get chatInputApi(){var e;return null===(e=this.inputApi)||void 0===e?void 0:e.current}updateConversationId(e){var n,a;this.currentConversationId=e,this.ignoreClearInput||null===(n=this.chatInputApi)||void 0===n||n.clearInput(),this.newChatViewServie.ignoreClearInputSubject.next(!1),this.chatViewService.triggerSelectionChange(),null===(a=this.chatInputApi)||void 0===a||a.focus()}getTopic(e){var n,a;const r=null===(n=e.find((e=>"topic"===e.type)))||void 0===n?void 0:n.content.trim().replace(/^@/,"");if(r)return r;const o=this.getCmd(e);for(const e of this.remoteAgents)if(null===(a=e.commands)||void 0===a?void 0:a.length)for(const n of e.commands){if(n.name===o)return e.name.replace(/^@/,"")}return""}getCmd(e){var n;return(null===(n=e.find((e=>"command"===e.type)))||void 0===n?void 0:n.content.trim().replace(/^\//,""))||""}registerIntl(e){this.t=e}registerChatInputApi(e,n=!1){e&&(n&&(this.inputApiTmp=this.inputApi),this.inputApi=e)}removeChatInputApi(){this.inputApi=this.inputApiTmp,this.inputApiTmp=void 0}validCommand(e){return this.commands.some((n=>n.name===e))}async triggerAddToChat(e){await this.chatViewService.triggerAddToChat(e)}getFollowingPlaceholder(e){const n=this.getCmd(e),a=this.getTopic(e),r=this.remoteAgents.find((e=>e.name===a));if(!n&&!r)return"";const o=this.commands.find((e=>e.name===n));return o?this.t(o.description):this.t((null==r?void 0:r.description)||"")}async getInitialContexts(){const e=await this.configViewService.get(f.CONVERSATION_SELECT_CONTEXTS_MAP);return d.JsonUtils.safeParse(e||"")||{}}async updateInitialContexts(e){await this.configViewService.update(f.CONVERSATION_SELECT_CONTEXTS_MAP,d.JsonUtils.safeStringify(e)||"")}async getBaseInfo(){await Promise.allSettled([this.productViewService.getKnowledges().then((e=>{const n=[],a=[];e.forEach((e=>{"common"===e.type?n.push(e):a.push(e)})),n.length&&(n[0].separatorLabel=this.t("Official Knowledge Base")),a.length&&(a[0].separatorLabel=this.t("Custom Knowledge Base")),this.knowledges=[...a,...n]})),this.productViewService.getVariables().then((e=>this.variables=e)),this.productViewService.getAgents().then((e=>this.agents=e)),this.productViewService.getModels().then((e=>this.models=e)),Promise.all([this.productViewService.getCustomAgents(),this.productViewService.getCommands()]).then((([e,n])=>{const a=e.filter((e=>"enterprise"===e.publisherType)),r=a.flatMap((e=>e.commands||[])).filter((e=>"default"!==e.name));this.remoteAgents=a,this.commands=[...n,...r],this.remoteCommands=r.filter((e=>!e.disabled)).map((e=>e.name))})),this.chatViewService.getCurrentConversation().then((e=>{this.currentConversationId=e.id}))])}async search(e="",n="",a="",r=[]){if(!e)return[];const o=this.getTopic(r),l=await this.configViewService.get(i.CHAT_SELECTED_MODE),s=this.agents.find((e=>e.name===l)),c=((null==s?void 0:s.commands)||[]).concat(this.remoteCommands),u=(null==s?void 0:s.optionalVariables)||[];if("/"===e){if(o&&a.trim().startsWith(`@${o} /`)){const e=this.remoteAgents.find((e=>e.name===o));return(null==e?void 0:e.commands)?e.commands.filter((e=>"default"!==e.name)).map((e=>({id:e.name,label:this.t(e.description||e.name),value:e.name,type:f.IMentionType.command}))):[]}return!o&&/^\//.test(a)?this.commands.filter((e=>!c.length||c.includes(e.name))).map((e=>({id:e.name,label:this.t(e.description||e.name),value:e.name,type:f.IMentionType.command,expand:"expand"in e?e.expand:this.t(e.description||e.name)}))):[]}const d=this.variables.filter((e=>!u.length||u.includes(e.id))).map((e=>({...e,label:this.t(e.description)||e.name,value:e.name})));"/"!==e&&!n&&d.some((e=>"file"===e.type))&&d.unshift({value:f.IMentionType.recentFile,label:"最新打开",type:f.IMentionType.recentFile,children:(await this.fileSearchViewService.getRecentFiles({resultNum:50})).map((e=>({value:e.fileName,label:e.relativePath,type:f.IMentionType.file})))||[]});for(const e of d)if(e.type===f.IMentionType.knowledge)e.children=this.knowledges.map(((e,n)=>({label:e.description||e.name,value:e.name,separatorLabel:e.separatorLabel,type:f.IMentionType.knowledge,knowledgeBaseId:e.id})));else if(e.type===f.IMentionType.file){const a=await this.fileSearchViewService.getWorkspaceFiles({search:n,resultNum:50});e.children=a.map((e=>({value:e.fileName||e.folderName,label:e.relativePath,type:e.type})))||[]}else e.type===f.IMentionType.agent&&(e.children=this.remoteAgents.filter((e=>"default"!==e.name)).map((e=>({label:e.description||e.name,value:e.name,type:f.IMentionType.agent})))||[]);return d.filter((e=>{var n;return e.type!==f.IMentionType.agent||(null===(n=e.children)||void 0===n?void 0:n.length)}))}async showContext(e){if(e.mentionType===f.IMentionType.recentFile||e.mentionType===f.IMentionType.file||e.mentionType===f.IMentionType.code){const n=e.selection?JSON.parse(JSON.stringify(e.selection)):void 0;n&&(n.start.line-=1,n.end.line-=1),await this.fileSearchViewService.openFile(e.label,n?[n.start,n.end]:void 0)}}async sendRequest(e,n){var a,r,o,i,u,d;null!==(a=e.agentName)&&void 0!==a||(e.agentName=this.getTopic(e.inputPhrase||[])),null!==(r=e.command)&&void 0!==r||(e.command=this.getCmd(e.inputPhrase||[]));const p=this.chatStateViewService.getState();if(!(null==e?void 0:e.inputText)&&!(null==e?void 0:e.command)&&!(null===(o=null==e?void 0:e.inputPhrase)||void 0===o?void 0:o.length)||p===s.ChatState.TALKING||p===s.ChatState.PLAN)return;let v=e.contexts||[];const h=e.command||"",g=this.commands.find((e=>e.name===h));if(g&&"requiredVariables"in g)for(const e of g.requiredVariables){const n=v.some((n=>{var a;return"string"==typeof e?n.mentionType===e:!!(null===(a=e.oneOf)||void 0===a?void 0:a.length)&&e.oneOf.includes(n.mentionType)}));if(!n&&e===f.IMentionType.file)return void this.chatViewService.showMessageInfo("error",this.t("Please select at least one piece of code or a file"))}const y=(0,l.generateUUUID)();localStorage.setItem(c.CONVERSATION_REQUEST_ID_STORAGE_KEY,y);const[b,_,C]=await Promise.all([this.chatModeController.getChatModelMap(),this.chatModeController.getChatMode(),this.chatModeController.getChatModeSettings()]),E=(null==C?void 0:C.ask)||{},w=(null==C?void 0:C.craft)||{},O="ask"===_?!!E.codebase:!!w.codebase,M=e.inputPhrase||[];M.forEach((e=>{"command"===e.type&&g&&"expand"in g&&g.expand&&e.content.trim()===`/${null==g?void 0:g.name}`&&(e.expandContent=g.expand)})),this.currentFileInfo&&((null==e?void 0:e.range)?v=[{...this.currentFileInfo,selection:e.range,mentionType:f.IMentionType.code,code:null==n?void 0:n.code}]:(null==n?void 0:n.autoAddCurrentFile)&&(v=[{...this.currentFileInfo}]));const{convertSelectionContextInfoToReferences:S}=(0,m.useReference)(),P={conversationId:this.currentConversationId,requestId:y,agent:(null===(i=v.find((e=>e.mentionType===f.IMentionType.agent)))||void 0===i?void 0:i.value)||e.agentName||"",command:h,prompt:M.filter((e=>![f.IMentionType.agent].includes(e.type))).map((e=>e.expandContent)).join("")||e.inputText,codebase:O,inputPhrase:M,activeEditorReferenceEnabled:v.some((e=>e.type===s.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE)),references:S(v),selectionContexts:v,chatType:e.chatType||_||s.ChatType.CRAFT,model:b[_||s.ChatType.CRAFT],requestSource:s.ChatRequestSource.CHAT,isPlan:!!(null==w?void 0:w.isPlan),autoRun:!!(null==w?void 0:w.autoRun),autoModifyFile:!!(null==w?void 0:w.autoModifyFile)};this.chatStateViewService.event(s.ChatStateEvent.INPUT);try{(null==n?void 0:n.disableRecordHistory)||null===(u=this.chatInputApi)||void 0===u||u.recordHistory(),null===(d=this.chatInputApi)||void 0===d||d.clearInput(),await this.chatViewService.getChatCompletions(P)}catch(e){P.conversationId?(P.conversationId="",this.chatViewService.getChatCompletions(P)):this.chatStateViewService.event(s.ChatStateEvent.ERROR)}}async stopRequest(){const e=localStorage.getItem(c.CONVERSATION_REQUEST_ID_STORAGE_KEY);e&&this.chatViewService.abort(this.currentConversationId,e),this.chatStateViewService.event(s.ChatStateEvent.STOP)}};n.ChatInputControllerImpl=p,r([(0,l.Autowired)(i.ConfigViewService),o("design:type",Object)],p.prototype,"configViewService",void 0),r([(0,l.Autowired)(i.ProductViewService),o("design:type",Object)],p.prototype,"productViewService",void 0),r([(0,l.Autowired)(i.FileSearchViewService),o("design:type",Object)],p.prototype,"fileSearchViewService",void 0),r([(0,l.Autowired)(s.ChatViewService),o("design:type",Object)],p.prototype,"chatViewService",void 0),r([(0,l.Autowired)(s.ChatStateViewService),o("design:type",Object)],p.prototype,"chatStateViewService",void 0),r([(0,l.Autowired)(f.ChatModeController),o("design:type",Object)],p.prototype,"chatModeController",void 0),r([(0,l.Autowired)(s.NewChatViewServie),o("design:type",Object)],p.prototype,"newChatViewServie",void 0),r([(0,l.PostConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],p.prototype,"init",null),n.ChatInputControllerImpl=p=r([(0,l.Component)(f.ChatInputController)],p)},5176:(e,n,a)=>{"use strict";a.r(n)},6044:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(23675),n)},6457:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toDiff=n.padDiffSign=n.diff=void 0;const a="// FILEPATH:",r="// --------------------------";n.diff=e=>{var n,o;let l="",i=[],s=[];const c=e.trim().split("\n");if(!(null===(n=c[0])||void 0===n?void 0:n.startsWith(a))||(null===(o=c[c.length-1])||void 0===o?void 0:o.trim())!==r)return{filePath:"",originalCode:[],newCode:[],valid:!1};l=c[0].replace(a,"").trim();const u=c.findIndex((e=>"// ------ ORIGINAL CODE ------"===e.trim())),d=c.findIndex(((e,n)=>n>u&&e.trim()===r));-1!==u&&-1!==d&&(i=c.slice(u+1,d));const f=c.findIndex((e=>"// ------ NEW CODE ----------"===e.trim())),m=c.findIndex(((e,n)=>n>f&&e.trim()===r));return-1!==f&&-1!==m&&(s=c.slice(f+1,m)),{filePath:l,originalCode:i,newCode:s,valid:!0}};n.padDiffSign=(e,n)=>e.map((e=>`${n} ${e}`)).join("\n");n.toDiff=e=>{const{filePath:a,originalCode:r,newCode:o,valid:l}=(0,n.diff)(e);if(!l)return{replaced:"",valid:l,filePath:a,originalCode:"",newCode:""};return{replaced:(0,n.padDiffSign)(r,"-")+"\n"+(0,n.padDiffSign)(o,"+"),valid:l,filePath:a,originalCode:r.join("\n"),newCode:o.join("\n")}}},6661:(e,n,a)=>{"use strict";a.r(n)},6839:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconDownload=void 0;const o=r(a(48431));n.IconDownload=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M14 9.28809C14.3589 9.28809 14.6502 9.57966 14.6504 9.93848V13.9385C14.6504 14.2975 14.359 14.5889 14 14.5889H2C1.64101 14.5889 1.34961 14.2975 1.34961 13.9385V9.93848C1.3498 9.57966 1.64113 9.28809 2 9.28809C2.35887 9.28809 2.6502 9.57966 2.65039 9.93848V13.2881H13.3496V9.93848C13.3498 9.57966 13.6411 9.28809 14 9.28809Z",fill:"currentColor"}),o.default.createElement("path",{d:"M8 1.41211C8.35899 1.41211 8.65039 1.70351 8.65039 2.0625V9.38672L10.54 7.49707C10.7939 7.24323 11.2061 7.24323 11.46 7.49707C11.7138 7.75091 11.7138 8.16315 11.46 8.41699L8.45996 11.417L8.35742 11.5C8.10514 11.6664 7.76209 11.639 7.54004 11.417L4.54004 8.41699L4.45703 8.31445C4.29059 8.06217 4.31798 7.71913 4.54004 7.49707C4.76209 7.27501 5.10514 7.24762 5.35742 7.41406L5.45996 7.49707L7.34961 9.38672V2.0625C7.34961 1.70351 7.64101 1.41211 8 1.41211Z",fill:"currentColor"}))},6949:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=r(a(75857));n.default=o.default},6958:(e,n,a)=>{"use strict";a.r(n)},6976:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Tools=function Tools(){var e,n;const{message:a,isDevMode:r,editQuestion:o=()=>{},rollbackPending:l=!1,rollbackToMessageVersion:i=()=>{},displayRequestMessage:y=()=>{}}=(0,d.useContext)(p.CurrentMessageContext),{allVersions:b}=(0,d.useContext)(p.CurrentConversationContext),{chatState:_}=(0,f.useChatState)(),[C,E]=(0,d.useState)(!1),[w,O]=(0,d.useState)(!1);(0,d.useEffect)((()=>{if(!a)return;const e=b.map((e=>e.requestId)),n=a.requestId;E(a.messageType===s.MessageType.USER&&!!n&&e.includes(n))}),[a,b]),(0,d.useEffect)((()=>{O(_===c.ChatState.TALKING||_===c.ChatState.PLAN)}),[_]);const M=(null===(n=null===(e=null==a?void 0:a.extra)||void 0===e?void 0:e.inputPhrase)||void 0===n?void 0:n.length)?a.extra.inputPhrase.map((e=>["topic","command"].includes(e.type)?e.content:e.expandContent)).join(""):(null==a?void 0:a.content)||"";return d.default.createElement("div",{className:"user-message-tools"},d.default.createElement("div",{className:"handler-box"},d.default.createElement("div",{className:"handler-box__actions"},r?d.default.createElement("div",{className:"handler-box__action-item",onClick:y},d.default.createElement(m.PlayIcon,null)):void 0,!w&&d.default.createElement("div",{className:"handler-box__action-item",onClick:o},d.default.createElement(m.EditorIcon,null)),d.default.createElement("div",{className:"handler-box__action-item"},d.default.createElement(v.Copy,{content:M})),C&&d.default.createElement("div",{className:"handler-box__action-item checkpoint "+(l||w?"disabled":""),onClick:i},d.default.createElement(g.FallbackIcon,null),l?d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"Reverting"}),d.default.createElement(h.LoadingDots,null)):d.default.createElement("span",null,d.default.createElement(u.FormattedMessage,{id:"Revert Checkpoint"}))))))},a(6958);const s=a(398),c=a(69022),u=a(19606),d=i(a(48431)),f=a(25380),m=a(70605),p=a(4882),v=a(58271),h=a(73671),g=a(40455)},8082:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.ChatSelectModel=function ChatSelectModel(){const e=s.ContainerUtil.get(m.ChatModeController),n=s.ContainerUtil.get(v.ProductViewService),a=(0,c.useIntl)(),t=e=>a.formatMessage({id:e}),[r,o]=(0,u.useState)(""),[l,i]=(0,u.useState)(""),[g,y]=(0,u.useState)([]),[b,_]=(0,u.useState)(!1),[C,E]=(0,u.useState)(!1),[w,O]=(0,u.useState)(""),[M,S]=(0,u.useState)(!1),[P,T]=(0,u.useState)(""),j=(0,u.useRef)({}),k={"deepseek-reasoner":"deepseek-r1","deepseek-chat":"deepseek-v3"},I=(0,u.useMemo)((()=>{const e=g.filter((e=>e.configurable)),n=g.filter((e=>{var n;return!e.configurable&&!(null===(n=e.modelId)||void 0===n?void 0:n.startsWith("custom"))})),a=g.filter((e=>{var n;return!e.configurable&&(null===(n=e.modelId)||void 0===n?void 0:n.startsWith("custom"))})),r=[];return n.length>0&&r.push({label:t("Built-in Models"),value:"built-in-models",type:d.DropdownType.SeparatorLabel},...n),a.length>0&&r.push({label:t("Enterprise Models"),value:"enterprise-models",type:d.DropdownType.SeparatorLabel},...a),e.length>0&&"craft"!==P&&r.push({label:t("Custom Models"),value:"custom-models",type:d.DropdownType.SeparatorLabel},...e.map((e=>({...e,disabled:!e.configured})))),r}),[g]),getChatModels=async n=>{const a=n||await e.getChatMode()||h.ChatType.CRAFT;T(a);const r=(await e.getModels()).map((e=>({label:"user"===e.vendor?`${e.name}${e.id?`:${k[e.id]||e.id}`:""}`:e.name||e.id,value:e.id||e.name,description:null==e?void 0:e.description,configurable:e.configurable,configured:e.configured,modelId:e.id,modelName:e.name})));y(r)},onChange=n=>{n.configured?o(n.label||n.value):o(n.label),i(n.value),j.current[P]=n.value,e.updateChatModelMap(j.current)};return(0,u.useEffect)((()=>{(async()=>{if(!I.length||!P)return;j.current=await e.getChatModelMap();const n=j.current[P],a=I.find((e=>"modelId"in e&&e.modelId===n))||g.find((e=>"deepseek-v3"===e.modelName))||g[0];a&&onChange(a)})()}),[I]),(0,u.useEffect)((()=>{getChatModels();const a=[e.onDidChangeModeSettings((()=>{getChatModels()})),e.onDidWindowStateChange((e=>{e&&getChatModels()})),n.onDidChangeConfiguration((()=>{getChatModels()}))];return()=>a.forEach((e=>e.unsubscribe()))}),[]),u.default.createElement(u.default.Fragment,null,b&&u.default.createElement(p.ModelSetting,{modelId:w,changeCurrentModel:C,onClose:()=>{O(""),_(!1),getChatModels()}}),g.length&&u.default.createElement(d.Dropdown,{open:M,options:I,itemRender:e=>u.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",gap:45}},u.default.createElement("span",null,e.label),u.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:4}},e.configurable&&u.default.createElement(f.SettingIcon,{onClick:n=>{n.stopPropagation(),S(!1),E(e.value===l),_(!0),e.modelName&&O(e.modelName)}}),e.value===l&&u.default.createElement(f.CheckIcon,null))),onOpenChange:e=>{S(e),e&&getChatModels()},onChange},u.default.createElement("div",{className:"chat-model-button"},u.default.createElement("span",{className:"current-chat-model"},r||t("Select Model")),u.default.createElement("div",{className:"chat-model-button-icon"}))))},a(66128);const s=a(15985),c=a(19606),u=i(a(48431)),d=a(64900),f=a(48924),m=a(50473),p=a(35380),v=a(76243),h=a(69022)},8622:(e,n,a)=>{"use strict";a.r(n)},8891:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(33444),n),o(a(78988),n),o(a(89200),n)},8900:(e,n,a)=>{"use strict";a.r(n)},9213:(e,n,a)=>{"use strict";a.r(n)},9332:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.ChatInput=void 0,n.ChatInputWrapper=ChatInputWrapper,a(19970);const c=a(15985),u=a(59659),d=a(69022),f=a(19606),m=s(a(48431)),p=a(63306),v=a(48924),h=a(32134),g=a(25380),y=a(52548),b=a(86243),_=a(90194),C=a(88620),E=a(50473),w=a(83364),O=a(2700),M=a(8082),S=a(45840),P=a(18196);function ChatInputWrapper(e){const a=c.ContainerUtil.get(E.ChatInputController),r=(0,m.useRef)(null),o=(0,m.useContext)(h.ConversationIdContext),l=(0,m.useRef)(o),{chatState:i,setChatStateText:s}=(0,g.useChatState)(),u=(0,g.useLogger)("chatInput"),p=(0,f.useIntl)(),t=e=>{try{return p.formatMessage({id:e})}catch(n){return e}},b=e.maxLength||1e5,[C,w]=(0,m.useState)(e.defaultInputText||""),S=(0,m.useMemo)((()=>{const e=b-C.length;return Math.max(0,e)}),[C]),refreshBaseInfo=async()=>{await a.getBaseInfo()},updateContexts=n=>{e.componentMode||((!l.current&&o||l.current)&&a.getInitialContexts().then((e=>{a.updateInitialContexts({...e,[l.current||o]:n})})),l.current=o)},submit=async()=>{if(!(S<=0)&&C&&r.current){if(null==e?void 0:e.beforeSend){if(!await e.beforeSend())return}a.sendRequest({contexts:r.current.getContexts(),inputText:r.current.getInputText(),inputPhrase:r.current.getInputPhrase()},{disableRecordHistory:!!e.componentMode})}};return(0,m.useEffect)((()=>(a.registerIntl(t),r.current&&a.registerChatInputApi(r,e.componentMode),()=>{e.componentMode&&a.removeChatInputApi()})),[]),(0,m.useEffect)((()=>{var e;const n=null===(e=r.current)||void 0===e?void 0:e.getContexts();n&&updateContexts(n)}),[o]),(0,m.useEffect)((()=>{refreshBaseInfo(),o&&!e.componentMode&&a.getInitialContexts().then((e=>{var n;null===(n=r.current)||void 0===n||n.updateContexts((()=>e[o]||[]))}))}),[]),m.default.createElement("div",{onClick:refreshBaseInfo},!e.componentMode&&m.default.createElement(_.ChatDropFile,null),m.default.createElement(n.ChatInput,{...e,ref:r,autoFocus:e.autoFocus,autoComputePosition:e.componentMode,maxLength:b,triggers:a.triggers,validCmd:a.validCommand.bind(a),followingPlaceholder:a.getFollowingPlaceholder.bind(a),onContextClick:a.showContext.bind(a),onContextsUpdated:updateContexts,onSearch:a.search.bind(a),onRemoveContext:e=>{e.type===E.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE&&(a.isEnableAutoAddCurrentFile=!1)},onSubmit:()=>submit(),onInput:w,topEl:e.componentMode?void 0:m.default.createElement(y.Snapshot,null),bottomEl:m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"addition-wrapper"},m.default.createElement("div",{style:{display:"flex",gap:8}},m.default.createElement("span",null,m.default.createElement(O.ChatSelectMode,null)),m.default.createElement("span",{className:"chat-select-model-wrapper"},m.default.createElement(M.ChatSelectModel,null))),m.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:8}},S<1e3&&m.default.createElement("div",{className:"surplus-text"},S<=0?m.default.createElement("span",{style:{color:"#D7432E"}},t("Exceeded 100,000 character limit")):m.default.createElement("span",null,p.formatMessage({id:"{num} characters remaining"},{num:S}))),i===d.ChatState.TALKING||i===d.ChatState.PLAN?m.default.createElement("div",{className:"control-stop",onClick:()=>{u.info("stopRequest abort","ChatInput"),s(t("Cancelled continuing generation, you can continue to supplement the requirement description in the input box.")),a.stopRequest()}},m.default.createElement(v.StopIcon,{className:"stop-btn-icon"})):m.default.createElement("div",{className:"control-send "+(!C||S<=0?"send-btn-disabled":""),onClick:()=>submit()},m.default.createElement(v.SendIcon,null)))))}))}n.ChatInput=(0,m.forwardRef)(((e,n)=>{const a=(0,f.useIntl)(),t=e=>{try{return a.formatMessage({id:e})}catch(n){return e}},r=(0,m.useRef)((0,P.useInvisibleEncoder)()),{encodeText:o,decodeText:l,getEncodeTextId:i,resetIdIndex:s}=r.current,{isOpen:c,refs:u,floatingStyle:d,setIsOpen:p,getReferenceProps:h,getFloatingProps:g}=(0,P.useFloatingRef)({autoComputePosition:!!e.autoComputePosition}),{isOpen:y,refs:_,floatingStyle:O,setIsOpen:M,getReferenceProps:T,getFloatingProps:j}=(0,P.useFloatingRef)({autoComputePosition:!!e.autoComputePosition}),[k,I]=(0,m.useState)([]),[N,x]=(0,m.useState)(null),[D,R]=(0,m.useState)(!1),[L,A]=(0,m.useState)(""),[F,V]=(0,m.useState)(null),[B,U]=(0,m.useState)(0),[W,H]=(0,m.useState)(0),G=(0,m.useRef)(null),[q,$]=(0,m.useState)([]),[X,K]=(0,m.useState)([]),[z,Z]=(0,m.useState)(0),[J,Y]=[3,3],[Q,ee]=(0,m.useState)(!1),te=(0,m.useRef)(),[ne,ae]=(0,m.useState)([...e.defaultContexts||[]]),re=(e.defaultInputPhrase||[]).map((e=>({...e,content:["topic","command","normal"].includes(e.type)?e.content:o(e.content)}))),[oe,le]=(0,m.useState)((()=>re.length?re.map((e=>e.content)).join(""):e.defaultInputText||"")),[ie,se]=(0,m.useState)([]),[ce,ue]=(0,m.useState)((()=>re.filter((e=>"normal"!==e.type)).map((e=>({type:e.type,value:{id:i(e.content),label:e.content.slice(1),value:[E.IMentionType.file,E.IMentionType.folder].includes(e.type)?e.expandContent.slice(`@${e.type}:`.length):l(e.content).slice(1)}}))))),de=(0,m.useMemo)((()=>!(!X.length&&!q.length||N||L&&"@"!==L)),[q,X,L,N]),fe=(0,m.useRef)([]),me=(0,m.useRef)(-1),pe=(0,m.useRef)(!1),onRencentFiles=e=>{$([]),K([]);const n=e.findIndex((e=>e.type===E.IMentionType.recentFile));if(n>-1){const a=e.splice(n,1)[0];if(null==a?void 0:a.children){const n=[],r=[],o=new Set;let l=0;a.children.forEach((e=>{const a=`${e.label}|${e.value}`;o.has(a)||(o.add(a),isItemCheck(e)?r.push({...e}):(l<Y&&n.push({...e,index:l}),l+=1))}));const i=n.length;$(n),K(r.map(((e,n)=>({...e,index:n+i})))),I([...n,...r,...e]),Z(i+r.length),ee(!1)}}},isItemCheck=e=>ne.some((n=>(n.mentionType===e.type||n.type===e.type)&&n.label===e.label&&n.value===e.value)),applyMention=async e=>{var n;if(!c)return;const a=k[e];if(!!(null==a?void 0:a.children))return x(a),I(a.children),void onRencentFiles(a.children);const r=o(a.value),l=i(r);let s=F+r+" ";if("command"===a.type&&k.filter((e=>"command"===e.type&&e.value===a.value)).length>1&&0===a.label.indexOf("@")&&(s=`${a.label} ${s}`),D||(null===(n=G.current)||void 0===n||n.onInput(replaceText(oe,L,s,B,a)),setCaretPosition(B+s.length),closeMenu()),G&&(await sleep(50),G.current&&!D)){G.current.focus();const e=B+s.length;G.current.setSelectionStart(e),G.current.setSelectionEnd(e)}handleMentionApply(a,B,l)};function sleep(e){return new Promise((n=>{setTimeout(n,e)}))}function isFileLevelSelection(e){return[E.ChatSelectionInfoType.SELECT_FILE,E.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE].includes(e)}const addSelectionToActiveChatSelectionInfo=(e,n=!1)=>{e.forEach((e=>{const a=ne.findIndex((n=>{const a=isFileLevelSelection(n.type)&&isFileLevelSelection(e.type)&&!n.selection&&!e.selection&&n.type!==E.ChatSelectionInfoType.CONTEXT&&e.type!==E.ChatSelectionInfoType.CONTEXT&&n.label===e.label,r=[n.type,e.type].every((e=>e===E.ChatSelectionInfoType.SELECT_FILE))&&n.selection&&e.selection&&n.selection.start.line===e.selection.start.line&&n.selection.end.line===e.selection.end.line;return a||r||e.type===E.ChatSelectionInfoType.CONTEXT&&n.type===E.ChatSelectionInfoType.CONTEXT&&n.label===e.label}));switch(e.type){case E.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE:te.current=e,ae((n=>[...n.filter((e=>e.type!==E.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE)),e]));break;case E.ChatSelectionInfoType.REMOVE_CURRENT_FILE:ne.length>0&&ae((e=>e.filter((e=>e.type!==E.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE))));break;case E.ChatSelectionInfoType.SELECT_FILE:case E.ChatSelectionInfoType.CONTEXT:-1===a?ae((n=>[e,...n])):D&&n&&removeActiveSelection(a)}}))},removeActiveSelection=(n=ne.length-1)=>{var a,r;const o=ne[n];o&&(ne.splice(n,1),ae([...ne]),null===(a=G.current)||void 0===a||a.removePrompt(o),null===(r=e.onRemoveContext)||void 0===r||r.call(e,o))},handleMentionApply=async(e,n,a)=>{var r;const{value:o,label:l,type:i}=e;if(i!==E.IMentionType.command){if(e.type===E.IMentionType.agent){for(let e=ne.length-1;e>=0;e--){const n=ne[e];"mentionType"in n&&n.mentionType===E.IMentionType.agent&&ne.splice(e,1)}ae([...ne])}if(e.type===E.IMentionType.file||e.type===E.IMentionType.recentFile||e.type===E.IMentionType.folder){const n={type:E.ChatSelectionInfoType.SELECT_FILE,mentionType:e.type,label:l,value:o};addSelectionToActiveChatSelectionInfo([n],!0)}else addSelectionToActiveChatSelectionInfo([{...e,label:l,value:o,type:E.ChatSelectionInfoType.CONTEXT,mentionType:i}],!0);ue([...ce,{type:i,value:{id:a,label:o,value:[E.IMentionType.file,E.IMentionType.folder].includes(i)?l:o}}])}else{le(`/${o} @`),closeMenu();const e=(await getSuggestItems("@")).find((e=>e.type===E.IMentionType.file));e&&(x(e),V("@"),null===(r=G.current)||void 0===r||r.onInput(`/${o} @`))}},handleMention=async e=>{const n=await getSuggestItems(e);p(n.length>0),I(n),onRencentFiles(n),n.length<=0&&setTimeout((()=>{V(null),A(""),x(null),closeMenu()}))},handleSearch=async(e,n=F,a=N)=>{var r;if(A(e),!(e&&e!==n||a))return void handleMention(n);let o=await getSuggestItems(n,e);a?(a.children=(null===(r=o.find((e=>e.id===a.id)))||void 0===r?void 0:r.children)||[],o=a.children):o=o.concat(o.flatMap((e=>{var n;return null!==(n=e.children)&&void 0!==n?n:[]}))),o=loadMentionItems(o,e||""),I(o),onRencentFiles(o)},loadMentionItems=(e,n)=>n?(0,S.fuzzySearch)(n,e):e,getSuggestItems=async(n,a="")=>{var r,o;return(null===(r=null==e?void 0:e.onSearch)||void 0===r?void 0:r.call(e,n||"",a,null===(o=G.current)||void 0===o?void 0:o.value,ie))||[]},replaceText=(e,n,a,r,o)=>F&&o.type===E.IMentionType.agent?a:e.slice(0,r)+a+e.slice(r+(n||"").length+1,e.length),setCaretPosition=e=>{setTimeout((()=>{var n;null===(n=G.current)||void 0===n||n.setSelectionEnd(e)}))},closeMenu=()=>{null!=F&&(V(null),A(""),x(null),R(!1),D||p(!1))},recordHistory=()=>{me.current=-1,fe.current.push({prompt:oe,variableRecords:[...ce],activeChatSelectionInfo:[...ne]})},clearInput=()=>{var e;s(),ue([]),se([]),null===(e=G.current)||void 0===e||e.onInput("")};return(0,m.useImperativeHandle)(n,(()=>({getContexts:()=>ne,getInputPhrase:()=>ie,getInputText:()=>oe,focus(){var e;null===(e=G.current)||void 0===e||e.focus()},input(e){var n;null===(n=G.current)||void 0===n||n.onInput(e)},clearInput,addContexts:addSelectionToActiveChatSelectionInfo,updateContexts:ae,recordHistory}))),(0,m.useEffect)((()=>{var n,a;e.autoFocus&&(async e=>{await sleep(0),G.current&&!D&&(G.current.focus(),G.current.setSelectionStart(e),G.current.setSelectionEnd(e))})((null===(n=e.defaultInputText)||void 0===n?void 0:n.length)||0),(null===(a=e.defaultInputText)||void 0===a?void 0:a.length)&&s(Math.max(0,...ce.map((e=>Number(e.value.id||0)))))}),[]),(0,m.useEffect)((()=>{c?handleSearch(L):closeMenu()}),[L,c]),(0,m.useEffect)((()=>{k.length&&H(0)}),[k]),(0,m.useEffect)((()=>{var n,a;(null===(n=e.defaultInputPhrase)||void 0===n?void 0:n.length)||(null===(a=e.defaultInputText)||void 0===a?void 0:a.length)||clearInput()}),[e.defaultInputPhrase]),(0,m.useEffect)((()=>{var n;null===(n=e.onInput)||void 0===n||n.call(e,oe)}),[oe]),(0,m.useEffect)((()=>{var n;null===(n=e.onContextsUpdated)||void 0===n||n.call(e,ne)}),[ne]),m.default.createElement("form",{className:["chat-form",e.autoComputePosition?"chat-form-component":""].join(" "),onSubmit:e=>e.preventDefault()},e.topEl,m.default.createElement("div",{className:"control-group"},m.default.createElement("div",{className:"mentionable mentionable-textarea"},y&&ne.length>0&&m.default.createElement("div",{...j(),className:["mention-item-selection-wrapper",e.autoComputePosition?"mentionable-popper-component":""].join(" "),style:e.autoComputePosition?O:void 0,ref:_.setFloating},m.default.createElement("div",{className:"mention-item-selection-area"},ne.map(((e,n)=>m.default.createElement("div",{key:n,className:"mention-item",onClick:e=>{e.stopPropagation(),removeActiveSelection(n)}},m.default.createElement("div",{className:"repository"},m.default.createElement("div",{title:e.value,className:"repository-item"},m.default.createElement("span",{className:"line-icon"},(0,P.getIMentionTypeIcon)(e)),m.default.createElement("span",{className:"name"},e.value),m.default.createElement("span",{title:e.label,className:"desc"},e.label)),m.default.createElement(v.CloseIcon,{className:"close-icon"})))))),m.default.createElement("div",{className:"mention-item-clear",onClick:n=>{(()=>{var n;if(!G.current)return;let a=oe;for(let r=ne.length-1;r>=0;r--){const o=ne[r];a=G.current.removePrompt(o,a),null===(n=e.onRemoveContext)||void 0===n||n.call(e,o)}ae([])})()}},t("Clear context"))),c&&m.default.createElement("div",{...g(),className:["mentionable-popper",e.autoComputePosition?"mentionable-popper-component":""].join(" "),ref:u.setFloating,style:e.autoComputePosition?d:void 0},m.default.createElement(w.MentionItems,{multiChatSelectionEnabled:D,selectedIndex:W,onMentionItemMouseOver:H,showRecentFiles:de,isExpandRecentAddFiles:Q,setIsExpandRecentAddFiles:ee,rencentAddFiles:X,rencentFiles:q,defaultAddFileNum:J,allRencentFilesLen:z,items:k,selectedMenuItem:N,selections:ne,onApply:applyMention,onSearch:handleSearch,onKeydown:e=>{var n;return null===(n=G.current)||void 0===n?void 0:n.onKeydown(e)},onSubMenuBack:()=>{x(null),handleSearch(L,void 0,null)},isItemCheck})),m.default.createElement("div",{className:"host"},m.default.createElement("div",{className:"addition-wrapper addition-wrapper--header"},m.default.createElement(b.ChatActiveSelection,{addContextRef:u.setReference,onAddContext:()=>(e=>{if(c)return;R(!0),p(!0);let n="";F!==e&&(n=e),V(n),handleSearch(e,n)})("@"),showSelectionContextRef:_.setReference,onShowSelectionContext:()=>{y||M(!0)},onClick:e.onContextClick,onRemove:removeActiveSelection,referenceProps:h,selectionReferenceProps:T,selections:[...ne]})),m.default.createElement(C.ChatInputEditor,{ref:G,autoFocus:e.autoFocus,triggers:e.triggers,mentionItems:k,mentionKey:F,variableRecords:ce,selectedIndex:W,prompt:oe,maxLength:e.maxLength,validCmd:e.validCmd,onInputTextChange:e=>{le(e)},onInputPhraseChange:se,onVariableRecordsChange:ue,onSelectionsChange:ae,onRemoveSelections:removeActiveSelection,onSelectedIndexChange:H,getIndexByArrowDownOrUp:(e,n)=>{const a=e,r=["ArrowDown",40].includes(n),o=["ArrowUp",38].includes(n),l=X.length>J,i=!Q&&l&&(r?a+1:a-1)===q.length+J;if(r)return i&&!N?z:a+1;if(o){if(!N){if(!Q&&l&&a===z)return q.length+J-1;if(i)return q.length+J-1}return a+-1}return a},onClose:closeMenu,onOpen:async(e,n,a)=>{var r;"/"===e&&e+a!==(null===(r=G.current)||void 0===r?void 0:r.value)||F!==e&&(A(a||""),V(e),U(n),H(0),p(!0),handleMention(e))},onApply:applyMention,onSearch:handleSearch,onEnter:()=>{var n;null===(n=e.onSubmit)||void 0===n||n.call(e,{contexts:ne,inputText:oe,inputPhrase:ie})},onKeydown:e=>{if(oe){const e=fe.current.some((e=>e.prompt===oe));pe.current=e}else pe.current=!0;if(!pe.current)return;let n=me.current;if("ArrowUp"!==e.key&&38!==e.keyCode||!e.altKey){if("ArrowDown"!==e.key&&40!==e.keyCode||!e.altKey)return;n=me.current>=fe.current.length-1?0:me.current+1}else n=me.current<=0?fe.current.length-1:me.current-1;e.preventDefault(),me.current=n,(()=>{const e=fe.current[me.current];e&&(le(e.prompt),ue([...e.variableRecords]),ae([...e.activeChatSelectionInfo]))})()}}),e.bottomEl))),m.default.createElement("h4",{className:"chat-tips"},t("AI-generated content, for reference only")))}));let T=class{};T=i([(0,u.Widget)({area:p.ChatBodyConversionArea.Input,component:ChatInputWrapper})],T),n.default=T},10219:(e,n,a)=>{"use strict";a.r(n)},10704:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useToggle=void 0;const r=a(48431);n.useToggle=e=>{const[n,a]=(0,r.useState)(e);return{state:n,toggle:()=>a(!n)}}},10971:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MarkdownPreCodeActions=void 0;const c=a(15985),u=a(76243),d=a(69022),f=s(a(73059)),m=i(a(48431)),p=a(50473),v=a(25380),h=a(4882),g=a(20421),y=a(13039),b=a(73769),_=a(12035);n.MarkdownPreCodeActions=e=>{const{language:n,content:a,diffCode:r}=e,o=c.ContainerUtil.get(d.ChatViewService),l=c.ContainerUtil.get(u.ConfigViewService),i=(0,_.useActionI10n)(),{message:s}=(0,m.useContext)(h.CurrentMessageContext),C=(0,y.useCodeBlockReportHooks)({language:n,content:a},s),{chatState:E}=(0,v.useChatState)(),[w,O]=(0,m.useState)(!1),M=(0,m.useMemo)((()=>["bash","sh","zsh","fish","powershell","pwsh","cmd"].includes(n.toLowerCase())),[]),S=(0,m.useCallback)((async()=>{await(0,g.getCodeBlockViewService)().insertCode({language:n,content:a}),null==C||C.insert()}),[]),{copied:P,onCopy:T}=(0,y.useCopy)(a),j=(0,m.useCallback)((()=>{T(),null==C||C.copy()}),[T]),k=(0,m.useCallback)((async()=>{await(0,g.getCodeBlockViewService)().createFile({language:n,content:a}),null==C||C.newFile()}),[]),I=(0,m.useCallback)((async()=>{await(0,g.getCodeBlockViewService)().saveFile({language:n,content:a}),null==C||C.save()}),[]),N=(0,m.useCallback)((async()=>{await(0,g.getCodeBlockViewService)().insertToTerminal({language:n,content:a}),null==C||C.terminal()}),[]),originalApplyCode=async()=>{await Promise.all([l.update(p.CRAFT_SETTINGS,g.JsonUtils.safeStringify({...g.JsonUtils.safeParse(await l.get(p.CRAFT_SETTINGS)||"{}")||{},isPlan:!1})||""),l.update(u.CHAT_SELECTED_MODE,d.ChatType.CRAFT)]),o.codeActionObserver.next({prompt:`${i.applyMessage}\n${a}`})},x=(0,m.useCallback)((()=>{if(r){O(!0);const{filePath:e,originalCode:n,newCode:a}=r;(0,g.getCodeBlockViewService)().applyCode(e,n,a).then((({content:n,oldContent:a,errorMessage:r})=>{r?originalApplyCode():o.showFileContentDiff(e,a,n)})).catch((()=>originalApplyCode()))}}),[]);return m.default.createElement("div",{className:(0,f.default)("markdown-pre__actions")},m.default.createElement(IconButton,{title:i.insertTooltip,label:i.insert,onClick:S},m.default.createElement(b.IconInsert,{className:"markdown-pre__icon"})),P?m.default.createElement(IconButton,{key:"check",title:i.copied,label:i.copied},m.default.createElement(b.IconCheck,{className:"markdown-pre__icon markdown-pre__icon-check"})):m.default.createElement(IconButton,{key:"copy",title:i.copy,label:i.copy,onClick:j},m.default.createElement(b.IconCopy,{className:"markdown-pre__icon"})),m.default.createElement(IconButton,{title:i.newFileTooltip,label:i.newFile,onClick:k},m.default.createElement(b.IconCreateFile,{className:"markdown-pre__icon"})),m.default.createElement(IconButton,{title:i.saveTooltip,label:i.save,onClick:I},m.default.createElement(b.IconDownload,{className:"markdown-pre__icon"})),M&&m.default.createElement(IconButton,{title:i.insertIntoTerminalTooltip,label:i.insertIntoTerminal,onClick:N},m.default.createElement(b.IconTerminal,{className:"markdown-pre__icon"})),r&&m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"markdown-pre__divider"}),w?m.default.createElement("div",{title:i.applied,className:"markdown-pre__action disabled"},m.default.createElement(b.IconApply,{className:"markdown-pre__icon"}),m.default.createElement("span",{className:"markdown-pre__label"},i.applied)):m.default.createElement("div",{title:i.apply,onClick:x,className:(0,f.default)("markdown-pre__action",{disabled:["talking","plan"].includes(E)})},m.default.createElement(b.IconApply,{className:"markdown-pre__icon"}),m.default.createElement("span",{className:"markdown-pre__label"},i.apply))))};const IconButton=({title:e,label:n,onClick:a,children:r})=>m.default.createElement("div",{className:"markdown-pre__action",title:e,onClick:a},r,m.default.createElement("span",{className:"markdown-pre__label"},n))},11037:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(94121),n)},11077:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0})},11463:(e,n,a)=>{"use strict";a.r(n)},12035:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.I10nRenderError=n.I10nDownloadPng=n.I10nDownloadSvg=n.I10nDownload=n.I10nDiagram=n.I10nCode=n.useMermaidI10n=n.useActionI10n=void 0;const s=a(19606),c=i(a(48431));n.useActionI10n=()=>{const e=(0,s.useIntl)();return(0,c.useMemo)((()=>({insert:e.formatMessage({id:"Insert"}),insertTooltip:e.formatMessage({id:"Insert at cursor"}),copy:e.formatMessage({id:"Copy"}),copied:e.formatMessage({id:"Copied"}),newFile:e.formatMessage({id:"New file"}),newFileTooltip:e.formatMessage({id:"Create new file"}),save:e.formatMessage({id:"Save"}),saveTooltip:e.formatMessage({id:"Save to local"}),insertIntoTerminal:e.formatMessage({id:"Run"}),insertIntoTerminalTooltip:e.formatMessage({id:"Insert into terminal"}),apply:e.formatMessage({id:"Apply"}),applied:e.formatMessage({id:"Applied"}),applyMessage:e.formatMessage({id:"Apply the following diff information to the corresponding files, following the current code style."})})),[])};n.useMermaidI10n=()=>{const e=(0,s.useIntl)();return(0,c.useMemo)((()=>({zoomIn:e.formatMessage({id:"Zoom In"}),zoomOut:e.formatMessage({id:"Zoom Out"})})),[])};n.I10nCode=()=>c.default.createElement(s.FormattedMessage,{id:"Code"});n.I10nDiagram=()=>c.default.createElement(s.FormattedMessage,{id:"Diagram"});n.I10nDownload=()=>c.default.createElement(s.FormattedMessage,{id:"Download"});n.I10nDownloadSvg=()=>c.default.createElement(s.FormattedMessage,{id:"Download SVG"});n.I10nDownloadPng=()=>c.default.createElement(s.FormattedMessage,{id:"Download PNG"});n.I10nRenderError=()=>c.default.createElement(s.FormattedMessage,{id:"Diagram loading failed. Please check the code."})},12185:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toSerializeBlob=n.serializeBlob=void 0;n.serializeBlob=async(e,n)=>{const a=new Blob([e],{type:n}),r=await a.arrayBuffer();return{mimeType:n,data:Array.from(new Uint8Array(r))}};n.toSerializeBlob=async e=>{const n=await e.arrayBuffer();return{mimeType:e.type,data:Array.from(new Uint8Array(n))}}},12562:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ReplayIcon=void 0;const o=r(a(48431));n.ReplayIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("g",{clipPath:"url(#clip0_25786_346304)"},o.default.createElement("path",{d:"M14.7767 2.87057V4.91654C14.7767 5.19268 14.5528 5.41654 14.2767 5.41654H12.2307",stroke:"#808080",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M13.8674 4.49982C13.0149 3.19558 11.6975 2.18842 10.074 1.75341C6.57314 0.81535 2.97467 2.89292 2.03662 6.39379C1.09856 9.89467 3.17614 13.4931 6.67701 14.4312C9.1429 15.0919 11.6572 14.2565 13.2561 12.4814",stroke:"#808080",strokeWidth:"1.3",strokeLinecap:"round"})),o.default.createElement("defs",null,o.default.createElement("clipPath",{id:"clip0_25786_346304"},o.default.createElement("rect",{width:"16",height:"16",fill:"white"}))))},13039:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(60752),n),o(a(70291),n)},13173:(e,n,a)=>{"use strict";a.r(n)},13969:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconTerminal=void 0;const o=r(a(48431));n.IconTerminal=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("rect",{x:"1.5",y:"3",width:"13",height:"10",rx:"1",stroke:"currentColor",strokeWidth:"1.3"}),o.default.createElement("path",{d:"M4 6L5.29289 7.29289C5.68342 7.68342 5.68342 8.31658 5.29289 8.70711L4 10",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M8 10L12 10",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}))},14005:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getModeCopywriter=void 0;const r=a(15985),o=a(69022),l=a(19606),i=a(69405),s=a(96593);n.getModeCopywriter=e=>{const{formatMessage:n}=(0,l.useIntl)(),a=r.ContainerUtil.get(o.PlatformConfigViewService);let{mode:c,workspace:u,platform:d}=e;d in i.welcomeCopywriterMap||(d=s.PlatformType.VSCODE);const f=d===s.PlatformType.WEIXIN&&a.getIntelligentCreate(),m=i.welcomeCopywriterMap[d];c in m||(c=s.WelcomeMode.CRAFT);const p=f?s.WorkspaceStatus.SC:u?s.WorkspaceStatus.HAS:s.WorkspaceStatus.NOT,{title:v,describe:h,guideList:g}=m[c],y=Array.isArray(g)?g:g[p]||[];return{title:n({id:v}),describe:n({id:h}),guideList:y.map((e=>({...e,title:n({id:e.title}),describe:n({id:e.describe})})))}}},14388:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),a(98810);const s=a(19606),c=i(a(48431)),u=a(70605);n.default=e=>{const n=(0,s.useIntl)();return c.createElement("div",{className:"mcp-header"},c.createElement("div",{className:"mcp-header-left-arrow",onClick:e.onBack},c.createElement(u.LeftArrowIcon,null)),c.createElement("div",{className:"mcp-header-title",onClick:e.onBack},(a="MCP Servers",n.formatMessage({id:a}))));var a}},14805:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),a(11463);const o=r(a(48431));n.default=({tabs:e,activeKey:n,onChange:a,extra:r})=>o.default.createElement("div",{className:"mcp-tabs-custom"},o.default.createElement("div",{className:"mcp-tabs-custom-tabs-bar"},o.default.createElement("div",{className:"mcp-tabs-custom-tabs"},e.map((e=>{const r=e.key===n;return o.default.createElement("div",{key:e.key,className:"mcp-tabs-custom-tab"+(r?" active":""),onClick:()=>a(e.key)},e.title,r&&o.default.createElement("div",{className:"mcp-tabs-custom-tab-underline"}))}))),o.default.createElement("div",{className:"mcp-tabs-custom-tabs-extra"},r)),o.default.createElement("div",{className:"mcp-tabs-custom-tab-content"},e.map((e=>o.default.createElement("div",{className:"mcp-tabs-custom-tab-content-item",key:e.key,style:{display:e.key===n?"block":"none"}},e.content)))))},15641:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.CompletionComponent=n.CompletionRenderer=void 0;const u=a(15985),d=a(76243),f=a(69022),m=a(19606),p=s(a(48431)),v=a(37232),h=a(32134),g=a(25380),y=c(a(6949)),b=a(42810);let _=class CompletionRenderer{constructor(){this.className="attempt-completion"}canHandle(e){return e.name===f.ToolNames.PLAN_ATTEMPT_COMPLETION?b.ChatToolRendererPriority.EXACT:b.ChatToolRendererPriority.NONE}render(e){return p.default.createElement(n.CompletionComponent,{tool:e})}};n.CompletionRenderer=_,n.CompletionRenderer=_=i([(0,u.Component)(b.ChatToolRenderer)],_);n.CompletionComponent=e=>{const n=(0,p.useContext)(h.ConversationIdContext),a=(0,m.useIntl)(),t=e=>a.formatMessage({id:e}),{tool:r}=e,{chatStateText:o,triggerChatState:l}=(0,g.useChatState)(),confirm=()=>{l(f.ChatStateEvent.PLAN_START),u.ContainerUtil.get(d.ToolViewService).execute(r.id,n)};return(0,p.useEffect)((()=>{l(f.ChatStateEvent.PLAN_READY)}),[]),p.default.createElement(p.default.Fragment,null,r.args.summary&&p.default.createElement(v.MarkdownRenderer,null,r.args.summary),p.default.createElement((function Action(){return o?p.default.createElement("div",{className:"action-desc"},o):r.status===f.ToolStatus.PENDING?p.default.createElement(p.default.Fragment,null,p.default.createElement("div",{className:"action-desc"},t('You can reply in the input box, or click the "Start" button below to begin task generation after confirming everything is correct.')),p.default.createElement(y.default,{type:"primary",btnText:t("Start"),onClick:confirm})):void 0}),null))}},17030:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),a(21436);const s=a(19606),c=i(a(48431)),u=a(46141),d=a(78517);n.default=({visible:e,title:n,content:a,onOk:r,onCancel:o,installGuide:l})=>{const[i,f]=(0,c.useState)(e),m=(0,s.useIntl)(),translations=e=>m.formatMessage({id:e});return(0,c.useEffect)((()=>{f(e)}),[e]),c.default.createElement(d.Dialog,{visible:i,title:c.default.createElement("div",{className:"mcp-dialog-error-header"},c.default.createElement("div",{className:"mcp-dialog-error-icon"}),c.default.createElement("div",{className:"mcp-dialog-error-title"},n)),actions:c.default.createElement("div",{className:"mcp-dialog-error-actions"},c.default.createElement(u.Button,{variant:"primary",onClick:()=>r()},translations("Try to install")),c.default.createElement("a",{onClick:()=>l(),target:"_blank"},translations("Manual installation guide"))),onClose:o},c.default.createElement("div",null,a))}},17301:(e,n,a)=>{"use strict";a.r(n)},17685:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0})},18196:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.getIMentionTypeIcon=void 0,n.useReference=function useReference(){return{convertSelectionContextInfoToReferences:e=>{const n=[];return e.forEach((e=>{e.type!==d.ChatSelectionInfoType.CONTEXT?(e.mentionType===d.IMentionType.code&&n.push({name:d.ReferenceNames.Code,label:e.label,value:e.value,metadata:{filename:e.value,filepath:e.label,selection:e.selection,code:e.code}}),e.mentionType===d.IMentionType.file?n.push({name:d.ReferenceNames.File,label:e.label,value:e.value,metadata:{filename:e.value,filepath:e.label,selection:e.selection}}):e.mentionType===d.IMentionType.folder&&n.push({name:d.ReferenceNames.Folder,label:e.label,value:e.value,metadata:{folderPath:e.label}})):n.push({name:e.mentionType,label:e.label,value:e.value,metadata:{knowledgeBaseId:e.knowledgeBaseId}})})),n},convertReferencesToSelectionContextInfo:e=>{const n=[];return e.forEach((e=>{var a,r,o;e.name===d.ReferenceNames.Code?n.push({type:d.ChatSelectionInfoType.SELECT_FILE,label:e.label,value:e.value,selection:null===(a=e.metadata)||void 0===a?void 0:a.selection,code:null===(r=e.metadata)||void 0===r?void 0:r.code,mentionType:d.IMentionType.code}):e.name===d.ReferenceNames.File?n.push({type:d.ChatSelectionInfoType.SELECT_FILE,label:e.label,value:e.value,mentionType:d.IMentionType.file}):e.name===d.ReferenceNames.Folder?n.push({type:d.ChatSelectionInfoType.SELECT_FILE,label:e.label,value:e.value,mentionType:d.IMentionType.folder}):n.push({type:d.ChatSelectionInfoType.CONTEXT,mentionType:e.name,label:e.label,value:e.value,knowledgeBaseId:null===(o=e.metadata)||void 0===o?void 0:o.knowledgeBaseId})})),n}}},n.useSuggestItems=function useSuggestItems(){const e=s.ContainerUtil.get(u.FileSearchViewService),n=(0,f.useIntl)(),t=e=>n.formatMessage({id:e});return{getSuggestItems:async(n,a="",r="",o="",l="",i=[],s=[],c=[],u=[])=>{if(!n)return[];if("/"===n){if(l&&o.trim().startsWith(`@${l} /`)){const e=i.find((e=>e.name===l));return(null==e?void 0:e.commands)?e.commands.filter((e=>"default"!==e.name)).map((e=>({id:e.name,label:t(e.description||e.name),value:e.name,type:d.IMentionType.command}))):[]}return!l&&/^\//.test(o)?s.map((e=>({id:e.name,label:t(e.description||e.name),value:e.name,type:d.IMentionType.command}))):[]}const f=c.map((e=>({...e,label:t(e.description)||e.name,value:e.name})));"/"===n||r||f.unshift({value:d.IMentionType.recentFile,label:"最新打开",type:d.IMentionType.recentFile,children:(await e.getRecentFiles({resultNum:50})).map((e=>({value:e.fileName,label:e.relativePath,type:d.IMentionType.file})))||[]});for(const n of f)if(n.type===d.IMentionType.knowledge)n.children=u.map((e=>({label:e.description||e.name,value:e.name,group:e.type,type:d.IMentionType.knowledge,knowledgeBaseId:e.id})));else if(n.type===d.IMentionType.file){const a=await e.getWorkspaceFiles({search:r,resultNum:50});n.children=a.map((e=>({value:e.fileName||e.folderName,label:e.relativePath,type:e.type})))||[]}else n.type===d.IMentionType.agent&&(n.children=i.filter((e=>"default"!==e.name)).map((e=>({label:e.description||e.name,value:e.name,type:d.IMentionType.agent})))||[]);return f.filter((e=>{var n;return e.type!==d.IMentionType.agent||(null===(n=e.children)||void 0===n?void 0:n.length)}))}}},n.useFloatingRef=function useFloatingRef({autoComputePosition:e}){const[n,a]=(0,m.useState)(!1),{refs:r,context:o,floatingStyles:l}=(0,c.useFloating)({placement:"top",open:n,onOpenChange:a,whileElementsMounted:e?(e,n)=>(0,c.autoUpdate)(e,n,(()=>{(0,c.computePosition)(e,n,{placement:"top",middleware:[(0,c.flip)()]}).then((({x:e,y:n,placement:a})=>{s({...i,top:n+("top"===a?-10:0)})}))}),{ancestorScroll:!0}):void 0}),[i,s]=(0,m.useState)(l),{getReferenceProps:u,getFloatingProps:d}=(0,c.useInteractions)([(0,c.useClick)(o),(0,c.useDismiss)(o)]);return{isOpen:n,refs:r,floatingStyle:i,setIsOpen:a,getReferenceProps:u,getFloatingProps:d}},n.useInvisibleEncoder=function useInvisibleEncoder(){let e=0;return{invisibleText:"​",resetIdIndex:(n=0)=>{e=n},getEncodeTextId:e=>{let n=e.length-1;for(;n>=0;){if("​"!==e[n]){n++;break}n--}return e.length===n?void 0:e.length-n},encodeText:(n,a)=>{if((e=>/\u200B$/g.test(e))(n))return n;let r;return a?r=a:(e+=1,r=e),n+new Array(r).fill("​").join("")},decodeText:e=>e.replace(/\u200B/g,"")}};const s=a(15985),c=a(97731),u=a(76243),d=a(69022),f=a(19606),m=i(a(48431)),p=a(48924);n.getIMentionTypeIcon=e=>{switch(e.mentionType){case"code":case"file":return m.default.createElement(f.Icon,{name:e.value,type:f.IconType.VSCODE});case"folder":return m.default.createElement(f.Icon,{name:f.SvgIconName.FolderIcon});case"command":return m.default.createElement(p.CommandIcon,null);case"knowledge":return m.default.createElement(f.Icon,{name:f.SvgIconName.DocsIcon});case"diff":return m.default.createElement(f.Icon,{name:f.SvgIconName.DiffIcon});case"terminal":return m.default.createElement(f.Icon,{name:f.SvgIconName.TermianlIcon});case"topic":return m.default.createElement(f.Icon,{name:f.SvgIconName.AgentIcon});default:return m.default.createElement(m.default.Fragment,null)}}},18365:(e,n,a)=>{"use strict";a.r(n)},18720:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconCopy=void 0;const o=r(a(48431));n.IconCopy=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M4.5 11.5C4.5 12.0523 4.94772 12.5 5.5 12.5H12C12.5523 12.5 13 12.0523 13 11.5V6.99299C13 6.44071 12.5523 5.99299 12 5.99299H9.9324C9.38012 5.99299 8.9324 5.54528 8.9324 4.99299V3C8.9324 2.44771 8.48469 2 7.9324 2H5.5C4.94772 2 4.5 2.44772 4.5 3V11.5Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M8.5293 2.19629L12.6563 6.22913",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M2.5 6.5V11.5C2.5 13.1569 3.84315 14.5 5.5 14.5H9.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},18725:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(98494),n),o(a(33815),n),o(a(67415),n)},18817:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useInstalledServers=void 0;const r=a(15985),o=a(69022),l=a(48431);n.useInstalledServers=()=>{const[e,n]=(0,l.useState)([]),fetchInstalledServerList=async()=>{const e=r.ContainerUtil.get(o.McpViewService),a=await e.getInstalledServers();a&&n(a)};return(0,l.useEffect)((()=>{fetchInstalledServerList()}),[]),{data:e,fetchInstalledServerList}}},18981:(e,n,a)=>{"use strict";a.r(n)},19600:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(20763),n)},19713:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.PlayIcon=void 0;const o=r(a(48431));n.PlayIcon=()=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 10 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M3.42091 1.88293L8.47768 5.81597C9.2498 6.41651 9.2498 7.58349 8.47768 8.18403L3.42091 12.1171C2.43562 12.8834 1 12.1813 1 10.933V7V3.06696C1 1.81874 2.43562 1.11659 3.42091 1.88293Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinejoin:"round"}))},19970:(e,n,a)=>{"use strict";a.r(n)},20421:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(12185),n),o(a(40109),n),o(a(93285),n),o(a(70871),n),o(a(88604),n)},20433:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useClickAway=void 0;const r=a(48431);n.useClickAway=(e,n)=>{const a=(0,r.useRef)(n);(0,r.useEffect)((()=>{a.current=n}),[n]),(0,r.useEffect)((()=>{const handler=n=>{const{current:r}=e;r&&!r.contains(n.target)&&a.current(n)};return document.addEventListener("mousedown",handler),()=>{document.removeEventListener("mousedown",handler)}}),[e])}},20471:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(81766),n)},20636:(e,n,a)=>{"use strict";a.r(n)},20763:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Avatar=void 0,a(43502);const o=r(a(48431)),l={default:36,small:20};n.Avatar=({alt:e,icon:n,shape:a="square",size:r="default",src:i,...s})=>{const c=l[r],u=["code-buddy-avatar",`code-buddy-avatar-${a}`].join(" ");let d;return i&&"string"==typeof i?d=o.default.createElement("img",{src:i,alt:e,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"circle"===a?"50%":4}}):o.default.isValidElement(i)?d=i:n&&(d=n),o.default.createElement("div",{className:u,style:{width:c,height:c,fontSize:c/2},...s},o.default.createElement("span",{className:"code-buddy-avatar-content"},d))}},20815:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.troubleshootingUrl=n.useInstalledCardL10n=n.useTabL10n=void 0;const r=a(19606);n.useTabL10n=()=>{const e=(0,r.useIntl)();return{market:e.formatMessage({id:"MCP Market"}),installed:e.formatMessage({id:"Installed"}),addMcpServer:e.formatMessage({id:"Add MCP Server"}),configFile:e.formatMessage({id:"Configure .json file"})}};n.useInstalledCardL10n=()=>{const e=(0,r.useIntl)();return{installedSuccessfully:e.formatMessage({id:"MCP Server has been installed successfully, and the function of the server can be demonstrated by using one of the tools provided by the server"}),tryToRun:e.formatMessage({id:"Try to Run"}),edit:e.formatMessage({id:"Edit"}),delete:e.formatMessage({id:"Delete"}),reconnect:e.formatMessage({id:"Reconnect"}),troubleshooting:e.formatMessage({id:"MCP Troubleshooting"}),copy:e.formatMessage({id:"Copy Log"})}},n.troubleshootingUrl="https://cloud.tencent.com/document/product/1749/116012#390560ab-3081-45d6-9013-757be61e2e91"},20993:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(42225),n)},21384:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.LeftArrowIcon=void 0;const o=r(a(48431));n.LeftArrowIcon=()=>o.default.createElement("svg",{width:"6",height:"12",viewBox:"0 0 6 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M5.3464 1.30566L0.652344 5.99972L5.3464 10.6938",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},21436:(e,n,a)=>{"use strict";a.r(n)},23103:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconTextButton=void 0;const o=r(a(73059)),l=r(a(48431));n.IconTextButton=e=>{const{className:n,size:a,icon:r,text:i,...s}=e;return l.default.createElement("div",{className:(0,o.default)("codebuddy-icon-text-button",a,n),title:i,...s},r," ",i)}},23166:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ObservableUtils=void 0;const r=a(97317),o=a(90905),l=a(33815),i=a(76503);n.ObservableUtils=class ObservableUtils{static async toObject(e,n){var a,r;const o=await this.toArray(e,n),i=l.CodeCompletionResponse.from([]);for(const e of o)for(let n=0;n<e.results.length;n++){const o=e.results[n];i.results[n]?i.results[n]={output:i.results[n].output+o.output,metadata:{...o.metadata}}:i.results[n]={...o},e.metadata&&(i.metadata={...e.metadata,extra:{...null===(a=i.metadata)||void 0===a?void 0:a.extra,...null===(r=e.metadata)||void 0===r?void 0:r.extra}})}return{...i,result:i.results[0]}}static toArray(e,n){return new Promise(((a,r)=>{const o=[];e.subscribe({next:e=>{o.push(e),null==n||n(e)},error:e=>r(e),complete:()=>a(o)})}))}static splitByLineCount(e,n=10){let a,r,o="";return{part:new Promise((e=>{r=e})),full:new Promise(((i,s)=>{this.toObject(e,(e=>{var i;e.metadata&&(a=e.metadata),o+=e.results[0].output;const s=o.split("\n");if(s.length-1>=n&&r){const o=s.slice(0,n+1).join("\n"),c=l.Generation.from(o,(null===(i=e.results[0])||void 0===i?void 0:i.metadata)||{}),u=l.CodeCompletionResponse.from([c],a);r(u),r=void 0}})).then((e=>{r&&r(e),i(e)})).catch((e=>{s(e),r&&r(Promise.reject(e))}))}))}}static chatToCodeCompletionObservable(e){return e.pipe((0,o.map)((e=>{var n,a;const r=e.results.map((e=>{var n;const a=e.output,r=null!==(n=e.metadata.finishReason)&&void 0!==n?n:"",o=i.CodeCompletionGenerationMetadata.from(r);return l.Generation.from(a.content,o)})),o=l.CodeCompletionResponseMetadata.builder().id(null!==(n=e.metadata.id)&&void 0!==n?n:"").model(null!==(a=e.metadata.model)&&void 0!==a?a:"").rateLimit(e.metadata.rateLimit).build();return l.CodeCompletionResponse.from(r,o)})))}static splitByLineCountToObservable(e,n=10){let a="",o="",i=!1;const s=[],c=[];let u,d;const f=new r.Observable((e=>(u=e,()=>{u=void 0}))),m=new r.Observable((e=>(d=e,()=>{d=void 0})));return e.subscribe({next(e){if(0===e.results.length)return;d&&c.length>0&&(c.forEach((e=>null==d?void 0:d.next(e))),c.length=0),u&&s.length>0&&(s.forEach((e=>null==u?void 0:u.next(e))),s.length=0),a=o,o+=e.results[0].output;const r=o.split("\n"),f=r.length-1>=n;if(!i&&f){const f=r.slice(0,n).join("\n"),m=o.substring(f.length+1),p=l.CodeCompletionResponse.from([l.Generation.from(f.substring(a.length),e.results[0].metadata)],e.metadata);u||s.push(p),null==u||u.complete();const v=l.CodeCompletionResponse.from([l.Generation.from(m,e.results[0].metadata)],e.metadata);return d||c.push(v),null==d||d.next(v),void(i=!0)}i?(d||c.push(e),null==d||d.next(e)):(u||s.push(e),null==u||u.next(e))},complete(){null==u||u.complete(),null==d||d.complete()},error(e){null==u||u.error(e),null==d||d.error(e)}}),{prefix:f,rest:m}}static appendMetadata(e,n){let a=!0;return e.pipe((0,o.map)((e=>{var r;return a?(a=!1,{...e,metadata:{...e.metadata,...n,extra:{...(null===(r=e.metadata)||void 0===r?void 0:r.extra)||{},...n.extra}}}):e})))}}},23674:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AddIcon=void 0;const o=r(a(48431));n.AddIcon=()=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.3496 12.9996C7.3496 13.3586 7.64062 13.6496 7.9996 13.6496C8.35859 13.6496 8.6496 13.3586 8.6496 12.9996L8.6496 8.6496H12.9996C13.3586 8.6496 13.6496 8.35859 13.6496 7.9996C13.6496 7.64062 13.3586 7.3496 12.9996 7.3496H8.6496L8.64961 2.99961C8.64961 2.64062 8.35859 2.34961 7.99961 2.34961C7.64062 2.34961 7.34961 2.64062 7.34961 2.99961L7.3496 7.3496H2.99961C2.64062 7.3496 2.34961 7.64062 2.34961 7.9996C2.34961 8.35859 2.64062 8.6496 2.99961 8.6496H7.3496L7.3496 12.9996Z",fill:"currentColor"}))},23675:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Tooltip=function Tooltip({children:e,...n}){return c.createElement(s.Tooltip,{className:"codebuddy-tooltip",...n},e)},a(88469);const s=a(60139),c=i(a(48431))},24117:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.InvokableAgentDispatcherImpl=void 0;const l=a(15985),i=a(63868),s=a(66952),c=a(93108);let u=class InvokableAgentDispatcherImpl{init(){this.invokableAgentMap=new Map;for(const e of this.invokableAgents)this.invokableAgentMap.set(e.name,e)}resolveInvokableAgent(e){var n;const a=this.invokableAgentMap.get(e.name);if(!a)for(const a of this.invokableAgents)if(null===(n=e.tags)||void 0===n?void 0:n.includes(a.name))return a;if(!a)throw new l.IllegalArgumentError(`Invokable agent not found  for agent "${e.name}"`);return a}async dispatch(e){var n,a,r,o;const s=e.agentContext,c=null!==(n=s.agent)&&void 0!==n?n:await this.agentManager.getAgent(e.agent),u=this.resolveInvokableAgent(c);s.agent=c;const d=null===(a=s.modelOptions)||void 0===a?void 0:a.signal;s.variables=s.variables||[];const f=i.ContextVariableUtils.toObject(s.variables);if(c.variables){const e=c.variables.map((e=>"string"==typeof e?{name:e}:e)).filter((e=>!f[e.name]));if(e.length){(await this.contextVariableManager.getContextVariables(e,{signal:d})).forEach((e=>{s.variables.push(e),f[e.name]=e.value}))}}const m=null!==(r=s.modelOptions)&&void 0!==r?r:{},p=await this.agentManager.getAgentModel(c.name,m.model);l.Assert.hasLength(null==p?void 0:p.id,"Language model is required"),this.logger.info(`Language model: ${null==p?void 0:p.id}`),m.model=null==p?void 0:p.id,s.modelOptions=m;const v={variables:f,tags:[c.name,(null==p?void 0:p.id)||""]};let h=c.instructions||"";const g=await this.promptManager.get(c.instructions||"",v);return g&&(h=g.template),s.instructions=await this.promptManager.render(h,v),null===(o=m.signal)||void 0===o||o.throwIfAborted(),u.call(s)}};n.InvokableAgentDispatcherImpl=u,r([(0,l.Autowired)(c.InvokableAgent),o("design:type",Array)],u.prototype,"invokableAgents",void 0),r([(0,l.Autowired)(c.AgentManager),o("design:type",Object)],u.prototype,"agentManager",void 0),r([(0,l.Autowired)(i.ContextVariableManager),o("design:type",Object)],u.prototype,"contextVariableManager",void 0),r([(0,l.Autowired)(s.PromptManager),o("design:type",Object)],u.prototype,"promptManager",void 0),r([(0,l.Autowired)(l.Logger),o("design:type",Object)],u.prototype,"logger",void 0),r([(0,l.PostConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],u.prototype,"init",null),n.InvokableAgentDispatcherImpl=u=r([(0,l.Component)(c.AgentDispatcher)],u)},25380:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(35372),n),o(a(75538),n),o(a(20433),n),o(a(76514),n),o(a(81768),n),o(a(93660),n),o(a(10704),n),o(a(73751),n),o(a(91963),n)},25794:(e,n,a)=>{"use strict";a.r(n)},26314:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.rehypeCode=void 0;const r=a(78039),o=a(48802);n.rehypeCode=()=>e=>{(0,r.visit)(e,{type:"element",tagName:"code"},((n,a,r)=>{if(r&&isPreNode(r)){const a=getLanguage(n),o=getComplete(e,r),l=n.children[0].value;if(o){const e=replaceToDiffNode(n);mergeNodeData(r,{diffCode:e})}mergeNodeData(r,{complete:o,language:a,content:l}),mergeNodeData(n,{inline:!1})}else mergeNodeData(n,{inline:!0})}))};const l="language-",getLanguage=e=>{const n=e.properties.className;if(!Array.isArray(n))return"";for(const e of n)if(e.startsWith(l))return e.slice(9);return""},getComplete=(e,n)=>{var a,r,o,l;return(null!==(r=null===(a=e.position)||void 0===a?void 0:a.end.offset)&&void 0!==r?r:0)>(null!==(l=null===(o=n.position)||void 0===o?void 0:o.end.offset)&&void 0!==l?l:0)},isPreNode=e=>"element"===e.type&&"pre"===e.tagName,replaceToDiffNode=e=>{const n=e.children[0],{valid:a,replaced:r,filePath:i,originalCode:s,newCode:c}=(0,o.toDiff)(n.value);return a&&(n.value=r,e.properties.className=[`${l}diff`]),{filePath:i,originalCode:s,newCode:c}},mergeNodeData=(e,n)=>{e.data||(e.data={}),Object.assign(e.data,n)}},26401:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(27757),n)},26936:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shouldResolveCode=n.likePath=void 0;const a=/^[a-zA-Z_][a-zA-Z0-9_]*$/,r=/^(?:[a-zA-Z]:[\\/]|[\\/])[\w\-. ]+[\\/]?/,o=/^(?![.\\/]$)[\w\-.]*([\\/][\w\-.]+)*$/,l=/^[\w\-.]+\.[a-zA-Z0-9]+$/,i=/^.+#L\d+(?:-L\d+)?$/;n.likePath=e=>r.test(e)||o.test(e)||l.test(e)||i.test(e);n.shouldResolveCode=e=>(e=>a.test(e))(e)||(0,n.likePath)(e)},27083:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ToggleButton=void 0,a(6661);const c=s(a(73059)),u=i(a(48431));n.ToggleButton=e=>{const{value:n,options:a,onToggled:r}=e,o=(0,u.useCallback)((e=>{r(e)}),[r]);return u.default.createElement("div",{className:"codebuddy-toggle-button"},a.map((({label:e,value:a},r)=>u.default.createElement("span",{key:r,className:(0,c.default)("toggle-button",{active:n===a}),onClick:()=>o(a)},e))))}},27330:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Snapshot=function Snapshot(){var e,n,a;const r=c.ContainerUtil.get(d.ChatViewService),o=c.ContainerUtil.get(d.FileTreeViewService),l=(0,p.useContext)(h.ConversationContext),[i,s]=(0,p.useState)([]),[E,w]=(0,p.useState)(!1),O=(0,p.useMemo)((()=>i.filter((e=>C.SnapshotUtils.getFileStatus(e.filePath)===u.FileNodeStatus.IDLE))),[i]),M=(0,p.useMemo)((()=>i.some((e=>C.SnapshotUtils.getFileStatus(e.filePath)===u.FileNodeStatus.PENDING))),[i]),S=null===(n=null===(e=null==l?void 0:l.conversationState)||void 0===e?void 0:e.conversation)||void 0===n?void 0:n.id,P=null===(a=null==l?void 0:l.conversationState.conversation)||void 0===a?void 0:a.workspace,T=(0,p.useContext)(g.GlobalContext),{formatMessage:j}=(0,f.useIntl)(),getFileTree=async()=>{if(!S)return void s([]);const e=await o.getFileTree();s(e.filter((e=>{var n,a;const r=null===(n=e.versions)||void 0===n?void 0:n.reduce(((e,n)=>{var a,r;return("diff"in n&&null!==(r=null===(a=n.diff)||void 0===a?void 0:a.addedLines)&&void 0!==r?r:0)+e}),0),o=null===(a=e.versions)||void 0===a?void 0:a.reduce(((e,n)=>{var a,r;return("diff"in n&&null!==(r=null===(a=n.diff)||void 0===a?void 0:a.removedLines)&&void 0!==r?r:0)+e}),0);return!(0===r&&0===o)})))},getReportArgs=e=>({mode:null==T?void 0:T.globalState.mode,languageIdMap:e.reduce(((e,n)=>(e[n]=(0,b.getLanguageId)(n.split("/").pop()||""),e)),{})});return(0,p.useEffect)((()=>{const e=o.fileTreeObserver.subscribe(getFileTree);return()=>e.unsubscribe()}),[S]),p.default.createElement(p.default.Fragment,null,i.length>0&&p.default.createElement("div",{className:(0,m.default)("snapshot-wrapper",{expand:E})},p.default.createElement("div",{className:"snapshot-top"},p.default.createElement("div",{className:"file-summary",onClick:()=>w(!E)},p.default.createElement(v.ChevronRightIcon,{className:"codicon"}),p.default.createElement("div",{className:"file-info"},j({id:"{num} files"},{value:i.length})),0===O.length&&M&&p.default.createElement("div",{className:"file-status"},p.default.createElement("span",null,j({id:"Generating"})),p.default.createElement("span",{className:"loading-dots"}))),p.default.createElement("div",{style:{display:"flex",gap:8}},O.length>0&&p.default.createElement(p.default.Fragment,null,p.default.createElement(y.default,{type:"primary",size:"small",onClick:async()=>{const e=i.filter((e=>C.SnapshotUtils.getFileStatus(e.filePath)===u.FileNodeStatus.IDLE)).map((e=>e.filePath));o.acceptFiles(e),o.reportFileOperation(e,getReportArgs(e))},btnText:j({id:"Accept"})}),p.default.createElement(y.default,{size:"small",onClick:async()=>{const e=i.filter((e=>C.SnapshotUtils.getFileStatus(e.filePath)===u.FileNodeStatus.IDLE)).map((e=>e.filePath));o.rejectFiles(e),o.reportFileOperation(e,getReportArgs(e),!1)},btnText:j({id:"Reject"})})),p.default.createElement(y.default,{size:"small",outline:!0,onClick:async()=>{r.showFileChanges(i)},btnText:j({id:"Diff"})}))),E&&p.default.createElement("div",{className:"snapshot-content"},i.map(((e,n)=>p.default.createElement(_.SnapshotFile,{key:`${e.filePath}-${n}`,workspace:P,file:e}))))))},a(53760);const c=a(15985),u=a(51662),d=a(69022),f=a(19606),m=s(a(73059)),p=i(a(48431)),v=a(48924),h=a(32134),g=a(60742),y=s(a(6949)),b=a(50759),_=a(49845),C=a(48770)},27643:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.CodeCompletion=n.CodeCompletionFinishReason=n.Choice=n.CodeCompletionRequest=n.TencentAPI=n.TencentAPIOptions=void 0;const l=a(88873),i=a(50029),s=a(45157);n.TencentAPIOptions=Symbol("TencentAPIOptions"),n.TencentAPI=Symbol("TencentAPI");class CodeCompletionRequest{}n.CodeCompletionRequest=CodeCompletionRequest,r([(0,s.Expose)({name:"frequency_penalty"}),o("design:type",Number)],CodeCompletionRequest.prototype,"frequencyPenalty",void 0),r([(0,s.Expose)({name:"presence_penalty"}),o("design:type",Number)],CodeCompletionRequest.prototype,"presencePenalty",void 0),r([(0,s.Expose)({name:"stream_options"}),(0,s.Type)((()=>l.StreamOptions)),o("design:type",l.StreamOptions)],CodeCompletionRequest.prototype,"streamOptions",void 0),r([(0,s.Expose)({name:"top_p"}),o("design:type",Number)],CodeCompletionRequest.prototype,"topP",void 0),r([(0,s.Exclude)(),o("design:type",AbortSignal)],CodeCompletionRequest.prototype,"signal",void 0);class Choice{}var c;n.Choice=Choice,r([(0,s.Expose)({name:"finish_reason"}),o("design:type",String)],Choice.prototype,"finishReason",void 0),function(e){e.STOP="stop",e.LENGTH="length",e.CONTENT_FILTER="content_filter"}(c||(n.CodeCompletionFinishReason=c={}));class CodeCompletion{}n.CodeCompletion=CodeCompletion,r([(0,s.Type)((()=>Choice)),o("design:type",Array)],CodeCompletion.prototype,"choices",void 0),r([(0,s.Expose)({name:"system_fingerprint"}),o("design:type",String)],CodeCompletion.prototype,"systemFingerprint",void 0),r([(0,s.Type)((()=>i.Usage)),o("design:type",i.Usage)],CodeCompletion.prototype,"usage",void 0)},27757:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Select=function Select(e){return c.createElement(s.Select.Root,{value:e.value,defaultValue:e.defaultValue,onValueChange:e.onValueChange},c.createElement(s.Select.Trigger,null),c.createElement(s.Select.Content,{className:e.className},c.createElement(s.Select.Group,null,e.options.map((e=>c.createElement(s.Select.Item,{key:e.value,value:e.value,disabled:e.disabled},e.label))))))},a(58591);const s=a(60139),c=i(a(48431))},27899:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.CopyIcon=void 0;const o=r(a(48431));n.CopyIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{className:e,style:n,...a,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M4.5 11.5C4.5 12.0523 4.94772 12.5 5.5 12.5H12C12.5523 12.5 13 12.0523 13 11.5V6.99299C13 6.44071 12.5523 5.99299 12 5.99299H9.9324C9.38012 5.99299 8.9324 5.54528 8.9324 4.99299V3C8.9324 2.44771 8.48469 2 7.9324 2H5.5C4.94772 2 4.5 2.44772 4.5 3V11.5Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M8.5293 2.19629L12.6563 6.22913",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M2.5 6.5V11.5C2.5 13.1569 3.84315 14.5 5.5 14.5H9.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},29530:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.RefreshIcon=void 0;const o=r(a(48431));n.RefreshIcon=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M1.75 8.19385C1.75 4.66629 4.60965 1.80664 8.13721 1.80664C10.5014 1.80664 12.5655 3.0911 13.6699 5.00024",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M14.25 2.80664V4.80664C14.25 5.08278 14.0261 5.30664 13.75 5.30664H11.75",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M14.25 7.80667C14.25 11.3339 11.3906 14.1934 7.86331 14.1934C5.49934 14.1934 3.43534 12.909 2.33105 11",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M1.66211 13V11C1.66211 10.7239 1.88597 10.5 2.16211 10.5H4.16211",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}))},29614:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThumbsUpSolidIcon=void 0;const o=r(a(48431));n.ThumbsUpSolidIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("g",null,o.default.createElement("path",{d:"M8.50049 0.974609C9.41158 0.97482 10.1499 1.71386 10.1499 2.625V5.22461H13.2378C14.3016 5.22479 15.0869 6.21731 14.8433 7.25293L13.314 13.7529C13.1385 14.4979 12.4739 15.0242 11.7085 15.0244H2.50049C1.58935 15.0244 0.850309 14.2861 0.850098 13.375V8.375C0.850098 7.46373 1.58922 6.72461 2.50049 6.72461H3.23779V15.0225H4.5376V6.72461L6.15283 2.08301C6.38356 1.41966 7.00909 0.974609 7.71143 0.974609H8.50049Z",fill:"#808080"})))},30423:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.RatingBar=function RatingBar(e){const{conversationId:n,message:a}=e,[r,o]=(0,u.useState)(0),[l,i]=(0,u.useState)([]),[s,_]=(0,u.useState)(!1),{eventMap:C,report:E}=(0,m.useDataReport)(),w=(0,u.useContext)(f.GlobalContext),O=(0,c.useIntl)(),t=e=>O.formatMessage({id:e}),M=[{label:t("Misunderstanding"),value:"wrong_understanding"},{label:t("Context Error"),value:"wrong_context"},{label:t("Answer Obscure"),value:"wrong_result"},{label:t("Code Error"),value:"wrong_code"},{label:t("Unprofessional Answer"),value:"unsatisfied_answer"},{label:t("Code Format Error"),value:"wrong_format_code"},{label:t("Poor Readability"),value:"bad_code_readability"},{label:t("Other"),value:" others"}],S=(0,u.useCallback)((e=>{l.includes(e)?i(l.filter((n=>n!==e))):i([...l,e])}),[l]),P=(0,u.useCallback)((()=>{o(-1),reportLikeDislike("dislike"),_(!1)}),[a,n,l]),T=(0,u.useCallback)((()=>{r>=0?_(!0):o(0)}),[r]),reportLikeDislike=e=>{var r,o;E(C.ChatUserAction,{conversationId:n,requestId:(null==a?void 0:a.requestId)||"",messageId:(null==a?void 0:a.id)||"",mode:(null==w?void 0:w.globalState.mode)||"",scene:"userFeedback",action:e,requestModelId:(null===(r=null==a?void 0:a.extra)||void 0===r?void 0:r.modelId)||"",requestModelName:(null===(o=null==a?void 0:a.extra)||void 0===o?void 0:o.modelName)||""},{})},j=(0,u.useCallback)((e=>{e||i([])}),[]),k=(0,u.useCallback)((e=>{e>0&&(_(!1),reportLikeDislike("like")),o(e)}),[]);return u.default.createElement("div",{className:"rating-bar"},u.default.createElement("div",{className:"btn-action"},r>0?u.default.createElement("div",{className:"icon",onClick:()=>k(0)},u.default.createElement(b.ThumbsUpSolidIcon,null)):u.default.createElement("div",{className:"icon",onClick:()=>k(1)},u.default.createElement(y.ThumbsUpIcon,null)),u.default.createElement(d.ChatPopover,{open:s,onOpenChange:j,onTrigger:T,trigger:u.default.createElement("div",{className:"icon"},r<0?u.default.createElement(g.ThumbsDownSolidIcon,null):u.default.createElement(h.ThumbsDownIcon,null))},u.default.createElement("div",{className:"feedback-box"},u.default.createElement("div",{className:"feedback-head"},u.default.createElement("div",{className:"unhelpful-box"},u.default.createElement("span",null,t("This answer needs improvement"))),u.default.createElement("div",{className:"icon",onClick:()=>_(!1)},u.default.createElement(v.CloseIcon,null))),u.default.createElement("div",{className:"feedback-content"},u.default.createElement("ul",{className:"feedback-item-box"},M.map(((e,n)=>u.default.createElement("li",{className:["feedback-item",l.includes(e.value)?"active":""].join(" "),key:n,onClick:()=>S(e.value)},e.label))))),u.default.createElement("div",{className:"feedback-footer"},u.default.createElement(p.default,{type:"primary",width:"100%",btnText:t("Submit"),disabled:!l.length,onClick:P}))))))},a(64921);const c=a(19606),u=i(a(48431)),d=a(64900),f=a(99095),m=a(25380),p=s(a(6949)),v=a(70605),h=a(48135),g=a(56485),y=a(62296),b=a(29614)},30750:(e,n,a)=>{"use strict";a.r(n)},31041:(e,n,a)=>{"use strict";a.r(n)},31055:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.WarnIcon=void 0;const o=r(a(48431));n.WarnIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("g",{id:"å¾æ _12px"},o.default.createElement("path",{id:"Vector 3964",d:"M0.844116 9.04262L5.23351 1.90986C5.58494 1.33877 6.41506 1.33878 6.76649 1.90986L11.1559 9.04262C11.5249 9.64226 11.0935 10.4143 10.3894 10.4143H1.61061C0.906519 10.4143 0.475105 9.64226 0.844116 9.04262Z",stroke:"#EE9D28",strokeWidth:"0.975"}),o.default.createElement("path",{id:"Vector 3965",d:"M6 4.56958L6 6.81958",stroke:"#EE9D28",strokeWidth:"0.975",strokeLinecap:"round"}),o.default.createElement("path",{id:"Vector 3966",d:"M6 8.38843L6 8.37598",stroke:"#EE9D28",strokeWidth:"0.975",strokeLinecap:"round"})))},31463:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SuccessIcon=void 0;const o=r(a(48431));n.SuccessIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",className:e,style:n,...a},o.default.createElement("rect",{x:"1.5",y:"2.07324",width:"13",height:"13",rx:"6.5",stroke:"#40C8AE",strokeWidth:"1.3"}),o.default.createElement("path",{d:"M10.8239 6.68848L7.05432 10.458",stroke:"#40C8AE",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M7.05451 10.4582L5.17624 8.58008",stroke:"#40C8AE",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},31771:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.FilterIcon=n.CommandIcon=void 0,n.CloseIcon=function CloseIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},o.default.createElement("path",{d:"M9.375 2.625L2.625 9.375",stroke:"#606060",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M9.375 9.375L2.625 2.625",stroke:"#606060",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}))},n.SendIcon=function SendIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),xmlns:"http://www.w3.org/2000/svg",width:"14",height:"15",viewBox:"0 0 14 15",fill:"none"},o.default.createElement("g",{clipPath:"url(#clip0_23548_28575)"},o.default.createElement("path",{className:"fill-color",d:"M10.9961 3.47849L1.52387 6.34219C1.05811 6.483 0.966283 7.10229 1.37114 7.37219L4.66055 9.56513L8.31097 6.77363C8.38215 6.71921 8.47299 6.81005 8.41857 6.88123L5.62707 10.5317L7.82001 13.8211C8.08991 14.2259 8.7092 14.1341 8.85001 13.6683L11.7137 4.19611C11.8467 3.75621 11.436 3.3455 10.9961 3.47849Z"})),o.default.createElement("defs",null,o.default.createElement("clipPath",{id:"clip0_23548_28575"},o.default.createElement("rect",{y:"0.785156",width:"14",height:"14",rx:"4.375",fill:"white"}))))},n.BackIcon=function BackIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M8.84182 3.13514C9.04327 3.32401 9.05348 3.64042 8.86462 3.84188L5.43521 7.49991L8.86462 11.1579C9.05348 11.3594 9.04327 11.6758 8.84182 11.8647C8.64036 12.0535 8.32394 12.0433 8.13508 11.8419L4.38508 7.84188C4.20477 7.64955 4.20477 7.35027 4.38508 7.15794L8.13508 3.15794C8.32394 2.95648 8.64036 2.94628 8.84182 3.13514Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))},n.CheckIcon=function CheckIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M9.89836 3.40517C10.0887 3.21527 10.3975 3.21513 10.5878 3.40517C10.7779 3.59544 10.7777 3.90428 10.5878 4.09463L5.2841 9.39834C5.27356 9.40887 5.26017 9.41632 5.24894 9.42568C5.23708 9.43555 5.22632 9.44641 5.21379 9.45498C5.19968 9.46465 5.18468 9.47234 5.16984 9.48037C5.15913 9.48615 5.14864 9.49205 5.13762 9.49697C5.12006 9.50483 5.1021 9.51083 5.0839 9.5165C5.07412 9.51955 5.06453 9.52288 5.05461 9.52529C5.03748 9.52947 5.02026 9.53178 5.00285 9.53408C4.99111 9.53563 4.9795 9.5373 4.96769 9.53799C4.9507 9.53899 4.93391 9.53875 4.91691 9.53799C4.90545 9.53746 4.89414 9.53639 4.88273 9.53506C4.86432 9.53293 4.84616 9.53049 4.82805 9.52627C4.8205 9.5245 4.81305 9.52254 4.80558 9.52041C4.72848 9.49848 4.65536 9.45899 4.59465 9.39834C4.59292 9.39661 4.59146 9.39423 4.58976 9.39248L1.41301 6.21572C1.22268 6.02535 1.22268 5.71664 1.41301 5.52627C1.60339 5.33607 1.91213 5.33599 2.10246 5.52627L4.93937 8.36318L9.89836 3.40517Z",fill:"currentColor"}))},n.FileIcon=function FileIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M3.5 2C3.22386 2 3 2.22386 3 2.5V12.5C3 12.7761 3.22386 13 3.5 13H11.5C11.7761 13 12 12.7761 12 12.5V6H8.5C8.22386 6 8 5.77614 8 5.5V2H3.5ZM9 2.70711L11.2929 5H9V2.70711ZM2 2.5C2 1.67157 2.67157 1 3.5 1H8.5C8.63261 1 8.75979 1.05268 8.85355 1.14645L12.8536 5.14645C12.9473 5.24021 13 5.36739 13 5.5V12.5C13 13.3284 12.3284 14 11.5 14H3.5C2.67157 14 2 13.3284 2 12.5V2.5Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))},n.FolderIcon=function FolderIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"15",height:"15",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2h16V8h-8.825l-2-2H4zm0 0V6z"}))},n.AskIcon=function AskIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("g",{id:"å¾æ _12px"},o.default.createElement("path",{id:"Union",d:"M6.00024 1.62891L6.00027 1.14391H6.00024V1.62891ZM10.8977 5.91504L11.3827 5.91507V5.91504H10.8977ZM6.00024 10.2002V10.6852H6.00027L6.00024 10.2002ZM4.12231 9.87402L4.288 9.4182L4.14847 9.36749L4.00446 9.40356L4.12231 9.87402ZM2.16138 10.3652L2.2783 10.8359L2.27923 10.8357L2.16138 10.3652ZM1.91919 10.1211L1.44919 10.0014L1.44918 10.0015L1.91919 10.1211ZM2.28052 8.70215L2.75052 8.82183L2.81782 8.55753L2.62695 8.36272L2.28052 8.70215ZM1.10181 5.91504H0.616807V5.91507L1.10181 5.91504ZM6.00024 1.62891L6.00022 2.11391C8.50016 2.11404 10.4127 3.87468 10.4127 5.91504H10.8977H11.3827C11.3827 3.22154 8.91038 1.14406 6.00027 1.14391L6.00024 1.62891ZM10.8977 5.91504L10.4127 5.91501C10.4126 7.95516 8.50017 9.71506 6.00022 9.7152L6.00024 10.2002L6.00027 10.6852C8.91016 10.685 11.3825 8.60853 11.3827 5.91507L10.8977 5.91504ZM6.00024 10.2002V9.7152C5.39145 9.7152 4.81311 9.60907 4.288 9.4182L4.12231 9.87402L3.95663 10.3298C4.58809 10.5594 5.27859 10.6852 6.00024 10.6852V10.2002ZM4.12231 9.87402L4.00446 9.40356L2.04353 9.89477L2.16138 10.3652L2.27923 10.8357L4.24016 10.3445L4.12231 9.87402ZM2.16138 10.3652L2.04445 9.89454C2.25528 9.84217 2.44194 10.0335 2.3892 10.2407L1.91919 10.1211L1.44918 10.0015C1.32182 10.5018 1.77404 10.9612 2.2783 10.8359L2.16138 10.3652ZM1.91919 10.1211L2.38919 10.2408L2.75052 8.82183L2.28052 8.70215L1.81052 8.58246L1.44919 10.0014L1.91919 10.1211ZM2.28052 8.70215L2.62695 8.36272C1.97154 7.6938 1.58687 6.83911 1.58681 5.91501L1.10181 5.91504L0.616807 5.91507C0.616891 7.12003 1.12093 8.21165 1.93409 9.04158L2.28052 8.70215ZM1.10181 5.91504H1.58681C1.58681 3.87469 3.50008 2.11391 6.00024 2.11391V1.62891V1.14391C3.09008 1.14391 0.616807 3.22135 0.616807 5.91504H1.10181Z",fill:"currentColor"}),o.default.createElement("path",{id:"Vector 4433",d:"M4.68896 7.20605C4.68896 7.20605 5.29162 7.70818 6.1554 7.70818C7.01917 7.70818 7.62183 7.20605 7.62183 7.20605",stroke:"currentColor",strokeWidth:"0.97",strokeLinecap:"round"})))},n.CraftIcon=function CraftIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("g",{id:"å¾æ _12px"},o.default.createElement("path",{id:"Rectangle 346241916",d:"M1 2.38281C1 1.83053 1.44772 1.38281 2 1.38281H3.83333C3.94152 1.38281 4.04679 1.4179 4.13333 1.48281L5.36667 2.40781C5.45321 2.47272 5.55848 2.50781 5.66667 2.50781H10C10.5523 2.50781 11 2.95553 11 3.50781V9.38281C11 9.9351 10.5523 10.3828 10 10.3828H2C1.44772 10.3828 1 9.9351 1 9.38281V2.38281Z",stroke:"currentColor",strokeWidth:"0.97"}),o.default.createElement("path",{id:"Vector 4431",d:"M3.38965 5.46094L4.15311 5.84267C4.52164 6.02693 4.52164 6.55283 4.15311 6.7371L3.38965 7.11883",stroke:"currentColor",strokeWidth:"0.97",strokeLinecap:"round"}),o.default.createElement("path",{id:"Vector 4432",d:"M6.8291 6.39258H8.48699",stroke:"currentColor",strokeWidth:"0.97",strokeLinecap:"round"})))},n.StopIcon=function StopIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M2 3C2 2.44772 2.44772 2 3 2H12C12.5523 2 13 2.44772 13 3V12C13 12.5523 12.5523 13 12 13H3C2.44772 13 2 12.5523 2 12V3ZM12 3H3V12H12V3Z"}))},n.SettingIcon=function SettingIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},o.default.createElement("path",{d:"M8.51239 10.404L11.0247 6.00033L8.51239 1.59668H3.48755L0.975098 6.00033L3.48755 10.404H8.51239Z",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M5.99993 7.76451C6.97474 7.76451 7.765 6.97425 7.765 5.99944C7.765 5.02463 6.97474 4.23438 5.99993 4.23438C5.02512 4.23438 4.23486 5.02463 4.23486 5.99944C4.23486 6.97425 5.02512 7.76451 5.99993 7.76451Z",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}))},n.AcceptIcon=function AcceptIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},o.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.05569 12.5202C7.05238 12.5237 7.04902 12.5271 7.04562 12.5305C6.79178 12.7843 6.38022 12.7843 6.12638 12.5305L1.88374 8.28787C1.6299 8.03402 1.6299 7.62247 1.88374 7.36863C2.13758 7.11479 2.54914 7.11479 2.80298 7.36863L6.58589 11.1515L13.1977 4.53975C13.4515 4.2859 13.8631 4.28591 14.1169 4.53975C14.3707 4.79359 14.3707 5.20514 14.1169 5.45898L7.05569 12.5202Z",fill:"currentColor"}))},n.ChevronRightIcon=function ChevronRightIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))},n.ChevronLeftIcon=function ChevronLeftIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M7.76029 2.47949L4.23975 6.00003L7.76029 9.52058",stroke:"#808080",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}))},n.RefusedIcon=function RefusedIcon(e){return o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},o.default.createElement("path",{d:"M12.5 3.5L3.5 12.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M12.5 12.5L3.5 3.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},a(74325);const o=r(a(48431));n.CommandIcon=()=>o.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M2.625 1.6123H9.375C9.74221 1.6123 9.96862 1.61369 10.1328 1.63574C10.283 1.65593 10.3064 1.68529 10.3105 1.68945C10.3147 1.69361 10.3441 1.71701 10.3643 1.86719C10.3863 2.03138 10.3877 2.25779 10.3877 2.625V9.375C10.3877 9.74221 10.3863 9.96862 10.3643 10.1328C10.3441 10.283 10.3147 10.3064 10.3105 10.3105C10.3064 10.3147 10.283 10.3441 10.1328 10.3643C9.96862 10.3863 9.74221 10.3877 9.375 10.3877H2.625C2.25779 10.3877 2.03138 10.3863 1.86719 10.3643C1.71701 10.3441 1.69361 10.3147 1.68945 10.3105C1.68529 10.3064 1.65593 10.283 1.63574 10.1328C1.61369 9.96862 1.6123 9.74221 1.6123 9.375V2.625C1.6123 2.25779 1.61369 2.03138 1.63574 1.86719C1.65593 1.71701 1.68529 1.69361 1.68945 1.68945C1.69361 1.68529 1.71701 1.65593 1.86719 1.63574C2.03138 1.61369 2.25779 1.6123 2.625 1.6123Z",stroke:"currentColor",strokeWidth:"0.975"}),o.default.createElement("path",{d:"M7.08532 3.82282L4.53577 8.3767",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round"}));n.FilterIcon=e=>o.default.createElement("svg",{...e,className:["theme-icon",e.className||""].join(" "),xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},o.default.createElement("path",{d:"M10.0937 7.9925L13.6073 3.18966C13.79 2.94001 13.8661 2.6281 13.819 2.32239C13.7719 2.01667 13.6055 1.74212 13.3562 1.559C13.1565 1.41249 12.9153 1.3335 12.6677 1.3335H3.33102C2.68768 1.3335 2.16602 1.85583 2.16602 2.50016C2.16602 2.74816 2.24485 2.98966 2.39118 3.18966L5.90502 7.9925V14.1668C5.90502 14.443 6.12852 14.6668 6.40435 14.6668C6.53684 14.6667 6.66386 14.6139 6.75746 14.5202C6.85107 14.4264 6.9036 14.2993 6.90352 14.1668V7.82883C6.90352 7.72266 6.86968 7.61916 6.80702 7.53333L3.19668 2.59866C3.17855 2.57381 3.16765 2.54444 3.16517 2.51378C3.16269 2.48312 3.16873 2.45237 3.18263 2.42493C3.19653 2.3975 3.21775 2.37443 3.24393 2.3583C3.27012 2.34216 3.30026 2.33358 3.33102 2.3335H12.6677C12.6985 2.33355 12.7286 2.34212 12.7548 2.35825C12.781 2.37439 12.8022 2.39746 12.8161 2.42492C12.83 2.45237 12.836 2.48314 12.8335 2.5138C12.831 2.54447 12.82 2.57384 12.8018 2.59866L9.19152 7.53333C9.1288 7.61909 9.095 7.72258 9.09502 7.82883V12.7572C9.09502 13.0333 9.31852 13.2572 9.59435 13.2572C9.65997 13.2571 9.72493 13.2442 9.78554 13.219C9.84614 13.1938 9.9012 13.157 9.94757 13.1106C9.99394 13.0641 10.0307 13.009 10.0558 12.9484C10.0808 12.8878 10.0937 12.8228 10.0937 12.7572V7.9925Z",fill:"currentColor"}))},32134:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ConversationContext=n.ConversationIdContext=void 0;const r=a(48431);n.ConversationIdContext=(0,r.createContext)(""),n.ConversationContext=(0,r.createContext)({conversationState:{},getCurrentConversation:()=>{}})},33229:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.GuideList=function GuideList(e){const n=i.default.useRef(0),a=i.default.useRef(!1),r=(0,s.useNavigate)(),v=(0,d.getFileSearchViewService)(),{eventMap:h,report:g}=(0,c.useDataReport)(),y=o.ContainerUtil.get(o.Logger),b=o.ContainerUtil.get(l.McpViewService);i.default.useEffect((()=>{setTimeout((()=>{const e=(0,f.getProcessingEvent)();e&&sendMessageTo(JSON.parse(e))}),0)}),[]);let _=[];_=Array.isArray(e.guideList)?e.guideList:e.guideList[e.workspace?m.WorkspaceStatus.HAS:m.WorkspaceStatus.NOT];const sendMessageTo=e=>{u.chatActionSubject.next(e)};return _&&_.length?i.default.createElement("ul",{className:"guide-list",onClick:async o=>{const i=Date.now();if(!(i-n.current<p||a.current)){n.current=i,a.current=!0;try{const n=getTag(o.target,"LI");if(n&&n.dataset.itemOptions){const a=JSON.parse(n.dataset.itemOptions),{workspace:o,mcp:i,...s}=a.options,c={chatType:e.isAsk?l.ChatType.ASK:l.ChatType.CRAFT,prompt:a.describe,options:{autoSend:!0,newChat:!1},...s};if(g(h.PageClick,{button:a.title,page:"home"},{}),o)return void(await v.createWorkspace(o)&&(0,f.setProcessingEvent)(JSON.stringify(c)));if(i){const e=f.McpInstallPathMap[i];if(!await b.serverIsInstalled(e))return void r("/mcp?name="+encodeURIComponent(e)+"&mcpConf="+JSON.stringify(c))}sendMessageTo(c)}}catch(e){y.error(e)}finally{a.current=!1}}}},_.map((e=>i.default.createElement("li",{className:"guide-list_item",key:e.title+e.describe,"data-item-options":JSON.stringify(e)},i.default.createElement("span",{className:"guide-list_item-title",title:e.title},e.title),i.default.createElement("span",{className:"guide-list_item-describe",title:e.describe},e.describe))))):i.default.createElement("div",null)};const o=a(15985),l=a(69022),i=r(a(48431)),s=a(15389),c=a(25380),u=a(73e3),d=a(20421),f=a(78071),m=a(96593),getTag=(e,n)=>e.tagName===n?e:e.parentElement?getTag(e.parentElement,n):void 0,p=2e3},33444:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),c=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AssistantMessageRenderer=void 0,a(40620);const d=a(398),f=a(15985),m=a(84176),p=a(59659),v=a(69022),h=a(19606),g=s(a(48431)),y=a(63306),b=a(64900),_=u(a(63235)),C=a(73e3),E=a(4882),w=a(4841),O=a(51555),M=a(47895),S=a(83917),P=a(53862),T=a(66319),j=a(52337),k=a(99095);let I=class AssistantMessageRenderer{canHandle(e){return e.messageType===d.MessageType.ASSISTANT?10:0}render(e,n,a){return g.default.createElement(N,{message:e,options:a})}};n.AssistantMessageRenderer=I,i([(0,f.Autowired)(v.ChatViewService),c("design:type",Object)],I.prototype,"chatViewService",void 0),n.AssistantMessageRenderer=I=i([(0,p.Widget)({area:y.ChatBodyConversionMessageArea.Avatar,component:T.Avatar}),(0,p.Widget)({area:y.ChatBodyConversionMessageArea.Followup,component:j.Followup}),(0,f.Component)(w.ChatMessageRenderer)],I);const N=(0,g.memo)((e=>{var n,a;const r=f.ContainerUtil.get(v.CheckpointViewService),{message:o,options:l}=e,[i,s]=(0,g.useState)(!!(null==l?void 0:l.discard)),[c,u]=(0,g.useState)(!0),[p,w]=(0,g.useState)(!1),[j,I]=(0,g.useState)(!1),[N,x]=(0,g.useState)([]),D=(0,h.useIntl)(),t=e=>D.formatMessage({id:e}),R=(0,g.useContext)(k.GlobalContext),L=null==R?void 0:R.globalState.mode,A=D.formatMessage({id:"{chatMode} has been processing for a while. You can let it continue, or accept your new requirements."},{chatMode:L===v.ChatType.ASK?"Ask":"Craft"}),F={title:t("Do you want to continue?"),content:A,buttons:[{text:t("Continue"),appearance:"primary",handle:()=>{C.chatActionSubject.next({prompt:t("Please continue to complete the above task.")}),u(!1)}},{text:t("Cancel"),appearance:"ghost",handle:()=>{u(!1)}}]},V=(0,g.useCallback)((async()=>{const e=await r.restoreToLatestVersion();if(Array.isArray(e))return x(e.map((e=>e.filePath))),void B.onOpenDialog(void 0);e?(s(!1),E.messageContextSubject.next({currentEditMessageId:"",isDiscard:!1,versionChange:!0})):_.default.error(t("Resume Failed"))}),[]),B=(0,b.useConfirmDialog)((0,g.useCallback)((async()=>{await r.restoreToLatestVersion(!0)?(s(!1),E.messageContextSubject.next({currentEditMessageId:"",isDiscard:!1,versionChange:!0}),x([])):_.default.error(t("Resume Failed"))}),[]));return(0,g.useEffect)((()=>{s(!!(null==l?void 0:l.discard))}),[l]),(0,g.useEffect)((()=>{var e,n;w((null===(e=null==l?void 0:l.nextMessage)||void 0===e?void 0:e.messageType)===d.MessageType.SYSTEM&&(null===(n=null==l?void 0:l.nextMessage)||void 0===n?void 0:n.isEnd)||!!o.isEnd&&!(null==l?void 0:l.nextMessage))}),[l,o.isEnd]),(0,g.useEffect)((()=>{I(!o.content.length&&!o.complete)}),[o]),j?(null===(n=null==l?void 0:l.prevMessage)||void 0===n?void 0:n.isEnd)?g.default.createElement(g.default.Fragment,null):g.default.createElement(O.Loading,{showAvatar:(null===(a=null==l?void 0:l.prevMessage)||void 0===a?void 0:a.messageType)===d.MessageType.USER,loadingText:t("Thinking"),timeoutText:t("Generating answer, please wait")}):g.default.createElement(g.default.Fragment,{key:o.id},g.default.createElement("div",{className:["assistant-message",(null==l?void 0:l.className)||""].join(" ")},(!(null==l?void 0:l.prevMessage)||l.prevMessage.messageType===d.MessageType.USER)&&g.default.createElement(T.Avatar,null),g.default.createElement(P.AssistantMessageContent,{message:o}),o.isMaxStepLimit&&!(null==l?void 0:l.nextMessage)&&c&&g.default.createElement(M.OperateCard,{options:F}),o.isEnd&&g.default.createElement(m.Slot,{area:y.ChatBodyConversionMessageArea.Followup})),p&&i&&g.default.createElement(S.RecoverMessage,{onReplayConversation:V}),g.default.createElement(b.Dialog,{visible:B.visible,title:t("File Changes Detected"),onClose:B.onCloseDialog,actions:g.default.createElement(g.default.Fragment,null,g.default.createElement(b.Button,{variant:"danger",onClick:B.onConfirmDialog},t("Continue")),g.default.createElement(b.Button,{variant:"secondary",onClick:B.onCloseDialog},t("Cancel")))},g.default.createElement(g.default.Fragment,null,N.length>0&&g.default.createElement("div",null,g.default.createElement("div",null,t("The following files have manual changes: ")),g.default.createElement("div",null,N.map((e=>g.default.createElement("p",null,e)))),g.default.createElement("div",null,t("Continuing will overwrite these changes. Are you sure"))))))}))},33708:(e,n,a)=>{"use strict";a.r(n)},33815:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(91713),n),o(a(63066),n),o(a(76503),n),o(a(69103),n),o(a(93737),n),o(a(50870),n),o(a(66870),n),o(a(51360),n)},34231:(e,n,a)=>{"use strict";a.r(n)},34244:(e,n,a)=>{"use strict";a.r(n)},34420:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(61148),n)},34636:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.NotifyActivity=void 0,a(95874);const s=a(15985),c=a(69022),u=a(47392),d=i(a(48431)),f=a(89317);n.NotifyActivity=d.default.memo((()=>{const e=s.ContainerUtil.get(c.ChatViewService),n=s.ContainerUtil.get(c.ActivityViewService),[a,r]=(0,d.useState)([]),reportEvent=n=>{e.report(u.Events.ActivityNotify,{activityId:n,processType:"click"})},parseMarkdownLink=e=>{const[n,a,...r]=e.replace(/\[([^\]]+)\]\(([^)]+)\)/g,((e,n,a)=>`----${n}----${a}`)).split("----");return[n,a,r.join("")]};return(0,d.useEffect)((()=>{const e=n.activitiesObserver.subscribe((e=>{(()=>{const e=n.activitiesObserver.getValue();r(e.map((e=>({...e,visible:!!e&&!!e.bannerContent&&"None"===e.status,html:parseMarkdownLink(e.bannerContent)}))))})()}));return()=>e.unsubscribe()}),[]),d.default.createElement(d.default.Fragment,null,!!a.length&&d.default.createElement("div",{className:"notify_activity"},a.map((a=>d.default.createElement(d.default.Fragment,null,a.visible&&d.default.createElement("div",{className:"notify_activity__banner",key:"activity-"+a.id,onClick:()=>reportEvent(a.id)},d.default.createElement("img",{className:"notify_activity__banner__icon",src:"./assets/image/notify-activity.png",alt:"logo"}),d.default.createElement("div",{className:"notify_activity__banner__title",onClick:()=>{return n=a.id,r=a.link,reportEvent(n),void(r&&e.openExternalLink(r));var n,r}},a.html.length>=3&&d.default.createElement(d.default.Fragment,null,a.html[0],d.default.createElement("a",{href:a.html[2]},a.html[1]))),d.default.createElement("div",{className:"notify_activity__banner__close",onClick:()=>(e=>{n.sendCloseNotifyActivity(e);const a=n.activitiesObserver.getValue();n.activitiesObserver.next(a.map((n=>(n.id===e&&(n.status="Done"),n))))})(a.id)},d.default.createElement(f.RejectIcon,null))))))))}))},34780:(e,n)=>{"use strict";var a,r;Object.defineProperty(n,"__esModule",{value:!0}),n.FileTreeService=n.FileType=n.FileNodeStatus=void 0,function(e){e.PENDING="pending",e.IDLE="idle",e.ACCEPTED="accepted",e.REJECTED="rejected",e.ERROR="error"}(a||(n.FileNodeStatus=a={})),function(e){e.FILE="file",e.FOLDER="folder"}(r||(n.FileType=r={})),n.FileTreeService=Symbol("FileTreeService")},35043:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Feedback=function Feedback(){var e,n;const a=u.ContainerUtil.get(d.ProductViewService),{message:r}=(0,p.useContext)(_.CurrentMessageContext),o=r,{conversationState:{conversation:l}}=(0,p.useContext)(y.ConversationContext),i=(0,p.useContext)(g.GlobalContext),{messages:s,deleteRun:O}=(0,p.useContext)(_.CurrentConversationContext),[M,S]=(0,p.useState)(""),[P,T]=(0,p.useState)({}),{eventMap:j,report:k}=(0,b.useDataReport)(),I=(0,m.useIntl)(),t=e=>I.formatMessage({id:e}),eventReport=e=>{var n,a;k(j.ChatUserAction,{conversationId:(null==l?void 0:l.id)||"",requestId:(null==r?void 0:r.requestId)||"",messageId:(null==r?void 0:r.id)||"",action:e,mode:(null==i?void 0:i.globalState.mode)||"",scene:"feedbackComment"===e?"userFeedback":"contentManage",requestModelId:(null===(n=null==r?void 0:r.extra)||void 0===n?void 0:n.modelId)||"",requestModelName:(null===(a=null==r?void 0:r.extra)||void 0===a?void 0:a.modelName)||""},{})},N=(0,p.useCallback)((e=>{var n,a,o;switch(e.value){case"delete":D.onOpenDialog(void 0);break;case"feedback":eventReport("feedbackComment"),u.ContainerUtil.get(f.ChatViewService).openConfigLink("craftFeedback");break;case"copyRequestId":(0,C.copyContent)(`${(null==r?void 0:r.requestId)||""}/${(null===(n=null==r?void 0:r.extra)||void 0===n?void 0:n.traceId)||(null==r?void 0:r.id)||""}`),h.default.success(t("Request ID Copied"));break;case"copyTokens":(0,C.copyContent)(`${(null===(a=null==r?void 0:r.usage)||void 0===a?void 0:a.inputTokens)||0}/${(null===(o=null==r?void 0:r.usage)||void 0===o?void 0:o.outputTokens)||0} tokens`),h.default.success(t("Tokens Copied"))}}),[r,l]),x={items:[{label:t("Delete"),value:"delete",onClick:N},...(null==P?void 0:P.craftFeedback)?[{label:t("Feedback"),value:"feedback",onClick:N}]:[],{label:t("Copy Request ID"),value:"copyRequestId",onClick:N},{label:`${(null===(e=null==r?void 0:r.usage)||void 0===e?void 0:e.inputTokens)||0}/${(null===(n=null==r?void 0:r.usage)||void 0===n?void 0:n.outputTokens)||0} tokens`,value:"copyTokens",onClick:N}]},D=(0,v.useConfirmDialog)((0,p.useCallback)((async()=>{null==O||O(null==r?void 0:r.requestId,!0),eventReport("delete")}),[O])),R={title:t("Delete Conversation"),content:t("Once deleted, the conversation history cannot be recovered. Please operate with caution!"),confirm:t("Confirm"),cancel:t("Cancel")};return(0,p.useEffect)((()=>{const e=o.requestId,n=s.reduce(((n,a)=>(a.requestId===e&&a.messageType===c.MessageType.ASSISTANT&&(n+=null==a?void 0:a.content.map((e=>e.type!==f.AssistantMessageContentType.TOOL_CALL?e.text:"")).join("\n")),n)),"");S(n||"")}),[s,o]),(0,p.useEffect)((()=>{a.getLinks().then(T)}),[]),p.default.createElement("div",{className:"feedback"},(null==r?void 0:r.messageType)===c.MessageType.ASSISTANT&&r.complete&&p.default.createElement("div",{className:"feedback__toolbar"},p.default.createElement("div",{className:"feedback__icon"},p.default.createElement(C.Copy,{content:M})),p.default.createElement(w.RatingBar,{conversationId:(null==l?void 0:l.id)||"",message:r}),p.default.createElement(v.ChatDropdown,{items:x.items},p.default.createElement("div",{className:"feedback__icon"},p.default.createElement(E.MoreIcon,null)))),p.default.createElement(v.Dialog,{visible:D.visible,title:R.title,onClose:D.onCloseDialog,actions:p.default.createElement(p.default.Fragment,null,p.default.createElement(v.Button,{variant:"danger",onClick:D.onConfirmDialog},R.confirm),p.default.createElement(v.Button,{variant:"secondary",onClick:D.onCloseDialog},R.cancel))},R.content))},a(77237);const c=a(398),u=a(15985),d=a(76243),f=a(69022),m=a(19606),p=i(a(48431)),v=a(64900),h=s(a(63235)),g=a(99095),y=a(32134),b=a(25380),_=a(4882),C=a(58271),E=a(84332),w=a(30423)},35291:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MarkdownPre=void 0;const o=r(a(48431)),l=a(10971),i=a(61529);n.MarkdownPre=e=>{const{node:n,children:a,complete:r}=e,{language:s,content:c,diffCode:u}=n.data;return"mermaid"===s?o.default.createElement(i.MarkdownPreMermaid,{complete:r,language:s,content:c},a):o.default.createElement("div",{className:"markdown-pre-container"},o.default.createElement("div",{className:"markdown-pre__header"},o.default.createElement("strong",{className:"markdown-pre__title"},s),r&&o.default.createElement(l.MarkdownPreCodeActions,{language:s,content:c,diffCode:u})),o.default.createElement("pre",{className:"markdown-pre has-scrollbar"},a))}},35372:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.useActivePage=function useActivePage(){const e=(0,m.useGuardedNavigate)(),n=(0,u.useRef)(""),a=(0,d.useLocation)();u.default.useEffect((()=>{n.current=a.pathname;const r=s.ContainerUtil.get(c.ChatViewService).activePageObserver.subscribe((a=>{n.current=a.path,f.chatActionSubject.next(a.action);const{path:r,...o}=a;e(r,o)}));return()=>{r.unsubscribe()}}),[a.pathname])};const s=a(15985),c=a(69022),u=i(a(48431)),d=a(15389),f=a(73e3),m=a(81768)},35380:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigrableModelType=void 0,n.ModelSetting=function ModelSetting(e){const n=s.ContainerUtil.get(v.ChatModeController),a=e.modelId,r=(0,c.useIntl)(),t=e=>r.formatMessage({id:e}),[o,l]=(0,d.useState)({[h.deepseek]:{type:"deepseek",deepseek:{model:"deepseek-reasoner",apiKey:"",baseUri:g},"deepseek-3rd":{model:"",apiKey:"",baseUri:""}},[h.ollama]:{model:"",baseUri:y}}),[i,b]=(0,d.useState)(),_=o.deepseek[o.deepseek.type],C=d.default.useMemo((()=>{if(!a)return!1;if("deepseek"===a){const e=o.deepseek.type;return Object.values(o[a][e]).some((e=>!e))}return Object.values(o[a]).some((e=>!e))}),[a,o]);(0,d.useEffect)((()=>{n.getChatModelSettings().then((e=>{e&&l(e)}))}),[e.modelId]);const handleClose=()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),i&&l(p.JsonUtils.safeParse(i))},updateDeepSeekConfig=(e,n)=>{l((a=>({...a,deepseek:{...a.deepseek,[a.deepseek.type]:{...a.deepseek[a.deepseek.type],[e]:n}}})))},updateOllamaConfig=(e,n)=>{l((a=>({...a,ollama:{...a.ollama,[e]:n}})))};return d.default.createElement("div",{className:"model-setting"},d.default.createElement("div",{className:"tab-title",onClick:handleClose},d.default.createElement(m.BackIcon,null),d.default.createElement("span",null," ",t("Model Settings")," ")),"deepseek"===a&&d.default.createElement(d.default.Fragment,null,d.default.createElement("div",null,d.default.createElement("div",{className:"label-item"},"API Provider"),d.default.createElement(f.Select,{defaultValue:o.deepseek.type,value:o.deepseek.type,options:[{label:"DeepSeek",value:"deepseek"},{label:"DeepSeek - Compatible",value:"deepseek-3rd"}],onValueChange:e=>{l((n=>({...n,deepseek:{...n.deepseek,type:e}})))}})),"deepseek-3rd"===o.deepseek.type&&d.default.createElement("div",null,d.default.createElement("div",{className:"label-item"},"Base URL"),d.default.createElement(f.TextField,{key:"deepseek-3rd-base-uri",className:"w-100",defaultValue:_.baseUri,value:_.baseUri,onChange:e=>updateDeepSeekConfig("baseUri",e.target.value),placeholder:t("Please enter request URL")})),d.default.createElement("div",null,d.default.createElement("div",{className:"label-item"},"API Key"),d.default.createElement(f.TextField,{className:"w-100",type:"password",defaultValue:_.apiKey,value:_.apiKey,onChange:e=>updateDeepSeekConfig("apiKey",e.target.value),placeholder:t("Please enter API Key")}),d.default.createElement("div",{className:"label-item c-gary"},d.default.createElement("span",null," ",t("This key is stored locally and is only used for API requests from this extension.")," "),"deepseek"===o.deepseek.type&&d.default.createElement("span",null,t("You can"),d.default.createElement("a",{href:"https://platform.deepseek.com/api_keys"},t("click here")),t("to get API Key.")))),"deepseek"===o.deepseek.type&&d.default.createElement("div",null,d.default.createElement("div",{className:"label-item"},"Model"),d.default.createElement(f.Select,{defaultValue:_.model,value:_.model,options:[{label:"DeepSeek-R1",value:"deepseek-reasoner"},{label:"DeepSeek-V3",value:"deepseek-chat"}],onValueChange:e=>updateDeepSeekConfig("model",e)}),d.default.createElement("div",{className:"description c-gary"},"deepseek-reasoner"===_.model&&d.default.createElement("span",null,t("Designed for math, code generation and complex logical reasoning tasks, enhancing reasoning capabilities through large-scale reinforcement learning (RL).")),"deepseek-chat"===_.model&&d.default.createElement("span",null,t("DeepSeek-v3 is a 671B parameter MoE model, suitable for general tasks such as natural language processing and knowledge Q&A, aiming to balance high performance and low cost.")))),"deepseek-3rd"===o.deepseek.type&&d.default.createElement("div",null,d.default.createElement("div",{className:"label-item"},"Model ID"),d.default.createElement(f.TextField,{defaultValue:_.model,value:_.model,onChange:e=>updateDeepSeekConfig("model",e.target.value),className:"w-100",placeholder:t("Please enter model ID")}))),"ollama"===a&&d.default.createElement(d.default.Fragment,null,d.default.createElement("div",null,d.default.createElement("div",{className:"label-item"},"API Provider"),d.default.createElement(f.Select,{defaultValue:"Ollama",options:[{label:"Ollama",value:"Ollama"}]})),d.default.createElement("div",null,d.default.createElement("div",{className:"label-item"},"Base URL"),d.default.createElement(f.TextField,{defaultValue:o.ollama.baseUri,value:o.ollama.baseUri,onChange:e=>updateOllamaConfig("baseUri",e.target.value),className:"w-100",placeholder:t("Please enter request URL")})),d.default.createElement("div",null,d.default.createElement("div",{className:"label-item"},"Model ID"),d.default.createElement(f.TextField,{defaultValue:o.ollama.model,value:o.ollama.model,onChange:e=>updateOllamaConfig("model",e.target.value),className:"w-100",placeholder:t("Please enter model ID")}),d.default.createElement("div",{className:"label-item c-gary"},t("Ollama allows you to run models locally on your computer. For instructions on how to get started, see the"),d.default.createElement("a",{href:"https://doc.weixin.qq.com/doc/w3_AXwAxgbpACQL3jOAXB9QNehLs0tVV?scode=AJEAIQdfAAo7W4bVWOAXwAxgbpACQ"},t("Quick Start Guide"))),d.default.createElement("div",{className:"label-item c-red"},t("Note: Models with poor coding capabilities may not work as expected")))),d.default.createElement("div",{className:"mode-save"},d.default.createElement(u.Button,{disabled:C,onClick:async()=>{const r=p.JsonUtils.safeStringify(o);if(b(r),await n.updateChatModelSettings(o),e.changeCurrentModel){const e=await n.getChatModelMap(),r=await n.getChatMode();r&&("ollama"===a?e[r]=o.ollama.model:"deepseek"===a&&(e[r]=_.model),n.updateChatModelMap(e))}handleClose()}},t("Save"))))},a(48098);const s=a(15985),c=a(19606),u=a(60139),d=i(a(48431)),f=a(64900),m=a(48924),p=a(20421),v=a(50473);var h;!function(e){e.deepseek="deepseek",e.ollama="ollama"}(h||(n.ConfigrableModelType=h={}));const g="https://api.deepseek.com/chat/completions",y="http://localhost:11434/api/chat"},35681:(e,n,a)=>{"use strict";a.r(n)},36425:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Dialog=void 0,a(38859);const s=a(19606),c=i(a(48431)),u=a(71098),d=a(85300),f=a(70719);n.Dialog=({visible:e,title:n,actions:a,onClose:r,storageKey:o,children:l})=>{if(!e)return;const i=(0,c.useRef)(null),m=(0,c.useCallback)((e=>{var n;e.stopPropagation(),(null===(n=i.current)||void 0===n?void 0:n.contains(e.target))||r()}),[i]);return(0,u.createPortal)(c.default.createElement("div",{className:"dialog-overlay",onClick:m},c.default.createElement("div",{ref:i,className:"dialog-container"},c.default.createElement("div",{className:"dialog-heading__close",onClick:r},c.default.createElement(f.IconCloseSmall,null)),c.default.createElement("div",{className:"dialog-header"},n),c.default.createElement("div",{className:"dialog-content"},l),c.default.createElement("div",{className:"dialog-footer"},c.default.createElement("div",{className:"dialog-actions-left"},a),o&&c.default.createElement(d.Checkbox,{onChange:e=>{o&&(e?localStorage.setItem(o,"1"):localStorage.removeItem(o))},label:c.default.createElement(s.FormattedMessage,{id:"Don't show again"})})))),document.body)}},36733:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(17685),n),o(a(1752),n)},36874:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(45091),n)},37232:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),a(75576),o(a(40267),n)},37406:(e,n,a)=>{"use strict";a.r(n)},37583:(e,n,a)=>{"use strict";a.r(n)},38221:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconClose=void 0;const o=r(a(48431));n.IconClose=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M12.5 3.5L3.5 12.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M12.5 12.5L3.5 3.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},38506:(e,n,a)=>{"use strict";a.r(n)},38635:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MarkdownInlineCode=void 0;const c=s(a(73059)),u=i(a(48431)),d=a(99095),f=a(20421),m=a(48802);n.MarkdownInlineCode=(0,u.memo)((e=>{const{requestId:n,children:a}=e,{resolveCode:r,hasResolvedCode:o}=(0,d.useHighlightCodeContext)(),[l,i]=(0,u.useState)((()=>o(n,a))),s=(0,u.useMemo)((()=>!!l&&["symbol","directory","file"].includes(l)),[l]);(0,u.useEffect)((()=>{n&&!l&&(0,m.shouldResolveCode)(a)&&r(n,a).then((e=>i(e)))}),[]);const p=(0,u.useCallback)((()=>{n&&s&&l&&(0,f.getCodeBlockViewService)().openCodeLink(n,a,l)}),[s]);return u.default.createElement(u.default.Fragment,null," ",u.default.createElement("code",{className:(0,c.default)({symbol:s}),onClick:p},a)," ")}))},38859:(e,n,a)=>{"use strict";a.r(n)},39232:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(73491),n),o(a(50079),n),o(a(15641),n),o(a(69185),n),o(a(75053),n),o(a(81426),n),o(a(81521),n),o(a(95816),n),o(a(56176),n),o(a(41016),n),o(a(69045),n)},39466:(e,n,a)=>{"use strict";a.r(n)},39941:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ArrowIcon=void 0;const o=r(a(48431));n.ArrowIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",className:e,style:n,...a},o.default.createElement("g",null,o.default.createElement("path",{d:"M9.52058 4.23926L6.00003 7.7598L2.47949 4.23926",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"})))},40109:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getMcpViewService=n.getConfigViewService=n.getChatViewService=n.newChatViewService=n.getDataReportViewService=n.getFileSearchViewService=n.getConversationViewService=n.getCodeBlockViewService=n.createLogger=void 0;const r=a(15985),o=a(76243),l=a(69022);n.createLogger=e=>{const n=r.ContainerUtil.get(r.Logger);return n.setContext(e),n};n.getCodeBlockViewService=()=>r.ContainerUtil.get(o.CodeBlockViewService);n.getConversationViewService=()=>r.ContainerUtil.get(o.ConversationViewService);n.getFileSearchViewService=()=>r.ContainerUtil.get(o.FileSearchViewService);n.getDataReportViewService=()=>r.ContainerUtil.get(o.DataReportViewService);n.newChatViewService=()=>r.ContainerUtil.get(l.NewChatViewServie);n.getChatViewService=()=>r.ContainerUtil.get(l.ChatViewService);n.getConfigViewService=()=>r.ContainerUtil.get(o.ConfigViewService);n.getMcpViewService=()=>r.ContainerUtil.get(l.McpViewService)},40267:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MarkdownRenderer=void 0;const c=s(a(73059)),u=s(a(91419)),d=a(75086),f=i(a(48431)),m=s(a(33864)),p=s(a(35617)),v=s(a(57624)),h=s(a(26661)),g=s(a(27217)),y=a(4882),b=a(38635),_=a(35291),C=a(26314),E=a(48802);n.MarkdownRenderer=e=>{const{children:n}=e,{message:a}=(0,f.useContext)(y.CurrentMessageContext),{requestId:r,complete:o}=null!=a?a:{},l=(0,f.useMemo)((()=>[v.default,g.default,C.rehypeCode,[p.default,{languages:{...d.common,vue:u.default}}]]),[]),i=(0,f.useCallback)((e=>{const{node:n}=e,a=n.data.complete||!!o;return a&&ifRenderInlineCode(n)?f.default.createElement(b.MarkdownInlineCode,{requestId:r},n.data.content):f.default.createElement(_.MarkdownPre,{complete:a,...e})}),[r,o]),s=(0,f.useCallback)((e=>{const{node:n,children:a}=e;return r&&n.data.inline?f.default.createElement(b.MarkdownInlineCode,{requestId:r},a):f.default.createElement("code",{className:(0,c.default)(n.properties.className)},a)}),[r]);return f.default.createElement("div",{className:"markdown"},f.default.createElement(m.default,{remarkPlugins:[h.default],rehypePlugins:l,disallowedElements:["hr"],components:{pre:i,code:s}},n))};const ifRenderInlineCode=e=>{const n=e.data.content;return!n.includes("\n")&&(0,E.likePath)(n)}},40455:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.FallbackIcon=void 0;const o=r(a(48431));n.FallbackIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:e,style:n,...a},o.default.createElement("g",{id:"å¾æ _16px",clipPath:"url(#clip0_25706_22865)"},o.default.createElement("path",{id:"Vector 3961",d:"M1.61137 2.87057V4.91654C1.61137 5.19268 1.83522 5.41654 2.11137 5.41654H4.15734",stroke:"#808080",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{id:"Ellipse 3245",d:"M2.52062 4.49982C3.37314 3.19558 4.69055 2.18842 6.31405 1.75341C9.81493 0.81535 13.4134 2.89292 14.3514 6.39379C15.2895 9.89467 13.2119 13.4931 9.71105 14.4312C7.24516 15.0919 4.73085 14.2565 3.13192 12.4814",stroke:"#808080",strokeWidth:"1.3",strokeLinecap:"round"})),o.default.createElement("defs",null,o.default.createElement("clipPath",{id:"clip0_25706_22865"},o.default.createElement("rect",{width:"16",height:"16",fill:"white"}))))},40474:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconRenderError=void 0;const o=r(a(48431));n.IconRenderError=e=>o.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M14.6417 3.09473H2.94431C1.84017 3.09473 0.944913 3.98949 0.944311 5.09364L0.936882 18.7232C0.936279 19.8282 1.83189 20.7243 2.93688 20.7243H7.68664C7.81769 20.7243 7.91333 20.6004 7.88011 20.4736L6.49304 15.1803C6.46643 15.0787 6.52288 14.9739 6.62231 14.9402L10.4888 13.6297C10.5881 13.596 10.6446 13.4914 10.6182 13.3899L9.74811 10.0451C9.72439 9.95391 9.76752 9.85855 9.85165 9.81614L13.9184 7.76633C14.0196 7.71533 14.0582 7.59052 14.0035 7.49126L13.2756 6.16945C13.2414 6.10724 13.2427 6.03153 13.279 5.97054L14.8135 3.39715C14.893 3.26384 14.7969 3.09473 14.6417 3.09473Z",stroke:"currentColor",strokeWidth:"1.3"}),o.default.createElement("path",{d:"M11.735 20.7241H21.0557C22.1598 20.7241 23.0551 19.8294 23.0557 18.7252L23.0631 5.09586C23.0637 3.99087 22.1681 3.09477 21.0631 3.09477H18.614C18.5396 3.09477 18.4713 3.13609 18.4368 3.20203L16.9876 5.97087C16.961 6.02165 16.9575 6.0814 16.978 6.13495L18.0915 9.0513C18.1276 9.14582 18.0874 9.2524 17.9979 9.29957L13.7367 11.5453C13.6584 11.5866 13.6165 11.6744 13.6338 11.7612L14.4006 15.6239C14.4202 15.7224 14.3637 15.8201 14.2686 15.8523L10.712 17.0567C10.6105 17.0911 10.5541 17.1994 10.5842 17.3023L11.5431 20.5803C11.568 20.6655 11.6462 20.7241 11.735 20.7241Z",stroke:"currentColor",strokeWidth:"1.3"}),o.default.createElement("circle",{cx:"5.71057",cy:"7.88977",r:"1.66028",stroke:"currentColor",strokeWidth:"1.3"}))},40620:(e,n,a)=>{"use strict";a.r(n)},40908:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createErrorMessages=void 0;n.createErrorMessages=e=>({DEFAULT:{level:"error",title:e("The current service request is abnormal, we are working hard to fix it."),tools:["retry"]},10001:{level:"error",title:e("The service is temporarily unavailable, please try again"),tools:["retry"]},10002:{level:"error",title:e("Stream tool call error, please try again"),tools:["retry"]},10003:{level:"error",title:e("Operation aborted, please try again"),tools:["retry"]},10004:{level:"warn",title:e("Finish reason error, please try again"),tools:["retry"],hide:!0},10005:{level:"error",title:e("Chunk parsing error, please try again"),tools:["retry"]},10006:{level:"error",title:e("AI API call error, please try again"),tools:["retry"]},10007:{level:"error",title:e("Invalid argument error, please check your input"),tools:["retry"]},10008:{level:"error",title:e("Invalid data content error, please try again"),tools:["retry"]},10009:{level:"error",title:e("Invalid message role error, please try again"),tools:["retry"]},10010:{level:"error",title:e("Stream parsing error, please try again"),tools:["retry"]},10011:{level:"error",title:e("Tool execution error, please try again"),tools:["retry"]},10012:{level:"error",title:e("Tool not found error, please try again"),tools:["retry"]},10013:{level:"error",title:e("Invalid prompt error, please try again"),tools:["retry"]},10014:{level:"error",title:e("Invalid response data error, please try again"),tools:["retry"]},10015:{level:"error",title:e("Invalid tool arguments error, please try again"),tools:["retry"]},10016:{level:"error",title:e("JSON parse error, please try again"),tools:["retry"]},10017:{level:"error",title:e("Load API key error, please check your API key"),tools:["retry"]},10018:{level:"error",title:e("Message conversion error, please try again"),tools:["retry"]},10019:{level:"error",title:e("Tool call repair error, please try again"),tools:["retry"]},10020:{level:"error",title:e("Type validation error, please try again"),tools:["retry"]},10021:{level:"error",title:e("Unsupported functionality error, please try again"),tools:["retry"]},11122:{level:"warn",title:"",tools:["retry"],hide:!0},3001:{level:"error",title:e("Invalid API key error, please check your API key"),tools:["retry"]},3002:{level:"error",title:e("Network connection error. Please check your network and try again."),subTitle:e("This might be due to unstable network or server connection issues."),tools:["retry"]},3003:{level:"error",title:e("Request timed out. Please try again."),subTitle:e("This might be due to slow network connection or high server load."),tools:["retry"]},3004:{level:"error",title:e("Your session may have expired. Please try signing in again."),tools:["retry"]},3005:{level:"error",title:e("We encountered an unexpected issue processing your request."),subTitle:e("Please try again later or contact support if the problem persists."),tools:["retry"]},3006:{level:"error",title:e("We detected that streaming functionality is affected."),subTitle:e("Please check if you have other AI assistant plugins installed. If so, please disable them as they may affect CodeBuddy usage."),tools:["retry"]},3007:{level:"error",title:e("Server error occurred. Please try again later."),subTitle:e("This is a temporary server issue. If the problem persists, please contact support."),tools:["retry"]},4001:{level:"error",title:e("The assistant encountered an issue, you can try asking a different question."),tools:["retry"]},5001:{level:"error",title:e("Model resource connection failed due to high demand, you can try a new question or start a new conversation later."),tools:["retry"]},5002:{level:"error",title:e("The context has exceeded the limit, you can start a new conversation."),tools:["retry"]},5003:{level:"error",title:e("The assistant encountered a problem, please try again later."),tools:["retry"]},5004:{level:"error",title:e("Encountered a connection failure, you can start a new conversation or try again later."),tools:["retry"]},MAX_TOKEN_LIMIT_DAY:{level:"warn",title:e("Exceeded the daily maximum total character limit for Craft."),subTitle:e("You can choose to switch to Ask mode, which supports engineering understanding and technical Q&A."),tools:["toChat","retry-text"],hideRequestId:!0},MAX_TOKEN_LIMIT_MONTH:{level:"warn",title:e("Exceeded the monthly maximum conversation count limit for Craft."),subTitle:e("You have reached the monthly maximum of 100 times, you can choose to switch to Ask mode, which supports engineering understanding and technical Q&A."),tools:["toChat","retry-text"],hideRequestId:!0},MAX_RESOURCE_LIMIT:{level:"warn",title:e("Computing resources are tight, we are expanding urgently, please retry later."),subTitle:e("During the waiting period, you can choose to switch to Ask mode, providing engineering understanding and technical Q&A services."),tools:["toChat","retry-text"],hideRequestId:!0},6e3:{level:"warn",title:e("Computing resources are tight, we are expanding urgently, please retry later."),subTitle:e("During the waiting period, you can choose to switch to Ask mode, providing engineering understanding and technical Q&A services."),tools:["toChat","retry-text"],hideRequestId:!0},6001:{level:"warn",title:"",tools:["retry"],hide:!0},6002:{level:"warn",title:"",tools:["retry"],hide:!0},6003:{level:"warn",title:"",tools:["retry"],hide:!0},6004:{level:"warn",title:"",tools:["retry"],hide:!0},6005:{level:"warn",title:"",tools:["retry"],hide:!0},6006:{level:"warn",title:"",tools:["retry"],hide:!0},6007:{level:"warn",title:"",tools:["retry"],hide:!0},6008:{level:"warn",title:"",tools:["retry"],hide:!0}})},41016:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.McpToolRenderer=void 0,a(37406);const c=a(15985),u=a(69022),d=s(a(48431)),f=a(73671),m=a(87783),p=a(39941),v=a(42810),h=a(63565);let g=class McpToolRenderer{constructor(){this.className="craft-assistant-mcp-message",this.clickHeader=!0}canHandle(e){return e.name===u.ToolNames.MCP_SERVER?v.ChatToolRendererPriority.EXACT:v.ChatToolRendererPriority.NONE}render(e){return d.default.createElement(y,{tool:e})}};n.McpToolRenderer=g,n.McpToolRenderer=g=i([(0,c.Component)(v.ChatToolRenderer)],g);const y=(0,d.memo)((({tool:e})=>{var n,a;const[r,o]=(0,d.useState)(!1),{status:l}=e,i={DEFAULT:{[u.ToolStatus.EXECUTED]:"Run successfully",[u.ToolStatus.FAILED]:"Run failed"}},s=(0,d.useCallback)((()=>{o(!r)}),[r]),c=(null===(n=e.result)||void 0===n?void 0:n.result)||{},{serverName:v="",toolName:g="",data:y={}}=c,b=e.result,_=null===(a=e.result)||void 0===a?void 0:a.success;let C="",E=[];try{E=JSON.parse(e.args.matchServer)||{},C=JSON.stringify(E,void 0,2)}catch(e){E=[],C=""}const w="object"==typeof y?JSON.stringify(y,void 0,2):String(y||""),O=E.length;return d.default.createElement("div",{className:"craft-assistant-mcp-message"},d.default.createElement("div",{className:"craft-assistant-mcp-message__header",onClick:s},d.default.createElement("div",{className:"header-left"},d.default.createElement(p.ArrowIcon,{className:r?"":"arrow-left"})),d.default.createElement("div",{className:"header-center"},d.default.createElement("span",null,v||"Called MCP"," ",g?`(${g})`:"")),d.default.createElement("div",{className:"header-right"},b?d.default.createElement(m.StatusText,{statusTextMap:i,toolStatus:_?u.ToolStatus.EXECUTED:u.ToolStatus.FAILED}):h.ToolUtils.isToolCallRunning(l)&&d.default.createElement(f.LoadingDots,null))),b&&r&&d.default.createElement("div",{className:"craft-assistant-mcp-message__content"},O>0&&d.default.createElement("div",{className:"block first-child-block"},d.default.createElement("span",{className:"title"},"Parameters:"),d.default.createElement("div",{className:"contents"},d.default.createElement("pre",null,C))),w&&d.default.createElement("div",{className:"block"},d.default.createElement("div",{className:"block_header"},d.default.createElement("span",{className:"title"},"Result:")),d.default.createElement("div",{className:"contents scroll_content"},d.default.createElement("pre",null,w)))))}));y.displayName="McpToolContent"},41264:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(27083),n)},42225:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.WithLink=function WithLink({children:e,...n}){const{text:a,sourceString:r,linkUrl:o,linkClassName:l}=n,i=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=new RegExp(`(${i})`,"g"),d=a.split(s);return u.createElement(u.Fragment,null,d.map(((e,n)=>e===r?u.createElement("a",{key:n,href:o,className:(0,c.default)("codebuddy-withlink",l),target:"_blank",rel:"noopener noreferrer"},e):e)))},a(78819);const c=s(a(73059)),u=i(a(48431))},42810:(e,n)=>{"use strict";var a;Object.defineProperty(n,"__esModule",{value:!0}),n.ChatToolRendererPriority=n.ChatToolRenderer=void 0,n.ChatToolRenderer=Symbol("ChatToolRenderer"),function(e){e[e.NONE=0]="NONE",e[e.DEFAULT=1]="DEFAULT",e[e.EXACT=10]="EXACT"}(a||(n.ChatToolRendererPriority=a={}))},43053:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorIcon=void 0;const o=r(a(48431));n.ErrorIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("g",{id:"å¾æ _12px",clipPath:"url(#clip0_28917_7388)"},o.default.createElement("rect",{id:"Rectangle 346241910",x:"1.125",y:"1.125",width:"9.75",height:"9.75",rx:"4.875",stroke:"#C74E39",strokeWidth:"0.975"}),o.default.createElement("path",{id:"Vector 3771",d:"M7.41357 4.58643L4.58643 7.41357",stroke:"#C74E39",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{id:"Vector 3772",d:"M7.41357 7.41357L4.58643 4.58643",stroke:"#C74E39",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"})),o.default.createElement("defs",null,o.default.createElement("clipPath",{id:"clip0_28917_7388"},o.default.createElement("rect",{width:"12",height:"12",fill:"white"}))))},43502:(e,n,a)=>{"use strict";a.r(n)},44181:(e,n,a)=>{"use strict";a.r(n)},45091:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.ChatPopover=function ChatPopover(e){const{children:n,trigger:a,open:r=!1,onOpenChange:o=e=>{},onTrigger:l}=e,[i,d]=(0,u.useState)(r);return(0,u.useEffect)((()=>d(r)),[r]),c.createElement(s.Popover.Root,{open:i,onOpenChange:e=>o(e)},c.createElement(s.Popover.Trigger,{onClick:()=>l?l():d(!0)},a),c.createElement(s.Popover.Content,null,n))};const s=a(60139),c=i(a(48431)),u=a(48431)},45176:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.WelcomeIcon=function WelcomeIcon({isAsk:e}){const n="welcome-content_icon "+(e?"ask-icon":"craft-icon");return o.default.createElement("div",{className:n})};const o=r(a(48431))},45639:(e,n,a)=>{"use strict";a.r(n)},45840:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.fuzzySearch=function fuzzySearch(e,n,a={}){const{fileNameWeight:r=3,highlightClass:o="highlight"}=a,l=e.toLowerCase().trim(),i=l.includes(" ");return n.map((e=>{const{score:n,valueMatches:a,labelMatches:s}=i?function matchWithSpaces(e,n,a){const r=e.split(" ").filter(Boolean);let o=0;const l=[],i=[];let s=0,c=0;for(const e of r){const r=matchSequence(e,n.value.slice(s),"strict",!0,!1);if(r.matches.length>0&&r.score>0)l.push(...r.matches.map((e=>e+s))),s=Math.max(s,...r.matches)+1,o+=r.score*a;else{const a=matchSequence(e,n.label.slice(c),"loose",!1,!1);a.matches.length>0&&a.score>0&&(i.push(...a.matches.map((e=>e+c))),c=Math.max(c,...a.matches)+1,o+=a.score)}}return{score:o,valueMatches:l,labelMatches:i}}(l,e,r):function matchWithoutSpaces(e,n,a){const r=/^(.)\1+$/.test(e);let o=0,l=[],i=[];for(const s of["strict","loose"]){const c=matchSequence(e,n.value,s,!0,r);let u=c.score*a,d=c.matches,f=[];if(c.matchedQueryLength<e.length){const a=matchSequence(e.substring(c.matchedQueryLength),n.label,s,!1,!1);u+=a.score,f=a.matches}if(u>o&&(o=u,l=d,i=f),"loose"===s){const c=matchSequence(e,n.label,s,!1,!1);if(u=c.score,d=[],f=c.matches,c.matchedQueryLength<e.length){const o=matchSequence(e.substring(c.matchedQueryLength),n.value,s,!0,r);u+=o.score*a,d=o.matches}u>o&&(o=u,l=d,i=f)}}return{score:o,valueMatches:l,labelMatches:i}}(l,e,r),c=genHighlightText(e.value,a,o),u=genHighlightText(e.label,s,o);return{...e,score:n,highlightText:c,highlightDescText:u}})).filter((e=>{if(itemIsContext(e)){return[...e.highlightText,...e.highlightDescText].reduce(((e,n)=>("string"!=typeof n&&(e+=1),e)),0)>=(i?l.replace(/\s+/,"").length:l.length)}return e&&e.score>0&&e.score>=.5*l.length})).sort(((e,n)=>itemIsContext(e)&&!itemIsContext(n)?-1:!itemIsContext(e)&&itemIsContext(n)?1:n.score-e.score))};const o=r(a(48431)),l=a(50473);function itemIsContext(e){return![l.IMentionType.file,l.IMentionType.folder].includes(e.type)||"id"in e}function matchSequence(e,n,a,r,o){const l=n.toLowerCase(),i=[];let s=0,c=-1,u=0;if(o){const n=e[0];for(let a=0;a<l.length&&u<e.length;a++)l[a]===n&&(i.push(a),u++);s=i.length}else for(let n=0;n<l.length&&u<e.length;n++)if(l[n]===e[u]){if(i.push(n),s+=1,-1!==c&&n===c+1&&(s+=.5),c=n,u++,"strict"===a&&u===e.length)break}else if("loose"===a)continue;return r&&"strict"===a&&u!==e.length?{score:0,matches:[],matchedQueryLength:0}:{score:s,matches:i,matchedQueryLength:u}}function genHighlightText(e,n,a){const r=[...e];return[...new Set(n)].sort(((e,n)=>e-n)).forEach((e=>{e<r.length&&(r[e]=o.default.createElement("span",{className:`${a}`},r[e]))})),r}},45974:(e,n,a)=>{"use strict";a.r(n)},46141:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),a(34231),o(a(98729),n),o(a(57165),n),o(a(23103),n)},46163:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconZoomOut=void 0;const o=r(a(48431));n.IconZoomOut=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M8.99967 0.849609C12.3962 0.849609 15.1501 3.60345 15.1501 6.99998C15.1501 10.3965 12.3962 13.1504 8.99967 13.1504C7.53551 13.1503 6.19157 12.6376 5.1354 11.7832L1.9596 14.9599L1.85706 15.0429C1.60479 15.2093 1.26169 15.1819 1.03967 14.9599C0.817728 14.7379 0.790305 14.3948 0.956663 14.1425L1.03967 14.04L4.21547 10.8633C3.36166 9.80723 2.84925 8.46362 2.84925 6.99998C2.84925 3.60352 5.60321 0.849713 8.99967 0.849609ZM8.99967 2.15039C6.32118 2.15049 4.15004 4.32149 4.15004 6.99998C4.15004 9.67848 6.32118 11.8495 8.99967 11.8496C11.6783 11.8496 13.8493 9.67854 13.8493 6.99998C13.8493 4.32142 11.6783 2.15039 8.99967 2.15039ZM11.2292 6.44334C11.5879 6.44364 11.8795 6.73498 11.8796 7.09373C11.8795 7.4525 11.5879 7.74382 11.2292 7.74412H6.85318C6.49438 7.74393 6.20282 7.45257 6.20278 7.09373C6.20284 6.73492 6.49439 6.44353 6.85318 6.44334H11.2292Z",fill:"currentColor"}))},46506:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.CodeIcon=void 0;const o=r(a(48431));n.CodeIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:e,style:n,...a},o.default.createElement("path",{d:"M3.94272 6.0437L1.5625 8.42392L3.94272 10.8041",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M12.0563 10.8042L14.4365 8.42398L12.0563 6.04375",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M8.92396 6.13409L7.07465 10.8041",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},46700:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useDialogVisible=void 0,n.useConfirmDialog=function useConfirmDialog(e,a){const o=(0,n.useDialogVisible)(),[l,i]=(0,r.useState)(),s=(0,r.useRef)(e);(0,r.useEffect)((()=>{s.current=e}),[e]);const handleCloseDialog=()=>{o.close(),i(void 0)},c=(0,r.useCallback)((e=>{a&&localStorage.getItem(a)?s.current(l):(i(e),o.open())}),[o.visible,s]),u=(0,r.useCallback)((()=>{s.current(l),handleCloseDialog()}),[l,s]);return{visible:o.visible,onCloseDialog:handleCloseDialog,onConfirmDialog:u,onOpenDialog:c}};const r=a(48431);n.useDialogVisible=()=>{const[e,n]=(0,r.useState)(!1);return{visible:e,open:()=>n(!0),close:()=>n(!1)}}},46921:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useGetConversations=void 0;const r=a(48431),o=a(25380),l=a(20421);n.useGetConversations=()=>{const[e,n]=(0,r.useState)([]),[a,i]=(0,r.useState)(),s=(0,o.useLogger)(l.LOG_CHAT_HISTORY),c=(0,r.useCallback)((async()=>{const e=(0,l.getConversationViewService)(),[a,r]=await Promise.all([e.getConversations(),e.getCurrentConversation()]);n(a),i(r),s.info(`load conversation ${a.length} items`)}),[]);return(0,r.useEffect)((()=>{c()}),[]),{data:e,current:a,loadData:c}}},46988:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.CodebaseReferences=void 0,a(65492);const s=a(15985),c=a(69022),u=a(19606),d=i(a(48431)),f=a(40996),m=a(6044),p=a(82966);n.CodebaseReferences=d.default.memo((e=>{const{reference:n,workspacePath:a}=e,[r,o]=(0,d.useState)([]);return(0,d.useEffect)((()=>{if(!n.length)return;const e=n.map((e=>({...e,filename:f.Utils.basename(f.URI.parse(e.fileName)),filepath:f.Utils.joinPath(f.URI.parse(a),e.source).path})));o(e)}),[n]),d.default.createElement("div",{className:"codebase-reference"},!!r.length&&d.default.createElement(d.default.Fragment,null,d.default.createElement(u.FormattedMessage,{id:"Codebase search"})," (",r.length,")",d.default.createElement("div",{className:"reference-wrapper"},r.map(((e,n)=>d.default.createElement("div",{key:`codebase-reference-${n}`,className:["reference-detail",e.filepath?"pointer":""].join(" ")},d.default.createElement(m.Tooltip,{content:e.filename},d.default.createElement("div",{className:"path-item",onClick:()=>(e=>{var n,a;s.ContainerUtil.get(c.ChatViewService).openFileWithRange(e.filepath,[{line:(null!==(n=e.startPos)&&void 0!==n?n:1)-1,character:0},{line:(null!==(a=e.endPos)&&void 0!==a?a:1)-1,character:0}])})(e)},d.default.createElement("span",null,n+1,"."),d.default.createElement("div",{className:"file-name text-hover"},e.filename,":"),d.default.createElement("div",{className:"file-line text-hover"},e.startPos,"-",e.endPos),d.default.createElement("div",{className:"file-source"},d.default.createElement("div",{className:"file-source-text text-hover"},e.source),d.default.createElement(p.ShareIcon,null))))))))))}))},47895:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.OperateCard=function OperateCard(e){const{title:n,content:a,buttons:r}=e.options;return o.default.createElement("div",{className:"craft-operate-card"},o.default.createElement("div",{className:"craft-operate-card-title"},n||""),o.default.createElement("div",{className:"craft-operate-card-content"},a||""),o.default.createElement("div",{className:"craft-operate-card-tools"},r.map((({appearance:e,text:n,handle:a},r)=>"ghost"===e?o.default.createElement("div",{className:"craft-operate-card-tool-ghost",onClick:a,key:r},n):o.default.createElement(l.default,{onClick:a,key:r,btnText:n})))))},a(97105);const o=r(a(48431)),l=r(a(6949))},48098:(e,n,a)=>{"use strict";a.r(n)},48135:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThumbsDownIcon=void 0;const o=r(a(48431));n.ThumbsDownIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("g",{id:"å¾æ _16px"},o.default.createElement("path",{d:"M11 1.625L4.29201 1.625C3.82796 1.625 3.42488 1.94425 3.3186 2.39596L1.78919 8.89596C1.64149 9.52367 2.11775 10.125 2.7626 10.125L6.5 10.125L6.5 13.375C6.5 13.9273 6.94772 14.375 7.5 14.375L8.28906 14.375C8.71472 14.375 9.09372 14.1056 9.23356 13.7035L11 8.625M11 1.625H13.5C14.0523 1.625 14.5 2.07272 14.5 2.625L14.5 7.625C14.5 8.17728 14.0523 8.625 13.5 8.625H11M11 1.625L11 8.625",stroke:"#808080",strokeWidth:"1.3"})))},48249:(e,n,a)=>{"use strict";a.r(n)},48770:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SnapshotUtils=void 0;const r=a(15985),o=a(51662),l=a(69022);n.SnapshotUtils=class SnapshotUtils{static getFileStatus(e,n){var a;return(null===(a=this.getFileEditVersion(e,n))||void 0===a?void 0:a.status)||""}static getFileEditVersion(e,n){const a=r.ContainerUtil.get(l.FileTreeViewService).fileTreeObserver.getValue().find((n=>n.filePath===e));if(!a||"folder"===a.type)return;const i=n||(null==a?void 0:a.currentVersion),s=null==a?void 0:a.versions.find((e=>e.versionId===i));return(null==s?void 0:s.status)===o.FileNodeStatus.ERROR?null==a?void 0:a.versions.find((e=>e.status===o.FileNodeStatus.IDLE)):s}}},48802:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),n.toDiff=void 0;var l=a(6457);Object.defineProperty(n,"toDiff",{enumerable:!0,get:function(){return l.toDiff}}),o(a(63239),n),o(a(26936),n)},48924:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(31771),n)},48990:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Bubble=function Bubble(e){return o.default.createElement("div",{className:"user-message-bubble",style:e.style},e.children)},a(60511);const o=r(a(48431))},49147:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.LinkIcon=void 0;const o=r(a(48431));n.LinkIcon=()=>o.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M6.75 1.5H10.5V5.25",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M10.5 7.36842V9.75C10.5 10.1642 10.1642 10.5 9.75 10.5H2.25C1.83579 10.5 1.5 10.1642 1.5 9.75V2.25C1.5 1.83579 1.83579 1.5 2.25 1.5H4.5",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M6.375 5.625L10.125 1.875",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}))},49262:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.NewChatDialog=void 0;var o=a(99648);Object.defineProperty(n,"NewChatDialog",{enumerable:!0,get:function(){return r(o).default}})},49845:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapshotFile=function SnapshotFile({file:e,workspace:n}){var a,r;const o=c.ContainerUtil.get(d.ChatViewService),l=c.ContainerUtil.get(d.FileTreeViewService),i=b.SnapshotUtils.getFileStatus(e.filePath),s=i===u.FileNodeStatus.PENDING,_=(0,p.useContext)(h.GlobalContext),{formatMessage:C}=(0,f.useIntl)(),getReportArgs=e=>({mode:null==_?void 0:_.globalState.mode,languageIdMap:{[e]:(0,g.getLanguageId)(e.split("/").pop()||"")}}),E=null===(a=e.versions)||void 0===a?void 0:a.reduce(((e,n)=>{var a,r;return("diff"in n&&null!==(r=null===(a=n.diff)||void 0===a?void 0:a.addedLines)&&void 0!==r?r:0)+e}),0),w=null===(r=e.versions)||void 0===r?void 0:r.reduce(((e,n)=>{var a,r;return("diff"in n&&null!==(r=null===(a=n.diff)||void 0===a?void 0:a.removedLines)&&void 0!==r?r:0)+e}),0);return p.default.createElement("div",{className:"snapshot-file",onClick:async()=>{o.openFile(e.filePath)}},p.default.createElement("div",{className:"file-content"},p.default.createElement(f.Icon,{name:e.name,type:f.IconType.VSCODE}),p.default.createElement("div",{className:"file-name",title:e.name},e.name),p.default.createElement("div",{className:"file-path",title:e.filePath},(()=>{if(n){let a=n;return e.filePath.startsWith("/"+n)&&(a="/"+n),y.ToolUtils.getRelativeFilePath(e.filePath,a)}return e.filePath})())),p.default.createElement("div",{className:"file-status"},p.default.createElement("div",{className:"status-text-wrapper"},s&&p.default.createElement("span",null,C({id:"Generating"}),p.default.createElement("span",{className:"loading-dots"})),e.type===u.FileType.FILE&&!(0===E&&0===w)&&p.default.createElement("div",{className:(0,m.default)("file-diff","idle"===i?"not-modify":"")},p.default.createElement("span",{className:"added-lines"},"+",E),p.default.createElement("span",{className:"removed-lines"},"-",w)),["accepted","rejected"].includes(i)?p.default.createElement("div",{className:"status-text-inner"},"accepted"===i?p.default.createElement(v.AcceptIcon,{className:"icon-active accept"}):p.default.createElement(v.RefusedIcon,{className:"icon-active refused"})):p.default.createElement("div",{className:"status "+(s?"pending":"")})),"idle"===i&&p.default.createElement("div",{className:"status-modify"},p.default.createElement("span",{className:"cursor-pointer "+(s?"disabled":""),onClick:n=>{n.stopPropagation(),(async()=>{i===u.FileNodeStatus.IDLE&&(l.acceptFiles([e.filePath]),l.reportFileOperation([e.filePath],getReportArgs(e.filePath)))})()}},p.default.createElement(v.AcceptIcon,{className:"icon-active"})),p.default.createElement("span",{className:"cursor-pointer "+(s?"disabled":""),onClick:n=>{n.stopPropagation(),(async()=>{i===u.FileNodeStatus.IDLE&&(l.rejectFiles([e.filePath]),l.reportFileOperation([e.filePath],getReportArgs(e.filePath),!1))})()}},p.default.createElement(v.RefusedIcon,{className:"icon-active"})))))},a(70231);const c=a(15985),u=a(51662),d=a(69022),f=a(19606),m=s(a(73059)),p=i(a(48431)),v=a(48924),h=a(60742),g=a(50759),y=a(63565),b=a(48770)},50079:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ExecuteCommandRenderer=void 0,a(62881);const u=a(15985),d=a(3533),f=a(69022),m=a(19606),p=s(a(48431)),v=a(50473),h=a(64900),g=a(32134),y=c(a(6949)),b=a(84332),_=a(58271),C=a(87783),E=a(39941),w=a(71732),O=a(91015),M=a(42810),S=a(63565),P=a(63368);let T=class ExecuteCommandRenderer{constructor(){this.className="execute-command",this.alwaysShowResult=!0,this.statusTextMap={DEFAULT:{[f.ToolStatus.EXECUTED]:"Run successfully",[f.ToolStatus.FAILED]:"Run failed"}}}canHandle(e){return e.name===f.ToolNames.EXECUTE_COMMAND?M.ChatToolRendererPriority.EXACT:M.ChatToolRendererPriority.NONE}renderTitle(e){var n,a;const r=null!==(a=null===(n=null==e?void 0:e.args)||void 0===n?void 0:n.command)&&void 0!==a?a:"";return p.default.createElement("span",{className:"truncate",title:r},r)}renderControl(e){var n;return p.default.createElement(p.default.Fragment,null,p.default.createElement("span",{className:"header-icon"},p.default.createElement(_.Copy,{content:(null===(n=null==e?void 0:e.args)||void 0===n?void 0:n.command)||""})),S.ToolUtils.isToolCallRunning(e.status)?void 0:p.default.createElement(C.StatusText,{statusTextMap:this.statusTextMap,toolStatus:e.status}))}renderButtons(e,n){return p.default.createElement(Buttons,{tool:e,config:n})}renderResult(e){return p.default.createElement(CommandResult,{tool:e})}renderIcon(e){var n;const a=(null===(n=null==e?void 0:e.args)||void 0===n?void 0:n.command)||"",{emoji:r,tooltip:o}=(0,P.getCommandRiskInfo)(a);return p.default.createElement(p.default.Fragment,null,o?p.default.createElement(h.Tooltip,{content:o},p.default.createElement("div",{className:"terminal-icon-container"},p.default.createElement(w.TerminalIcon,null),r&&p.default.createElement("span",{className:"risk-emoji"},r))):p.default.createElement("div",{className:"terminal-icon-container"},p.default.createElement(w.TerminalIcon,null),r&&p.default.createElement("span",{className:"risk-emoji"},r)))}};n.ExecuteCommandRenderer=T,n.ExecuteCommandRenderer=T=i([(0,u.Component)(M.ChatToolRenderer)],T);const Buttons=e=>{var n,a;const r=u.ContainerUtil.get(v.ChatModeController),o=u.ContainerUtil.get(d.ToolViewService),{tool:l,config:i}=e,{status:s}=l,{setToolStatus:c}=(0,p.useContext)(O.CurrentToolContext),_=(0,p.useContext)(g.ConversationIdContext),[C,w]=(0,p.useState)(!1),M=(0,m.useIntl)(),t=e=>M.formatMessage({id:e}),execute=()=>{o.execute(l.id,_),null==c||c(f.ToolStatus.FULL_EXECUTING),w(!1)},ignore=()=>{o.ignore(l.id,_),w(!1)},cancel=()=>{o.cancel(l.id,_),w(!1)},T=[{label:t("Proceed to Next Step"),value:"ignore",onClick:()=>{ignore()}},...(null===(n=l.args)||void 0===n?void 0:n.requires_approval)?[{label:t("Cancel"),value:"cancel",onClick:()=>{cancel()}}]:[]],j=[{label:t("Ask Each Time"),value:"true",onClick:()=>{}},{label:t("Auto Run"),value:"false",onClick:async()=>{execute();const e=await r.getChatModeSettings()||{};await r.updateChatModeSettings({...e,craft:{...e.craft||{},autoRun:!0}})}}];return(0,p.useEffect)((()=>{var e,n;const a=S.ToolUtils.isToolCallPending(s);if(!(null===(e=l.args)||void 0===e?void 0:e.command))return void w(!1);if(s===f.ToolStatus.PENDING){const e=l.args.command,n=(0,P.checkCommandSafety)(e);l.args.requires_approval=n.requiresApproval}const r=!!(null===(n=l.args)||void 0===n?void 0:n.requires_approval)||!i.autoRun;w(r&&a||S.ToolUtils.isToolCallExecuting(s)),!r&&S.ToolUtils.isToolCallExecutable(s)&&execute()}),[i.autoRun,l,s]),p.default.createElement(p.default.Fragment,null,C&&p.default.createElement("div",{className:"command-control"},s===f.ToolStatus.PENDING&&p.default.createElement("div",{className:"button-container"},p.default.createElement(y.default,{type:"primary",btnText:t("Run"),onClick:execute}),p.default.createElement("div",{className:"mini-show"},p.default.createElement(h.ChatDropdown,{items:T},p.default.createElement("div",{className:"flex flex-items-center"},p.default.createElement(b.MoreIcon,null)))),p.default.createElement("span",{className:"mini-not-show"},p.default.createElement(y.default,{btnText:t("Proceed to Next Step"),onClick:ignore})),!!(null===(a=l.args)||void 0===a?void 0:a.requires_approval)&&p.default.createElement("span",{className:"mini-not-show"},p.default.createElement(y.default,{btnText:t("Cancel"),onClick:cancel})),p.default.createElement("div",{className:"command-options"},p.default.createElement(h.ChatDropdown,{items:j},p.default.createElement("div",{className:"command-options-label"},p.default.createElement("span",null,t("Ask Each Time")),p.default.createElement(E.ArrowIcon,null))))),S.ToolUtils.isToolCallExecuting(s)&&p.default.createElement("div",{className:"button-container"},p.default.createElement(h.Tooltip,{content:t("Click this button to skip the current step and start the next stage of the task")},p.default.createElement(y.default,{btnText:t("Proceed to Next Step"),onClick:ignore})))))},j=new Map,CommandResult=e=>{var n,a;const{tool:r}=e,{status:o}=r,l=u.ContainerUtil.get(f.ChatViewService),{setToolStatus:i}=(0,p.useContext)(O.CurrentToolContext),s=j.get(r.id)||(null===(a=null===(n=r.result)||void 0===n?void 0:n.result)||void 0===a?void 0:a.stdout)||"",[c,d]=(0,p.useState)(s),[v,h]=(0,p.useState)(!!s);return(0,p.useEffect)((()=>{const e=l.terminalResultObserver.subscribe((e=>{e.toolId===r.id&&o!==f.ToolStatus.EXECUTED&&(j.set(r.id,e.result),d(e.result),null==i||i(f.ToolStatus.FULL_EXECUTING))}));return()=>e.unsubscribe()}),[r,o]),(0,p.useEffect)((()=>{var e,n,a,l,i,s;o===f.ToolStatus.EXECUTED&&(null===(n=null===(e=r.result)||void 0===e?void 0:e.result)||void 0===n?void 0:n.stdout)&&(j.set(r.id,null===(l=null===(a=r.result)||void 0===a?void 0:a.result)||void 0===l?void 0:l.stdout),d((null===(s=null===(i=r.result)||void 0===i?void 0:i.result)||void 0===s?void 0:s.stdout)||""))}),[r]),(0,p.useEffect)((()=>{h(!!c||S.ToolUtils.isToolCallExecuting(o))}),[c,o]),p.default.createElement(p.default.Fragment,null,v&&p.default.createElement("div",{className:"card-content stdout-content"},o===f.ToolStatus.EXECUTED&&""===c.trim()?p.default.createElement("span",{className:"content"},"run successfully"):p.default.createElement("span",{className:"content"},c.trim()),S.ToolUtils.isToolCallExecuting(o)&&!c&&p.default.createElement("span",{className:"exec-status-text"},p.default.createElement(m.FormattedMessage,{id:"Running, details can be viewed in the terminal"}))))}},50372:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconInsert=void 0;const o=r(a(48431));n.IconInsert=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M4.73486 6.62196L6.11235 7.99945L4.73486 9.37693",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M6 8L1 8",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("rect",{x:"6",y:"2",width:"8",height:"3",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("rect",{x:"6",y:"11",width:"8",height:"3",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},50473:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CHAT_MODE_SETTINGS=n.ChatModeController=n.ChatInputController=n.ChatVariableType=n.SHOW_SETTING_TIP_MIN_WIDTH=n.CONVERSATION_SELECT_CONTEXTS_MAP=n.CODEBASE_STATUS=n.ASK_SETTINGS=n.CRAFT_SETTINGS=n.CHAT_SELECTED_MODEL_MAP=n.CHAT_SELECTED_MODE=n.ChatSelectionInfoType=n.IMentionType=n.KnowledgeBaseType=void 0;var r,o=a(69022);Object.defineProperty(n,"KnowledgeBaseType",{enumerable:!0,get:function(){return o.KnowledgeBaseType}}),Object.defineProperty(n,"IMentionType",{enumerable:!0,get:function(){return o.IMentionType}}),Object.defineProperty(n,"ChatSelectionInfoType",{enumerable:!0,get:function(){return o.ChatSelectionInfoType}}),n.CHAT_SELECTED_MODE="chatSelectedMode",n.CHAT_SELECTED_MODEL_MAP="chatSelectedModelMap",n.CRAFT_SETTINGS="craftSettings",n.ASK_SETTINGS="askSettings",n.CODEBASE_STATUS="codebaseStatus",n.CONVERSATION_SELECT_CONTEXTS_MAP="conversationSelectionContextsMap",n.SHOW_SETTING_TIP_MIN_WIDTH=300,function(e){e.File="file",e.Diff="diff",e.Commit="commit",e.Normal="normal",e.Terminal="terminal",e.TerminalSelection="terminalSelection",e.TerminalLastCommand="terminalLastCommand",e.TerminalShellType="terminalShellType",e.Editor="editor",e.Git="git",e.Codebase="codebase"}(r||(n.ChatVariableType=r={})),n.ChatInputController=Symbol("ChatInputCroller"),n.ChatModeController=Symbol("ChatModeController"),n.CHAT_MODE_SETTINGS="chatModeSettings"},50759:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.UserMessageReference=function UserMessageReference(e){const{references:n,onClick:a}=e,r=n.map(((e,n)=>[o.ReferenceNames.File,o.ReferenceNames.Code].includes(e.name)&&e.metadata.filepath?{...e,classname:getFileIconClass(e.metadata.filepath)}:{...e}));return l.default.createElement("div",{className:"flex flex-wrap justify-end"},r.map(((e,n)=>{var r,i,s,c,u;return l.default.createElement("div",{key:n,className:["user-message-reference",e.name===o.ReferenceNames.File||e.name===o.ReferenceNames.Code?"pointer":""].join(" "),onClick:()=>null==a?void 0:a(e)},l.default.createElement("span",{className:e.classname}),l.default.createElement("span",{className:"selection-name"},e.value,(null===(r=e.metadata)||void 0===r?void 0:r.selection)?`  (${null===(s=null===(i=e.metadata)||void 0===i?void 0:i.selection)||void 0===s?void 0:s.start.line}-${null===(u=null===(c=e.metadata)||void 0===c?void 0:c.selection)||void 0===u?void 0:u.end.line})`:""))})))},n.getLanguageId=getLanguageId,a(63457);const o=a(69022),l=r(a(48431)),i=a(40996);const s={".abap":"abap",".bat":"bat",".bib":"bibtex",".blade.php":"blade",".c":"c",".clj":"clojure",".coffee":"coffeescript",".cpp":"cpp",".cs":"csharp",".css":"css",".dart":"dart",".dockerfile":"dockerfile",".ex":"elixir",".exs":"elixir",".erb":"erb",".erl":"erlang",".fs":"fsharp",".fsx":"fsharp",".go":"go",".groovy":"groovy",".haml":"haml",".handlebars":"handlebars",".hbs":"handlebars",".hs":"haskell",".html":"html",".ini":"ini",".java":"java",".js":"javascript",".jsx":"jsx",".json":"jsonc",".jl":"julia",".kt":"kotlin",".kts":"kotlin",".latex":"latex",".less":"less",".lua":"lua",".Makefile":"makefile",".markdown":"markdown",".md":"markdown",".m":"objective-c",".mm":"objective-cpp",".pl":"perl",".php":"php",".ps1":"powershell",".pug":"pug",".py":"python",".r":"r",".razor":"razor",".rb":"ruby",".rs":"rust",".sass":"sass",".scss":"scss",".sh":"shellscript",".slim":"slim",".sol":"solidity",".sql":"sql",".styl":"stylus",".svelte":"svelte",".swift":"swift",".tf":"terraform",".tex":"tex",".ts":"typescript",".tsx":"typescriptreact",".vb":"vb",".v":"verilog",".vue":"vue",".xml":"xml",".xsl":"xsl",".yaml":"yaml",".yml":"yaml"};function getLanguageId(e){try{const n=i.Utils.extname(i.URI.parse(e)).toLowerCase();return s[n]||"plaintext"}catch(e){return""}}function getFileIconClass(e){try{const n=i.URI.parse(e),a=i.Utils.extname(n);return`\n            icon-fontstyle\n            icon-default\n            icon-${getLanguageId(e).toLowerCase()} \n            icon-${(a||"").replace(".","")} \n            icon-${e}\n            icon-${(e||"").replace(".","")}\n            icon-${(e||"").replace(a||"","")}\n        `}catch(e){return"\n            icon-fontstyle\n            icon-default"}}},50836:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.CopyIcon=void 0;const o=r(a(48431));n.CopyIcon=()=>o.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M3.375 8.625C3.375 9.03921 3.71079 9.375 4.125 9.375H9C9.41421 9.375 9.75 9.03921 9.75 8.625V5.24475C9.75 4.83053 9.41421 4.49474 9 4.49474H7.4493C7.03509 4.49474 6.6993 4.15896 6.6993 3.74474V2.25C6.6993 1.83579 6.36352 1.5 5.9493 1.5H4.125C3.71079 1.5 3.375 1.83579 3.375 2.25V8.625Z",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M6.39648 1.64746L9.49173 4.67209",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M1.875 4.875V8.625C1.875 9.86764 2.88236 10.875 4.125 10.875H7.125",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}))},50870:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.TencentEmbeddingModel=void 0;const l=a(398),i=a(88873),s=a(15985),c=a(98494),u=a(66870);let d=class TencentEmbeddingModel extends i.OpenAIEmbeddingModel{};n.TencentEmbeddingModel=d,r([(0,s.Autowired)(u.TencentEmbeddingOptions),o("design:type",u.TencentEmbeddingOptions)],d.prototype,"defaultOptions",void 0),r([(0,s.Autowired)(c.TencentAPI),o("design:type",Object)],d.prototype,"chatApi",void 0),n.TencentEmbeddingModel=d=r([(0,s.Component)(l.EmbeddingModel)],d)},51059:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(861),n)},51331:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconEdit=void 0;const o=r(a(48431));n.IconEdit=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("g",null,o.default.createElement("path",{d:"M1.93152 14.5547H14.0684",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M2.97266 8.88569V11.4999H5.60022L13.0273 4.0696L10.4041 1.44531L2.97266 8.88569Z",strokeWidth:"1.3",strokeLinejoin:"round"})))},51360:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.ModelManagerImpl=void 0;const l=a(15985),i=a(26020),s=a(69103);let c=class ModelManagerImpl{async getModels(){const{models:e=[]}=await this.productManager.waitConfiguration();return e}async getModel(e){const n=(await this.getModels()).find((n=>n.id===e));if(!n)throw new Error(`Model with id ${e} not found`);return n}};n.ModelManagerImpl=c,r([(0,l.Autowired)(i.ProductManager),o("design:type",Object)],c.prototype,"productManager",void 0),n.ModelManagerImpl=c=r([(0,l.Component)(s.ModelManager)],c)},51496:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.SwitchAccount=SwitchAccount,a(85310),a(80337);const c=a(15985),u=a(84176),d=a(27942),f=a(19606),m=s(a(48431)),p=a(15389),v=a(35372),h=a(91963);function SwitchAccount(e){(0,v.useActivePage)(),(0,h.useWebviewStatus)();const n=(0,f.useIntl)(),a=(0,p.useNavigate)(),[r,o]=m.useState([]),loadData=async()=>{const e=c.ContainerUtil.get(d.AuthenticationProxy),n=await e.getAccounts();o(n)},t=e=>n.formatMessage({id:e});m.useEffect((()=>{loadData()}),[]);const[l,i]=m.useState(!1),isPersonalAccount=e=>"personal"===e.type;return m.createElement("div",{className:"code-buddy-switch-account"},l&&m.createElement("div",{className:"code-buddy-switch-account__loading"},"Loading..."),m.createElement("div",{className:"code-buddy-switch-account__header",onClick:async()=>{a("/")}},m.createElement("span",{className:"code-buddy-switch-account__icon-back"},m.createElement(f.Icon,{name:f.SvgIconName.LeftArrowIcon})),m.createElement("span",null,t("Return"))),m.createElement("div",{className:"code-buddy-switch-account__body"},m.createElement("div",{className:"code-buddy-switch-account__title"},t("Select Account")),m.createElement("div",{className:"code-buddy-switch-account__list"},m.createElement("div",null,r.map((e=>m.createElement("div",{className:"code-buddy-switch-account__item",key:e.uid},e.enterpriseLogo?m.createElement("img",{className:"code-buddy-switch-account__logo",src:e.enterpriseLogo,alt:"logo"}):m.createElement("div",{className:"code-buddy-switch-account__logo--default"},(e.enterpriseName||e.nickname).slice(0,1)),m.createElement("div",{className:"code-buddy-switch-account__info",onClick:()=>(async e=>{try{i(!0);const n=c.ContainerUtil.get(d.AuthenticationProxy);await n.switchAccount(e),loadData(),i(!1)}catch(e){i(!1)}})(e)},m.createElement("div",{className:"code-buddy-switch-account__info-enterprise"},m.createElement("div",{className:"code-buddy-switch-account__info-enterprise-name"},e.enterpriseName||e.nickname),m.createElement("div",{className:"code-buddy-switch-account__info-enterprise-type "+(isPersonalAccount(e)?"code-buddy-switch-account__info-enterprise-type--personal":"code-buddy-switch-account__info-enterprise-type--enterprise")},isPersonalAccount(e)?t("Personal"):t("Enterprise")))),e.lastLogin&&m.createElement("div",{className:"code-buddy-switch-account__postfix"},t("Current Use")))))))))}let g=class{};g=i([(0,u.View)({index:!1,path:"/switch-account",component:SwitchAccount})],g),n.default=g},51555:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Loading=function Loading(e){const{conversationState:{conversation:n}}=(0,c.useContext)(u.ConversationContext),{showAvatar:a,assistantName:r,loadingText:o,timeoutText:l}=e,[i,m]=(0,c.useState)(!1),p=(0,d.getGlobalTheme)();return(0,c.useEffect)((()=>{const e=setTimeout((()=>{m(!0)}),1e4);return()=>clearTimeout(e)}),[]),c.default.createElement("div",{className:"message-item assistant-message loading-message"},a&&c.default.createElement(f.Avatar,{assistantName:(null==n?void 0:n.assistantName)||r||""}),c.default.createElement("div",{className:"loading-content"},i&&l?c.default.createElement(c.default.Fragment,null,"dark"===p?c.default.createElement("img",{className:"loading-icon",src:"./assets/image/loading-timeout-dark.png",alt:"icon"}):c.default.createElement("img",{className:"loading-icon",src:"./assets/image/loading-timeout-light.png",alt:"icon"})):c.default.createElement(c.default.Fragment,null,"dark"===p?c.default.createElement("img",{className:"loading-icon",src:"./assets/image/loading-normal-dark.png",alt:"icon"}):c.default.createElement("img",{className:"loading-icon",src:"./assets/image/loading-normal-light.png",alt:"icon"})),c.default.createElement("div",{className:"loading-text"},c.default.createElement(s.FormattedMessage,{id:i&&l?l:o}),c.default.createElement("span",{className:"dot dot1"},"."),c.default.createElement("span",{className:"dot dot2"},"."),c.default.createElement("span",{className:"dot dot3"},"."))))},a(53197);const s=a(19606),c=i(a(48431)),u=a(32134),d=a(20421),f=a(66319)},51562:(e,n,a)=>{"use strict";a.r(n)},51595:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(88891),n),o(a(1991),n),o(a(8891),n)},51662:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(93108),n),o(a(78101),n),o(a(24117),n),o(a(34780),n),o(a(11077),n),o(a(59400),n),o(a(20471),n)},51724:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Mcp=void 0,a(58442);const c=a(15985),u=a(69022),d=a(19606),f=i(a(48431)),m=a(15389),p=a(64900),v=a(25380),h=s(a(14388)),g=s(a(93755)),y=a(88246),b=s(a(92545)),_=s(a(14805)),C=a(20421),E=a(70605),w=a(20815);n.Mcp=()=>{(0,v.useActivePage)(),(0,v.useWebviewStatus)();const[e,n]=(0,f.useState)(!0),[a,r]=(0,f.useState)(!1),o=(0,w.useTabL10n)(),[l,i]=(0,f.useState)("1"),s=(0,m.useNavigate)(),openSettingFile=()=>{(0,C.getMcpViewService)().openSettingFile()};return(0,f.useEffect)((()=>{c.ContainerUtil.get(u.McpViewService).getMcpMarketEnabled().then((e=>{n(e),e||i(y.TabKey.Installed)}))}),[]),f.default.createElement("div",{className:"code-buddy-mcp"},f.default.createElement(h.default,{onBack:()=>s("/")}),f.default.createElement(_.default,{tabs:e?[{key:y.TabKey.Market,title:o.market,content:f.default.createElement(b.default,{onChange:i,isUpdate:l===y.TabKey.Market})},{key:y.TabKey.Installed,title:o.installed,content:f.default.createElement(g.default,{isShowAdd:r,isUpdate:l===y.TabKey.Installed})}]:[{key:y.TabKey.Installed,title:o.installed,content:f.default.createElement(g.default,{isShowAdd:r,isUpdate:l===y.TabKey.Installed})}],activeKey:l,onChange:i,extra:f.default.createElement(f.default.Fragment,null,f.default.createElement(p.IconButton,{className:"mcp-tabs__icon-button hidden",title:o.addMcpServer,onClick:openSettingFile},f.default.createElement(d.Icon,{name:d.SvgIconName.AddIcon})),a&&f.default.createElement(p.IconButton,{className:"mcp-tabs__icon-button",title:o.configFile,onClick:openSettingFile},f.default.createElement(E.SettingIcon,null)))}))}},51943:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SettingIcon=void 0;const o=r(a(48431));n.SettingIcon=e=>o.default.createElement("svg",{width:"16",height:"14",viewBox:"0 0 16 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M11.4369 0.484375C11.6358 0.511239 11.8133 0.629485 11.9144 0.806641L15.264 6.67871L15.3011 6.75488C15.376 6.93825 15.3636 7.14751 15.264 7.32227L11.9144 13.1943C11.7988 13.3969 11.5832 13.5214 11.35 13.5215H4.64976C4.41654 13.5214 4.20095 13.3969 4.08531 13.1943L0.735702 7.32227C0.621939 7.12274 0.621968 6.87825 0.735702 6.67871L4.08531 0.806641L4.13316 0.734375C4.25503 0.574702 4.44566 0.478619 4.64976 0.478516H11.35L11.4369 0.484375ZM2.04723 7L5.02672 12.2217H10.973L13.9515 7L10.973 1.7793H5.02672L2.04723 7ZM7.99937 3.99609C9.65807 3.99614 11.0023 5.3413 11.0023 7C11.0023 8.65866 9.65804 10.0029 7.99937 10.0029C6.34083 10.0027 4.99552 8.65858 4.99547 7C4.99547 5.34138 6.3408 3.99628 7.99937 3.99609ZM7.99937 5.29688C7.05877 5.29706 6.29625 6.05935 6.29625 7C6.2963 7.94061 7.0588 8.70294 7.99937 8.70312C8.94007 8.70308 9.70245 7.94069 9.7025 7C9.7025 6.05927 8.9401 5.29692 7.99937 5.29688Z",fill:"currentColor"}))},52239:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),a(65611);const r=a(15985);n.default=(0,r.autoBind)()},52337:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Followup=function Followup(e){return o.default.createElement("div",{className:"followup"})},a(85371);const o=r(a(48431))},52438:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ChatModeControllerImpl=void 0;const i=a(15985),s=a(76243),c=a(69022),u=l(a(64783)),d=a(20421),f=a(50473);let m=class ChatModeControllerImpl{init(){this.getBaseInfo(),this.configViewService.onDidChange((({key:e,value:n})=>{e===s.CHAT_SELECTED_MODE?this.chatMode=Promise.resolve(n):e===f.CHAT_MODE_SETTINGS?this.chatModeSettings=this.getDefaultChatModeSettings():e===f.CHAT_SELECTED_MODEL_MAP?this.chatModelMap=d.JsonUtils.safeParse(n||"{}")||{}:e!==s.ModelSettingsKey&&e!==s.ModelSettingsKeyOld||(this.chatModelSettings=this.getDefaultChatModelSettings())})),this.onDidWindowStateChange((e=>{e&&this.getBaseInfo()}))}getBaseInfo(){this.chatMode=this.getDefaultChatMode(),this.chatModelMap=this.getDefaultChatModelMap(),this.chatModeSettings=this.getDefaultChatModeSettings(),this.chatModelSettings=this.getDefaultChatModelSettings()}onDidChangeModeSettings(e){return this.configViewService.onDidChange((({key:n,value:a})=>{n!==s.CHAT_SELECTED_MODE&&n!==f.CHAT_MODE_SETTINGS||e(n,a)}))}onDidChangeCodebaseStatus(e){return this.chatViewService.codebaseObserver.subscribe((n=>{e(!!n)}))}onDidWindowStateChange(e){return this.chatViewService.windowStateObserver.subscribe((n=>{e(!!n)}))}async getModels(){var e,n;const[a,r,o]=await Promise.all([this.getChatMode(),this.productViewService.getAgents(),this.productViewService.getModels()]),l=null!==(n=null===(e=r.find((e=>e.name===a)))||void 0===e?void 0:e.models)&&void 0!==n?n:[];return l.length?o.filter((e=>e.id&&l.includes(e.id)||"user"===e.vendor)):[]}async getChatModelMap(){return{...await this.chatModelMap}}async getDefaultChatModelMap(){const e=await this.configViewService.get(f.CHAT_SELECTED_MODEL_MAP);return d.JsonUtils.safeParse(e||"{}")||{}}async updateChatModelMap(e){this.chatModelMap=Promise.resolve(e),await this.configViewService.update(f.CHAT_SELECTED_MODEL_MAP,d.JsonUtils.safeStringify(e||"")||"")}async getChatModelSettings(){const e=await this.chatModelSettings;return e?{...e}:void 0}async getDefaultChatModelSettings(){const[e,n]=await Promise.all([this.configViewService.get(s.ModelSettingsKey),this.configViewService.get(s.ModelSettingsKeyOld)]);if(e||n){return d.JsonUtils.safeParse(e||n||"")}}async updateChatModelSettings(e){this.chatModelSettings=Promise.resolve(e),await this.configViewService.update(s.ModelSettingsKey,d.JsonUtils.safeStringify(e||"")||""),await this.productViewService.sync()}async getChatMode(){return this.chatMode}async getDefaultChatMode(){return this.configViewService.get(s.CHAT_SELECTED_MODE)}async updateChatMode(e){this.chatMode=Promise.resolve(e),await this.configViewService.update(s.CHAT_SELECTED_MODE,e)}async getChatModeSettings(){return{...await this.chatModeSettings}}async getDefaultChatModeSettings(){const e={craft:{isPlan:!1,autoRun:!1,autoModifyFile:!0,codebase:!0},ask:{codebase:!0}},n=await this.configViewService.get(f.CHAT_MODE_SETTINGS);if(n)return(0,u.default)(e,d.JsonUtils.safeParse(n)||{});{const[n,a]=await Promise.all([this.configViewService.get(f.CRAFT_SETTINGS),this.configViewService.get(f.ASK_SETTINGS)]);return(0,u.default)(e,{craft:d.JsonUtils.safeParse(n||"")||{},ask:d.JsonUtils.safeParse(a||"")||{}})}}async updateChatModeSettings(e){this.chatModeSettings=Promise.resolve(e),await this.configViewService.update(f.CHAT_MODE_SETTINGS,d.JsonUtils.safeStringify(e)||"")}};n.ChatModeControllerImpl=m,r([(0,i.Autowired)(s.ConfigViewService),o("design:type",Object)],m.prototype,"configViewService",void 0),r([(0,i.Autowired)(s.ProductViewService),o("design:type",Object)],m.prototype,"productViewService",void 0),r([(0,i.Autowired)(c.ChatViewService),o("design:type",Object)],m.prototype,"chatViewService",void 0),r([(0,i.PostConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],m.prototype,"init",null),n.ChatModeControllerImpl=m=r([(0,i.Component)(f.ChatModeController)],m)},52450:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.ProductPromptProvider=void 0;const l=a(15985),i=a(26020),s=a(97317),c=a(75645);let u=class ProductPromptProvider{constructor(){this.productTemplateSubject=new s.BehaviorSubject([])}initialize(){this.productManager.configuration.subscribe((e=>{this.productTemplateSubject.next((null==e?void 0:e.prompts)||[])}))}};n.ProductPromptProvider=u,r([(0,l.Autowired)(i.ProductManager),o("design:type",Object)],u.prototype,"productManager",void 0),n.ProductPromptProvider=u=r([(0,l.Component)(c.PromptProvider,l.ApplicationLifecycle)],u)},52548:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(27330),n)},52735:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(54247),n),o(a(94706),n)},53197:(e,n,a)=>{"use strict";a.r(n)},53760:(e,n,a)=>{"use strict";a.r(n)},53862:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.AssistantMessageContent=void 0;const c=a(84176),u=a(59659),d=a(69022),f=s(a(48431)),m=a(63306),p=a(37232),v=a(4882),h=a(67287),g=a(1991),y=a(35043);n.AssistantMessageContent=(0,f.memo)((e=>{const{message:n}=e,a=(0,f.useMemo)((()=>({message:n})),[n]);return f.default.createElement(v.CurrentMessageContext.Provider,{value:a},f.default.createElement("div",{className:"assistant-message-content"},n.content.map(((e,a)=>f.default.createElement(f.default.Fragment,{key:`${n.id}-content-${a}`},e.type===d.AssistantMessageContentType.REASONING&&e.text.length>0&&f.default.createElement(h.ReasoningRenderer,null,e.text),e.type===d.AssistantMessageContentType.TOOL_CALL&&f.default.createElement(g.ToolRenderer,{message:n,tool:e.tool}),e.type===d.AssistantMessageContentType.TEXT&&f.default.createElement(p.MarkdownRenderer,null,e.text)))),n.isEnd&&f.default.createElement(c.Slot,{area:m.ChatBodyConversionMessageArea.FeedBack})))}));let b=class{};b=i([(0,u.Widget)({area:m.ChatBodyConversionMessageArea.FeedBack,component:y.Feedback})],b),n.default=b},54136:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconCreateFile=void 0;const o=r(a(48431));n.IconCreateFile=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M13 7.7V5L10.1875 2H3.625C3.27982 2 3 2.26863 3 2.6V13.4C3 13.7314 3.27982 14 3.625 14H7.375",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M9.4165 2V5.00011H12.9999",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M11.2085 9.5V14",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M13.4585 11.75L8.9585 11.75",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},54247:function(e,n,a){"use strict";var r,o=a(78),l=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),i=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),s=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},c=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),o=0;o<a.length;o++)"default"!==a[o]&&l(n,e,a[o]);return i(n,e),n}),u=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.DefaultAegisWebviewInitializer=void 0;const d=a(15985),f=a(69022),m=a(69865);let p=class DefaultAegisWebviewInitializer{async initialize(){if("undefined"!=typeof window)try{if(!await this.chatViewService.getAegisEnable())return void o.log("[AegisWebviewInitializer] Aegis监控未开启");o.log("[AegisWebviewInitializer] Aegis监控开启");const e=await this.chatViewService.getUserId()||"anonymous",n=new(await this.loadAegisSDK())({id:"EPepxhrzZR7Ld5npKl",uin:e,reportApiSpeed:!0,reportAssetSpeed:!0,spa:!0,hostUrl:"https://rumt-zh.com"});window.__aegis__=n,n.reportEvent("webview_init","vscode_plugin"),o.log("[AegisWebviewInitializer] Aegis监控在webview中初始化成功")}catch(e){o.error("[AegisWebviewInitializer] Aegis监控在webview中初始化失败:",e)}}onStart(){}onStop(){}async loadAegisSDK(){try{const e=await Promise.resolve().then((()=>c(a(14540))));return e.default||e}catch(e){throw new Error(`Failed to load aegis-web-sdk in webview: ${e}`)}}};n.DefaultAegisWebviewInitializer=p,s([(0,d.Autowired)(f.ChatViewService),u("design:type",Object)],p.prototype,"chatViewService",void 0),n.DefaultAegisWebviewInitializer=p=s([(0,d.Component)(m.AegisWebviewInitializer,d.ApplicationLifecycle)],p)},54540:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AcceptIcon=void 0;const o=r(a(48431));n.AcceptIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:e,style:n,...a},o.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.05569 12.5202C7.05238 12.5237 7.04902 12.5271 7.04562 12.5305C6.79178 12.7843 6.38022 12.7843 6.12638 12.5305L1.88374 8.28787C1.6299 8.03402 1.6299 7.62247 1.88374 7.36863C2.13758 7.11479 2.54914 7.11479 2.80298 7.36863L6.58589 11.1515L13.1977 4.53975C13.4515 4.2859 13.8631 4.28591 14.1169 4.53975C14.3707 4.79359 14.3707 5.20514 14.1169 5.45898L7.05569 12.5202Z",fill:"currentColor"}))},55225:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.RightArrowIcon=void 0;const o=r(a(48431));n.RightArrowIcon=e=>o.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M4.23971 2.47949L7.76025 6.00003L4.23971 9.52058",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}))},55681:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.chatStateTextSubject=n.chatActionSubject=void 0;const r=a(97317);n.chatActionSubject=new r.BehaviorSubject(void 0),n.chatStateTextSubject=new r.Subject},55889:(e,n,a)=>{"use strict";a.r(n)},56176:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SearchReferenceRenderer=void 0;const l=a(15985),i=a(69022),s=a(19606),c=o(a(48431)),u=a(46988),d=a(77478),f=a(73671),m=a(39941),p=a(42810),v=a(63565);let h=class SearchReferenceRenderer{constructor(){this.className="search-reference",this.clickHeader=!0,this.resultVisible=!1,this.t=(e,n)=>e}canHandle(e){return[i.ToolNames.KNOWLEDGE_BASE,i.ToolNames.CODE_BASE].includes(e.name)?p.ChatToolRendererPriority.EXACT:p.ChatToolRendererPriority.NONE}renderTitle(e){const{status:n}=e,a=e.name===i.ToolNames.KNOWLEDGE_BASE?this.reference.length:this.filePaths.length;return c.default.createElement(c.default.Fragment,null,c.default.createElement("span",{className:["title",n!==i.ToolStatus.EXECUTED?"disabled":""].join(" ")},[i.ToolStatus.FAILED,i.ToolStatus.CANCELLED,i.ToolStatus.EXECUTED].includes(e.status)?!a&&c.default.createElement("span",null,c.default.createElement(s.FormattedMessage,{id:"No information retrieved"})):c.default.createElement("span",{className:"control-info"},c.default.createElement(s.FormattedMessage,{id:"Searching"}),c.default.createElement(f.LoadingDots,null))),n===i.ToolStatus.EXECUTED&&!!a&&c.default.createElement("span",{className:"file-num"},this.t("Reference {num} documents as reference",{num:a})))}renderResult(e,n){return c.default.createElement("div",{className:"container"},v.ToolUtils.isToolCallRunning(e.status)&&c.default.createElement("span",{className:"content-item"},this.t("Searching"),c.default.createElement(f.LoadingDots,null)),e.status===i.ToolStatus.EXECUTED&&e.name===i.ToolNames.KNOWLEDGE_BASE&&c.default.createElement(d.KnowledgeBaseReferences,{reference:this.reference}),e.status===i.ToolStatus.EXECUTED&&e.name===i.ToolNames.CODE_BASE&&c.default.createElement(u.CodebaseReferences,{reference:this.filePaths,workspacePath:n}))}renderIcon(e,n){const a=e.name===i.ToolNames.KNOWLEDGE_BASE?this.reference.length:this.filePaths.length;return c.default.createElement(c.default.Fragment,null,e.status===i.ToolStatus.EXECUTED&&!!a&&c.default.createElement(m.ArrowIcon,{className:n?"arrow-up":""}))}get filePaths(){var e,n,a,r;if(null===(n=null===(e=this.tool)||void 0===e?void 0:e.result)||void 0===n?void 0:n.success){const e=null===(r=null===(a=this.tool)||void 0===a?void 0:a.result)||void 0===r?void 0:r.result;if(e&&Object.keys(e).length)return Object.values(e).filter((e=>!!e.metadata)).map((e=>({startPos:e.metadata.start_pos,endPos:e.metadata.end_pos,fileName:e.metadata.file_name,source:e.metadata.source,sourceType:e.metadata.source_type})))}return[]}get reference(){var e,n,a,r;if(null===(n=null===(e=this.tool)||void 0===e?void 0:e.result)||void 0===n?void 0:n.success){const e=null===(r=null===(a=this.tool)||void 0===a?void 0:a.result)||void 0===r?void 0:r.result;if(e&&Object.keys(e).length)return Object.values(e).filter((e=>!!e.metadata))}return[]}};n.SearchReferenceRenderer=h,n.SearchReferenceRenderer=h=r([(0,l.Component)({id:p.ChatToolRenderer,scope:l.Scope.Transient})],h)},56485:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThumbsDownSolidIcon=void 0;const o=r(a(48431));n.ThumbsDownSolidIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("g",null,o.default.createElement("path",{d:"M7.23779 15.0256C6.3267 15.0254 5.58838 14.2863 5.58838 13.3752L5.58838 10.7756L2.50049 10.7756C1.43664 10.7754 0.651345 9.78287 0.89502 8.74725L2.42432 2.24725C2.59982 1.50229 3.26443 0.975958 4.02979 0.975768L13.2378 0.975769C14.1489 0.975769 14.888 1.71409 14.8882 2.62518L14.8882 7.62518C14.8882 8.53645 14.1491 9.27557 13.2378 9.27557L12.5005 9.27557L12.5005 0.977722L11.2007 0.977722L11.2007 9.27557L9.58545 13.9172C9.35472 14.5805 8.72919 15.0256 8.02686 15.0256L7.23779 15.0256Z",fill:"#808080"})))},56797:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ToolRenderer=n.ToolStatusWeightMap=void 0,a(10219);const c=a(15985),u=a(69022),d=a(19606),f=s(a(73059)),m=i(a(48431)),p=a(99095),v=a(32134),h=a(20421),g=a(51555),y=a(89655),b=a(91015),_=a(42810),C=a(63565);n.ToolStatusWeightMap={[u.ToolStatus.DESTROYED]:-1,[u.ToolStatus.IDLE]:1,[u.ToolStatus.PARSING]:10,[u.ToolStatus.PENDING]:11,[u.ToolStatus.STREAM_EXECUTING]:20,[u.ToolStatus.FULL_EXECUTING]:21,[u.ToolStatus.EXECUTED]:100,[u.ToolStatus.FAILED]:101,[u.ToolStatus.SKIPPED]:103,[u.ToolStatus.CANCELLED]:110},n.ToolRenderer=(0,m.memo)((e=>{var a,r,o,l;const{message:i,tool:s}=e,E=c.ContainerUtil.getAll(_.ChatToolRenderer),[w,O]=(0,m.useState)(!1),[M,S]=(0,m.useState)({autoRun:!1,autoModifyFile:!1,isPlan:!1}),[P,T]=(0,m.useState)(s.status),j=(0,m.useContext)(p.GlobalContext),{conversationState:{conversation:k}}=(0,m.useContext)(v.ConversationContext),I=(0,m.useRef)(s.status),N=(0,h.getGlobalTheme)(),x=(0,d.useIntl)(),t=(e,n)=>x.formatMessage({id:e},n),D=null==E?void 0:E.map((e=>({priority:e.canHandle(s)||0,renderer:e}))).filter((()=>Boolean)).sort(((e,n)=>n.priority-e.priority))[0].renderer;D&&(D.t=t,D.tool=s);const R={[u.ToolNames.EXECUTE_COMMAND]:t("Confirm whether to allow running commands"),[u.ToolNames.REPLACE_IN_FILE]:t("Confirm whether to allow modifying files"),[u.ToolNames.WRITE_TO_FILE]:t("Confirm whether to allow writing files")},L={[u.ToolNames.READ_FILE]:{loadingText:t("Reading file"),timeoutText:t("Reading file, please wait")},[u.ToolNames.WRITE_TO_FILE]:{loadingText:t("Writing code"),timeoutText:t("Writing code, please wait")},[u.ToolNames.SEARCH_FILE]:{loadingText:t("Searching content"),timeoutText:t("Searching content, please wait")},[u.ToolNames.SEARCH_CONTENT]:{loadingText:t("Searching file"),timeoutText:t("Searching file, please wait")}},A=(0,m.useCallback)((e=>{(null==D?void 0:D.renderResult)&&[u.ToolStatus.STREAM_EXECUTING,u.ToolStatus.FULL_EXECUTING,u.ToolStatus.EXECUTED].includes(s.status)&&O(e)}),[s]),F=(0,m.useCallback)((e=>{var a,r;const o=(null!==(a=n.ToolStatusWeightMap[e])&&void 0!==a?a:0)>=(null!==(r=n.ToolStatusWeightMap[I.current])&&void 0!==r?r:0)?e:I.current;I.current=o,T(o)}),[]);(0,m.useEffect)((()=>{var e,n,a;S({autoRun:null!==(e=null==j?void 0:j.globalState.autoRun)&&void 0!==e&&e,autoModifyFile:null!==(n=null==j?void 0:j.globalState.autoModifyFile)&&void 0!==n&&n,isPlan:null!==(a=null==j?void 0:j.globalState.isPlan)&&void 0!==a&&a})}),[j]),(0,m.useEffect)((()=>{F(s.status)}),[s,s.status]);const V=(0,m.useMemo)((()=>({resultVisibleChange:A,toolStatusRef:I,setToolStatus:F,requestId:i.requestId})),[A,I,F,i.requestId]),B=[u.ToolNames.EXECUTE_COMMAND,u.ToolNames.WRITE_TO_FILE,u.ToolNames.REPLACE_IN_FILE,u.ToolNames.READ_FILE].includes(s.name);return s.ready?m.default.createElement(m.default.Fragment,null,D?m.default.createElement("div",{className:"assistant-message-tools"},m.default.createElement(b.CurrentToolContext.Provider,{value:V},D.render?D.render(s):m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"assistant-message-tool-container"},C.ToolUtils.isToolCallRunning(P)&&m.default.createElement("div",{className:"flow-border-box"},m.default.createElement(y.MovingBorder,{duration:3e3,rx:"30%",ry:"30%"},m.default.createElement("div",{className:"flow-border"}))),m.default.createElement("div",{className:(0,f.default)([{"tool-box":B},{"tool-pending":(null===(a=D.tool)||void 0===a?void 0:a.status)===u.ToolStatus.PENDING}])},m.default.createElement("div",{className:(0,f.default)(["assistant-message-tool",D.className]),key:s.id},m.default.createElement("div",{className:["card-header",D.clickHeader?"click-header":""].join(" "),onClick:()=>{var e;null===(e=D.clickCardHeader)||void 0===e||e.call(D,s),A(!w)}},m.default.createElement("div",{className:"left"},D.renderIcon&&D.renderIcon(s,w),D.renderTitle&&D.renderTitle({...s,status:P},(null==k?void 0:k.workspace)||"")),m.default.createElement("div",{className:"right"},D.renderControl&&m.default.createElement("div",{className:"control"},D.renderControl({...s,status:P},M)))),D.renderResult&&(w&&s.result||D.alwaysShowResult)&&m.default.createElement("div",{className:D.alwaysShowResult?"":"card-content"},D.renderResult({...s,status:P},(null==k?void 0:k.workspace)||"")),D.renderButtons&&m.default.createElement("div",{className:"card-bottom"},D.renderButtons({...s,status:P},M))))),Object.keys(L).includes(null==s?void 0:s.name)&&C.ToolUtils.isToolCallExecuting(P)&&m.default.createElement("div",{className:"loading-container"},m.default.createElement(g.Loading,{showAvatar:!1,loadingText:(null===(r=L[null==s?void 0:s.name])||void 0===r?void 0:r.loadingText)||t("Thinking"),timeoutText:(null===(o=L[null==s?void 0:s.name])||void 0===o?void 0:o.timeoutText)||t("Generating answer, please wait")})),(null===(l=D.tool)||void 0===l?void 0:l.status)===u.ToolStatus.PENDING&&R[s.name]&&m.default.createElement("div",{className:"assistant-message-tool-tip"},"dark"===N?m.default.createElement("img",{className:"tip-icon",src:"./assets/image/loading-waiting-dark.png",alt:"icon"}):m.default.createElement("img",{className:"tip-icon",src:"./assets/image/loading-waiting-light.png",alt:"icon"}),m.default.createElement("span",null,R[s.name]))))):""):m.default.createElement(m.default.Fragment,null)}))},57035:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(9332),n),o(a(4913),n),o(a(52438),n)},57165:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconButton=void 0;const o=r(a(73059)),l=r(a(48431));n.IconButton=e=>{const{size:n="medium",disabled:a,className:r,children:i,...s}=e;return l.default.createElement("div",{className:(0,o.default)("codebuddy-icon-button",n,a,r),...s},i)}},58271:function(e,n,a){"use strict";var r,o=a(78),l=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),i=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),o=0;o<a.length;o++)"default"!==a[o]&&l(n,e,a[o]);return i(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Copy=function Copy(e){const{content:n}=e,[a,r]=(0,u.useState)(!1),o=(0,c.useIntl)();return u.default.createElement("span",{className:"copy",onClick:e=>(async e=>{e.stopPropagation(),e.preventDefault(),await copyContent(n),r(!0),setTimeout((()=>{r(!1)}),2e3)})(e),title:o.formatMessage({id:"Copy"})},a?u.default.createElement(d.CopiedIcon,{className:"copied"}):u.default.createElement(f.CopyIcon,null))},n.copyContent=copyContent,a(68505);const c=a(19606),u=s(a(48431)),d=a(90456),f=a(27899);async function copyContent(e){try{return await navigator.clipboard.writeText(e),!0}catch(e){o.log("Clipboard API failed:",e)}try{const n=document.createElement("textarea");n.value=e,n.setAttribute("readonly",""),n.style.position="fixed",n.style.top="0",n.style.left="-9999px",n.style.opacity="0",n.style.pointerEvents="none",document.body.appendChild(n),n.focus(),n.select();const a=document.execCommand("copy");if(document.body.removeChild(n),a)return!0}catch(e){o.log("Fallback textarea copy failed:",e)}return!1}},58442:(e,n,a)=>{"use strict";a.r(n)},58509:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Login=Login,a(85310),a(37583);const c=a(15985),u=a(84176),d=a(76243),f=a(27942),m=a(69022),p=a(19606),v=s(a(48431)),h=a(81878),g=a(35372),y=a(91963);function Login(e){(0,g.useActivePage)(),(0,y.useWebviewStatus)();const[n,a]=v.useState({}),r=c.ContainerUtil.get(m.ChatViewService),o=c.ContainerUtil.get(d.ProductViewService),l=(0,p.useIntl)(),i={chatName:l.formatMessage({id:"CodeBuddy"}),intro:l.formatMessage({id:"Support code completion, requirement breakdown, code generation, project understanding, and technical Q&A. Use the shortcut {shortcut} to chat with me."},{shortcut:h.isMacOs?"Cmd + ​I":"Alt + I"}),login:l.formatMessage({id:"Login"}),helpDocument:l.formatMessage({id:"Help Document"})};return v.useEffect((()=>{o.getLinks().then(a)}),[]),v.createElement("div",{className:"code-buddy-login"},v.createElement("div",{className:"login-container__circle"},v.createElement("div",{className:"login-container__circle-inner"})),v.createElement("div",{className:"login-logo"},v.createElement("img",{src:"./assets/image/copilot.png",alt:"system"}),v.createElement("div",null,i.chatName)),v.createElement("div",{className:"login-intro"},v.createElement("div",{className:"login-intro-text"},i.intro)),v.createElement("div",{className:"footer"},v.createElement("div",{className:"login-btn",onClick:()=>{c.ContainerUtil.get(f.AuthenticationProxy).login()}},i.login),(null==n?void 0:n.helpDocument)&&v.createElement("div",{className:"feedback-box"},v.createElement("a",{href:"javascript:;",className:"feedback-item",onClick:()=>{return e="helpDocument",void r.openConfigLink(e);var e}},v.createElement("div",{className:"feedback-text"},i.helpDocument)))))}let b=class{};b=i([(0,u.View)({index:!1,path:"/login",component:Login})],b),n.default=b},58591:(e,n,a)=>{"use strict";a.r(n)},58715:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Checkbox=void 0,a(67413);const c=s(a(73059)),u=i(a(48431));n.Checkbox=({checked:e,defaultChecked:n,onChange:a,label:r,disabled:o=!1,className:l=""})=>{const[i,s]=u.default.useState(!!n),d="boolean"==typeof e,f=d?e:i,m=(0,u.useCallback)((e=>{d||s(e.target.checked),null==a||a(e.target.checked,e)}),[d,a]);return u.default.createElement("label",{className:(0,c.default)("codebuddy-checkbox",l)},u.default.createElement("input",{type:"checkbox",checked:f,disabled:o,onChange:m}),r&&u.default.createElement("span",{className:"checkbox-label"},r))}},58732:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconZoomIn=void 0;const o=r(a(48431));n.IconZoomIn=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M8.99967 0.849609C12.3962 0.849609 15.1501 3.60345 15.1501 6.99998C15.1501 10.3965 12.3962 13.1504 8.99967 13.1504C7.53551 13.1503 6.19157 12.6376 5.1354 11.7832L1.9596 14.9599L1.85706 15.0429C1.60479 15.2093 1.26169 15.1819 1.03967 14.9599C0.817728 14.7379 0.790305 14.3948 0.956663 14.1425L1.03967 14.04L4.21547 10.8633C3.36166 9.80723 2.84925 8.46362 2.84925 6.99998C2.84925 3.60352 5.60321 0.849713 8.99967 0.849609ZM8.99967 2.15039C6.32118 2.15049 4.15004 4.32149 4.15004 6.99998C4.15004 9.67848 6.32118 11.8495 8.99967 11.8496C11.6783 11.8496 13.8493 9.67854 13.8493 6.99998C13.8493 4.32142 11.6783 2.15039 8.99967 2.15039ZM9.04069 4.25585C9.39965 4.25585 9.69104 4.54729 9.69108 4.90624V6.44334H11.2292C11.5879 6.44364 11.8795 6.73498 11.8796 7.09373C11.8795 7.4525 11.5879 7.74382 11.2292 7.74412H9.69108V9.28122C9.69104 9.64017 9.39965 9.93161 9.04069 9.93161C8.68189 9.93142 8.39033 9.64006 8.39029 9.28122V7.74412H6.85318C6.49438 7.74393 6.20282 7.45257 6.20278 7.09373C6.20284 6.73492 6.49439 6.44353 6.85318 6.44334H8.39029V4.90624C8.39033 4.5474 8.68189 4.25604 9.04069 4.25585Z",fill:"currentColor"}))},59141:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ChatHistoryList=void 0;const c=s(a(33709)),u=i(a(48431)),d=a(64900),f=s(a(63235)),m=a(25380),p=a(4896),v=a(6839),h=a(51331),g=a(71174);n.ChatHistoryList=e=>{const{conversations:n,currentConversation:a,onSelectConversation:r,onNameChanged:o,onDelete:l,exportConversation:i}=e,[s,c]=(0,u.useState)(),b=(0,u.useRef)(null),_=(0,u.useCallback)((e=>e===(null==s?void 0:s.id)),[s]),C=(0,u.useCallback)((()=>c(void 0)),[c]),E="Untitled";(0,u.useEffect)((()=>{b.current&&b.current.focus()}),[b,s]);const w=(0,u.useCallback)((async()=>{var e;const n=null==s?void 0:s.name;(null===(e=null==n?void 0:n.trim())||void 0===e?void 0:e.length)?s&&(await o(s),C()):f.default.error("Conversation name can't be empty")}),[s]);(0,m.useClickAway)(b,w);const O=(0,u.useCallback)((async e=>{s&&("Enter"===e.key?await w():"Escape"===e.key&&C())}),[s]),M=(0,u.useCallback)((e=>{if(!s)return;const n=e.target.value;n.length>30?f.default.error("Conversation name can't be longer than 30 characters"):c({...s,name:n})}),[s]),S=(0,d.useConfirmDialog)((0,u.useCallback)((async e=>{await l(e)}),[]));return u.default.createElement("div",{className:"chat-history-list"},u.default.createElement("ul",null,n.map((e=>{var n,o;return u.default.createElement("li",{key:e.id},_(e.id)?u.default.createElement("input",{ref:b,type:"text",maxLength:30,className:"chat-history__list-item-input",value:null!==(n=null==s?void 0:s.name)&&void 0!==n?n:E,onChange:M,onBlur:w,onKeyDown:O}):u.default.createElement("div",{className:"chat-history__list-item"},u.default.createElement("div",{className:"chat-history__list-item-name-content",onClick:()=>r(e.id)},u.default.createElement("span",{className:"truncate"},null!==(o=null==e?void 0:e.name)&&void 0!==o?o:E),e.id===(null==a?void 0:a.id)&&u.default.createElement("span",{className:"chat-history__current-item"},u.default.createElement(g.CurrentConversation,null))),u.default.createElement("span",{className:"chat-history__time"},u.default.createElement(y,{value:e.lastMessageAt})),u.default.createElement("div",{className:"chat-history__list-item-actions"},u.default.createElement(v.IconDownload,{className:"chat-history__list-item-icon",onClick:()=>i(e)}),u.default.createElement(h.IconEdit,{className:"chat-history__list-item-icon",onClick:()=>c(e)}),u.default.createElement(p.IconDelete,{className:"chat-history__list-item-icon",onClick:()=>S.onOpenDialog(e)}))))}))),u.default.createElement(d.Dialog,{visible:S.visible,title:u.default.createElement(g.DialogTitle,null),onClose:S.onCloseDialog,actions:u.default.createElement(u.default.Fragment,null,u.default.createElement(d.Button,{variant:"danger",onClick:S.onConfirmDialog},u.default.createElement(g.DialogConfirm,null)),u.default.createElement(d.Button,{variant:"secondary",onClick:S.onCloseDialog},u.default.createElement(g.DialogCancel,null)))},u.default.createElement(g.DialogContent,null)))};const y=(0,u.memo)((({value:e})=>{const n=(0,c.default)(),a=(0,c.default)(e),r=n.diff(a,"minute");if(r<1)return u.default.createElement(g.TimeJustNow,null);const o=n.diff(a,"hour");if(o<1)return u.default.createElement(g.TimeMinutes,{value:r});const l=n.diff(a,"day");return l<1?u.default.createElement(g.TimeHours,{value:o}):l<=5?u.default.createElement(g.TimeDays,{value:l}):a.format("YYYY.MM.DD")}))},59400:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0})},60247:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),a(48249);const c=a(19606),u=i(a(48431)),d=a(46141),f=a(78517),m=s(a(883));n.default=({visible:e,title:n,env:a,onRun:r,onSave:o,onClose:l})=>{const[i,s]=(0,u.useState)(!1),[p,v]=(0,u.useState)({}),h=(0,c.useIntl)(),t=e=>h.formatMessage({id:e});(0,u.useEffect)((()=>{s(e)}),[e]),(0,u.useEffect)((()=>{const e=Object.keys(a).reduce(((e,n)=>(e[n]=a[n]||n,e)),{});v(e)}),[a]);const g=(0,u.useCallback)(((e,n)=>{v((a=>({...a,[e]:n})))}),[]);return u.default.createElement(f.Dialog,{visible:i,title:u.default.createElement("div",{className:"mcp-dialog-env-title"},t("Run")," ",n),actions:u.default.createElement(u.default.Fragment,null,u.default.createElement(d.Button,{variant:"primary",onClick:()=>r(p)},t("Run")),u.default.createElement(d.Button,{variant:"primary",onClick:()=>o(p)},t("Save"))),onClose:l},u.default.createElement("div",{className:"mcp-dialog-env-content"},Object.entries(a).map((([e])=>{var n;return u.default.createElement("div",{key:e,className:"mcp-dialog-env-item"},u.default.createElement("label",{className:"mcp-dialog-env-label"},e),u.default.createElement("div",{className:"mcp-dialog-env-value"},u.default.createElement(m.default,{name:e,value:null!==(n=p[e])&&void 0!==n?n:"",placeholder:`${e}`,onChange:n=>g(e,n.target.value)})))}))))}},60448:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.EditorIcon=void 0;const o=r(a(48431));n.EditorIcon=()=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M1.93164 14.5547H14.0685",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M2.97266 8.88569V11.4999H5.60022L13.0273 4.0696L10.4041 1.44531L2.97266 8.88569Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinejoin:"round"}))},60511:(e,n,a)=>{"use strict";a.r(n)},60528:(e,n,a)=>{"use strict";a.r(n)},60742:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalContext=void 0,n.GlobalContextWrapper=function GlobalContextWrapper(e){const a=s.ContainerUtil.get(c.ConfigViewService),r=s.ContainerUtil.get(c.ProductViewService),[o,l]=(0,u.useState)({isPlan:!1,autoRun:!1,autoModifyFile:!0,codebase:!0,mode:f.WelcomeMode.CRAFT,workspace:"workspace"in window?window.workspace:void 0,platform:f.PlatformType.VSCODE});u.default.useEffect((()=>{a.get(d.CHAT_SELECTED_MODE).then((e=>{l((n=>({...n,mode:e})))})),r.getPlatform().then((e=>{l((n=>({...n,platform:e||f.PlatformType.VSCODE})))}));const e=a.onDidChange((({key:e,value:n})=>{e===d.CHAT_SELECTED_MODE&&l((e=>({...e,mode:n})))}));return()=>e.unsubscribe()}),[]);const i=(0,u.useMemo)((()=>({globalState:o,setGlobalState:l})),[o]);return u.default.createElement(n.GlobalContext.Provider,{value:i},e.children)};const s=a(15985),c=a(76243),u=i(a(48431)),d=a(50473),f=a(96593);n.GlobalContext=(0,u.createContext)(null)},60752:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useCodeBlockReportHooks=void 0;const r=a(48431),o=a(99095),l=a(25380);n.useCodeBlockReportHooks=({content:e,language:n},a)=>{if(!a)return;const{conversationId:i,requestId:s,id:c,extra:u}=a,{modelName:d,modelId:f}=null!=u?u:{},m={conversationId:i,requestId:s,messageId:c,requestModelName:null!=d?d:"",requestModelId:null!=f?f:""},{eventMap:p,report:v}=(0,l.useDataReport)(),h=(0,r.useContext)(o.GlobalContext),g=(null==h?void 0:h.globalState.mode)||"craft",y="codeAction",codeEditReport=()=>{v(p.CodeEdit,{languageId:n.toLocaleLowerCase(),source:"ask",fileCount:1,lineCount:e.split("\n").length,characterCount:e.length},{})};return(0,r.useMemo)((()=>({insert(){codeEditReport(),v(p.ChatUserAction,{...m,mode:g,scene:y,action:"insert"},{})},copy(){codeEditReport(),v(p.ChatUserAction,{...m,mode:g,scene:y,action:"copy"},{})},newFile(){codeEditReport(),v(p.ChatUserAction,{...m,mode:g,scene:y,action:"newFile"},{})},terminal(){v(p.ChatUserAction,{...m,mode:g,scene:y,action:"terminal"},{})},save(){codeEditReport(),v(p.ChatUserAction,{...m,mode:g,scene:y,action:"save"},{})}})),[])}},60983:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.CloseIcon=void 0;const o=r(a(48431));n.CloseIcon=()=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M12.5 3.5L3.5 12.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",style:{stroke:"#cccccc",strokeOpacity:1}}),o.default.createElement("path",{d:"M12.5 12.5L3.5 3.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",style:{stroke:"#cccccc",strokeOpacity:1}}))},61148:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Welcome=Welcome,a(61274);const l=a(59659),i=o(a(48431)),s=a(63306),c=a(99095),u=a(25380),d=a(33229),f=a(72956),m=a(14005),p=a(96593);function Welcome(){let e;const n=i.default.useContext(c.GlobalContext),{eventMap:a,report:r}=(0,u.useDataReport)(),o=Object.assign({isAsk:(null==n?void 0:n.globalState.mode)===p.WelcomeMode.ASK},n.globalState),l={...(0,m.getModeCopywriter)(o),...o};return i.default.useEffect((()=>(e=setTimeout((()=>{r(a.PageExposure,{page:"home"},{}),clearTimeout(e),e=void 0}),1e3),()=>{clearTimeout(e),e=void 0})),[]),i.default.createElement("div",{className:"welcome-container"},i.default.createElement("div",{className:"welcome"},i.default.createElement(f.WelcomeContent,{...l}),i.default.createElement(d.GuideList,{...l})))}let v=class{};v=r([(0,l.Widget)({area:s.ChatBodyConversionArea.Welcome,component:Welcome})],v),n.default=v},61274:(e,n,a)=>{"use strict";a.r(n)},61439:(e,n)=>{"use strict";var a;Object.defineProperty(n,"__esModule",{value:!0}),n.TencentModel=void 0,function(e){e.DEEPSEEK_V3="deepseek-v3-0324"}(a||(n.TencentModel=a={}))},61529:function(e,n,a){"use strict";var r,o=a(78),l=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),i=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),o=0;o<a.length;o++)"default"!==a[o]&&l(n,e,a[o]);return i(n,e),n}),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MarkdownPreMermaid=void 0;const u=c(a(73059)),d=c(a(21661)),f=s(a(48431)),m=a(25380),p=a(20421),v=a(41264),h=a(73769),g=a(12035),y=a(10971),b=a(48802);n.MarkdownPreMermaid=e=>{const{complete:n,language:a,content:r,children:l}=e,[i,s]=(0,f.useState)("code"),[c,u]=(0,f.useState)(1),[d,m]=(0,f.useState)(!1),h=(0,f.useRef)(),_=(0,f.useMemo)((()=>[{value:"code",label:f.default.createElement(g.I10nCode,null)},{value:"diagram",label:f.default.createElement(g.I10nDiagram,null)}]),[]),C=(0,f.useCallback)((e=>{n?(s(e),u(1)):s("code")}),[n]),E=(0,f.useCallback)((e=>{h.current=e}),[h]),w=(0,f.useCallback)((e=>{m(e)}),[]),O=(0,f.useCallback)((async e=>{if(h.current)if("svg"===e){const e=await(0,p.serializeBlob)(h.current.svg,b.SVG_MIME);await(0,p.getCodeBlockViewService)().downloadMermaidFile(e,"svg")}else if("png"===e)try{const e=await(0,b.getPngImageBlob)(h.current,b.PNG_MIME),n=await(0,p.toSerializeBlob)(e);await(0,p.getCodeBlockViewService)().downloadMermaidFile(n,"png")}catch(e){o.debug(e.message)}}),[h]);return(0,f.useEffect)((()=>{C("diagram")}),[C]),f.default.createElement("div",{className:"markdown-pre-container"},f.default.createElement("div",{className:"markdown-pre__header"},f.default.createElement(v.ToggleButton,{value:i,options:_,onToggled:C}),"code"===i&&n&&f.default.createElement(y.MarkdownPreCodeActions,{language:a,content:r}),"diagram"===i&&n&&!d&&f.default.createElement(MermaidActions,{onDownload:O,onZoom:u})),"code"===i&&f.default.createElement("pre",{className:"markdown-pre has-scrollbar mermaid-code"},l),"diagram"===i&&f.default.createElement(MermaidDiagram,{scale:c,content:r,renderError:d,onRendered:E,onRenderedError:w}))};const MermaidActions=e=>{const{onDownload:n,onZoom:a}=e,r=(0,f.useRef)(1),o=(0,g.useMermaidI10n)(),l=(0,f.useCallback)((()=>{r.current=Math.max(r.current-.1,.1),a(r.current)}),[]),i=(0,f.useCallback)((()=>{r.current=Math.min(r.current+.1,4),a(r.current)}),[]);return(0,f.useEffect)((()=>{a(r.current)}),[]),f.default.createElement("div",{className:"markdown-pre__mermaid-actions"},f.default.createElement("div",{className:"markdown-pre__icon-button",onClick:i,title:o.zoomIn},f.default.createElement(h.IconZoomIn,null)),f.default.createElement("div",{className:"markdown-pre__icon-button",onClick:l,title:o.zoomOut},f.default.createElement(h.IconZoomOut,null)),f.default.createElement("div",{className:"markdown-pre__divider"}),f.default.createElement("div",{className:"markdown-pre__mermaid-menu"},f.default.createElement("span",{className:"markdown-pre__mermaid-menu-placeholder"},f.default.createElement(h.IconDownload,null),f.default.createElement(g.I10nDownload,null)),f.default.createElement("ul",{className:"markdown-pre__mermaid-menu-list"},f.default.createElement("li",{className:"markdown-pre__mermaid-menu-item",onClick:()=>n("svg")},f.default.createElement(g.I10nDownloadSvg,null)),f.default.createElement("li",{className:"markdown-pre__mermaid-menu-item",onClick:()=>n("png")},f.default.createElement(g.I10nDownloadPng,null)))))},MermaidDiagram=e=>{const{scale:n,content:a,renderError:r,onRendered:o,onRenderedError:l}=e,i=(0,f.useRef)(null),s=(0,f.useRef)(),c=(0,f.useCallback)((async()=>{if(i.current)try{const e=getStyleVariables();d.default.initialize({theme:"base",startOnLoad:!1,suppressErrorRendering:!1,...e});const n=`mermaid-${Date.now()}`,{svg:r}=await d.default.render(n,a,i.current);i.current.innerHTML=r;const l=i.current.children[0];s.current=l;const{height:c,width:u}=l.viewBox.baseVal;o({svg:r,height:c,width:u})}catch(e){l(!0)}}),[i,a,s]),p=(0,f.useMemo)((()=>{const e={transform:`scale(${n})`,width:"auto"};return n>1?{transformOrigin:"top left",...e}:{transformOrigin:"top center",...e}}),[n]);return(0,f.useEffect)((()=>{c()}),[c]),(0,m.useVscodeThemeChange)((()=>{c()}),[c]),f.default.createElement("div",{className:"markdown-pre has-scrollbar mermaid-diagram"},f.default.createElement("div",{ref:i,className:(0,u.default)({"overflow-hidden":r}),style:p}),r&&f.default.createElement("div",{className:"mermaid-diagram_error-placeholder"},f.default.createElement(h.IconRenderError,null),f.default.createElement(g.I10nRenderError,null)))},getStyleVariables=()=>{const e=getComputedStyle(document.documentElement).getPropertyValue("--vscode-editor-font-family"),n={fontSize:12,fontFamily:e},a="#000",r="#fff",o=(0,p.getGlobalTheme)();return e?"dark"===o?{...n,themeVariables:{primaryColor:a,primaryTextColor:r,primaryBorderColor:r,lineColor:r,secondaryColor:a,tertiaryColor:a}}:"light"===o?{...n,themeVariables:{primaryColor:r,primaryTextColor:a,primaryBorderColor:a,lineColor:a,secondaryColor:r,tertiaryColor:r}}:n:{fontSize:12}}},62296:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThumbsUpIcon=void 0;const o=r(a(48431));n.ThumbsUpIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("g",{id:"å¾æ _16px"},o.default.createElement("path",{d:"M5 14.375H11.708C12.172 14.375 12.5751 14.0558 12.6814 13.604L14.2108 7.10404C14.3585 6.47633 13.8822 5.875 13.2374 5.875H9.5V2.625C9.5 2.07272 9.05228 1.625 8.5 1.625H7.71094C7.28528 1.625 6.90628 1.89445 6.76644 2.29648L5 7.375M5 14.375H2.5C1.94772 14.375 1.5 13.9273 1.5 13.375V8.375C1.5 7.82272 1.94772 7.375 2.5 7.375H5M5 14.375V7.375",stroke:"#808080",strokeWidth:"1.3"})))},62799:(e,n,a)=>{"use strict";a.r(n)},62855:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.FailedIcon=void 0;const o=r(a(48431));n.FailedIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:e,style:n,...a},o.default.createElement("g",{clipPath:"url(#clip0_24539_104662)"},o.default.createElement("rect",{x:"1.5",y:"1.5",width:"13",height:"13",rx:"6.5",stroke:"#FF5263",strokeWidth:"1.3"}),o.default.createElement("path",{d:"M9.88477 6.11523L6.11523 9.88477",stroke:"#FF5263",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M9.88477 9.88477L6.11523 6.11523",stroke:"#FF5263",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"})),o.default.createElement("defs",null,o.default.createElement("clipPath",{id:"clip0_24539_104662"},o.default.createElement("rect",{width:"16",height:"16",fill:"white"}))))},62860:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ChatHistoryHeader=void 0;const o=r(a(48431)),l=a(1466),i=a(71174);n.ChatHistoryHeader=({onBack:e})=>o.default.createElement("div",{className:"chat-history-header"},o.default.createElement("div",{className:"chat-history-header__content",onClick:e},o.default.createElement(l.IconLeft,{className:"chat-history__icon-back"}),o.default.createElement("span",null,o.default.createElement(i.HistoryTitle,null))))},62881:(e,n,a)=>{"use strict";a.r(n)},63066:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i};Object.defineProperty(n,"__esModule",{value:!0}),n.TencentChatOptions=void 0;const o=a(88873),l=a(15985);let i=class TencentChatOptions extends o.OpenAIChatOptions{};n.TencentChatOptions=i,n.TencentChatOptions=i=r([(0,l.Constant)(i,new i)],i)},63235:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.toast=n.closeAllToasts=void 0;const o=r(a(48431)),l=r(a(9827)),i=r(a(95819));let s,c=1;const u=new Map,calculateOffset=(e=20)=>{let n=e;return document.querySelectorAll(".craft-react-toast").forEach((e=>{n+=e.offsetHeight+16})),n};n.closeAllToasts=()=>{u.forEach(((e,n)=>{e.close()})),u.clear()};n.toast=e=>{"string"==typeof e&&(e={message:e});const n=c++,a=(s||(s=document.createElement("div"),s.className="craft-react-toast-container",document.body.appendChild(s)),s),r={...e,offset:calculateOffset(e.offset),onClose:()=>{var a;m&&(m.unmount(),d.remove()),null===(a=e.onClose)||void 0===a||a.call(e),u.delete(n)}},d=document.createElement("div");a.appendChild(d);const f=l.default.createRoot(d),m=f;f.render(o.default.createElement(i.default,r));const p={close:()=>{var e;return null===(e=r.onClose)||void 0===e?void 0:e.call(r)}};return u.set(n,p),{close:()=>(e=>{const n=u.get(e);n&&(n.close(),u.delete(e))})(n)}},n.toast.info=(e,a={})=>(0,n.toast)({...a,message:e,type:"info"}),n.toast.success=(e,a={})=>(0,n.toast)({...a,message:e,type:"success"}),n.toast.warning=(e,a={})=>(0,n.toast)({...a,message:e,type:"warning"}),n.toast.error=(e,a={})=>(0,n.toast)({...a,message:e,type:"error"}),n.default=n.toast},63239:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getPngImageBlob=n.PNG_MIME=n.SVG_MIME=void 0;const a=window.__webpack_nonce__;n.SVG_MIME="image/svg+xml;charset=utf-8",n.PNG_MIME="image/png";n.getPngImageBlob=async(e,n)=>{const a=await loadImage(e),r=window.devicePixelRatio||1,o=document.createElement("canvas");o.width=a.width*r,o.height=a.height*r;const l=o.getContext("2d");return l?(l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high",l.drawImage(a,0,0),new Promise(((e,a)=>{o.toBlob((n=>{n?e(n):a(new Error("canvas toBlob return null"))}),n,1)}))):Promise.reject(new Error("canvas context is null"))};const loadImage=async e=>{const n=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(e.svg)}`;try{const r=new Image;r.height=e.height,r.width=e.width,r.nonce=a;const o=new Promise(((e,n)=>{r.onload=e,r.onerror=n}));return r.src=n,await o,r}catch(e){return Promise.reject(new Error(`load image, ${e.message}`))}finally{URL.revokeObjectURL(n)}}},63306:(e,n)=>{"use strict";var a,r,o,l,i,s,c,u;Object.defineProperty(n,"__esModule",{value:!0}),n.CONVERSATION_REQUEST_ID_STORAGE_KEY=n.ChatFooterArea=n.ChatFindBugArea=n.ChatBodyConversionInputArea=n.ChatBodyConversionMessageArea=n.ChatBodyConversionArea=n.ChatBodyArea=n.ChatHeaderArea=n.ChatArea=void 0,function(e){e.Layout="chat.layout",e.Header="chat.header",e.Body="chat.body",e.Footer="chat.footer"}(a||(n.ChatArea=a={})),function(e){e.Toolbar="chat.header.toolbar"}(r||(n.ChatHeaderArea=r={})),function(e){e.Conversion="chat.body.conversion",e.FindBug="chat.body.findBug"}(o||(n.ChatBodyArea=o={})),function(e){e.Messages="chat.body.conversion.messages",e.Welcome="chat.body.conversion.welcome",e.Input="chat.body.conversion.input",e.CompatibilityShim="chat.body.conversion.compatibility.shim"}(l||(n.ChatBodyConversionArea=l={})),function(e){e.Avatar="chat.body.conversion.messages.message.avatar",e.Content="chat.body.conversion.messages.message.content",e.Followup="chat.body.conversion.messages.message.followup",e.Tools="chat.body.conversion.messages.message.tools",e.FeedBack="chat.body.conversion.messages.message.feedback"}(i||(n.ChatBodyConversionMessageArea=i={})),function(e){e.Selection="chat.body.conversion.input.selection",e.Buttons="chat.body.conversion.input.buttons"}(s||(n.ChatBodyConversionInputArea=s={})),c||(n.ChatFindBugArea=c={}),u||(n.ChatFooterArea=u={}),n.CONVERSATION_REQUEST_ID_STORAGE_KEY="tencent:cloud:genie:conversation-request-id"},63368:(e,n)=>{"use strict";function checkCommandSafety(e){if(!e)return{isSafe:!0,requiresApproval:!1};const a=e.trim().split(/\s+/)[0],r=n.SAFE_COMMAND_WHITELIST.includes(a);let o;for(const a of n.DANGEROUS_COMMAND_PATTERNS)if(a.test(e)){o=a;break}return r&&!o?{isSafe:!0,requiresApproval:!1}:o?{isSafe:!1,requiresApproval:!0,reason:"检测到命令可能存在风险，请谨慎操作"}:{isSafe:!0,requiresApproval:!0,reason:"检测到命令可能存在风险，请谨慎操作"}}Object.defineProperty(n,"__esModule",{value:!0}),n.DANGEROUS_COMMAND_PATTERNS=n.SAFE_COMMAND_WHITELIST=void 0,n.checkCommandSafety=checkCommandSafety,n.getCommandRiskInfo=function getCommandRiskInfo(e){const n=checkCommandSafety(e);if(!n.requiresApproval)return{emoji:"",tooltip:""};return n.isSafe,{emoji:"⚠️",tooltip:n.reason||"检测到命令可能存在风险，请谨慎操作"}},n.SAFE_COMMAND_WHITELIST=["ls","dir","pwd","cd","echo","cat","more","less","head","tail","grep","find","cp","mv","mkdir","rmdir","touch","chmod","chown","df","du","ps","top","kill","npm","node","git","python","pip","java","javac","mvn","gradle","docker","kubectl","terraform","ansible"],n.DANGEROUS_COMMAND_PATTERNS=[/find\s+.*-exec\s+(bash|sh|python[0-9]*|perl|ruby|php|node|java)\s/,/find\s+.*-exec\s+.*-c\s/,/find\s+\.\.\/.*-exec/,/bash\s+-c/,/sh\s+-c/,/python[0-9]*\s+-c/,/perl\s+-e/,/ruby\s+-e/,/php\s+-r/,/node\s+-e/,/curl.*http:\/\//,/wget.*http:\/\//,/nc\s+-l/,/ncat/,/telnet/,/eval\s*\(/,/exec\s*\(/,/system\s*\(/,/rm\s+(-rf?|--recursive|--force)/,/dd/,/mkfs/,/fdisk/,/sudo/,/su\s/,/chmod\s+777/,/>(\/etc|\/dev|\/sys|\/proc)/,/\|\s*(bash|sh)/,/\$\([^)]*\)/,/`[^`]*`/,/find\s+.*-exec\s+[^;]*import[^;]*;/,/find\s+.*-exec\s+[^;]*open\([^)]*,'w'/,/find\s+.*-exec\s+[^;]*system\(/,/find\s+.*-exec\s+[^;]*makedirs\(/,/find\s+.*-exec\s+[^;]*base64\./,/__import__\s*\(/,/eval\s*\([^)]*input/,/exec\s*\([^)]*input/]},63457:(e,n,a)=>{"use strict";a.r(n)},63565:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ToolUtils=void 0;const o=a(69022),l=r(a(54629));n.ToolUtils=class ToolUtils{static getRelativeFilePath(e,n){let a=this.normalizePath(e);const r=this.normalizePath(n);return a.startsWith(r)&&(a=a.replace(r,""),a.startsWith("/"))?a.substring(1):a}static normalizePath(e){return e?(0,l.default)(e):""}static isToolCallPending(e){return[o.ToolStatus.PENDING,o.ToolStatus.PARSING,o.ToolStatus.IDLE].includes(e)}static isToolCallRunning(e){return this.isToolCallPending(e)||this.isToolCallExecuting(e)}static isToolCallExecutable(e){return!this.isToolCallEnd(e)&&!this.isToolCallExecuting(e)}static isToolCallEnd(e){return[o.ToolStatus.EXECUTED,o.ToolStatus.FAILED,o.ToolStatus.CANCELLED,o.ToolStatus.SKIPPED].includes(e)}static isToolCallExecuting(e){return[o.ToolStatus.STREAM_EXECUTING,o.ToolStatus.FULL_EXECUTING].includes(e)}}},63913:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconDownload=void 0;const o=r(a(48431));n.IconDownload=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M13 7.7V5L10.1875 2H3.625C3.27982 2 3 2.26863 3 2.6V13.4C3 13.7314 3.27982 14 3.625 14H7.375",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M9.4165 2V5.00011H12.9999",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M11.2085 9.5V14",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M11.209 14L9.31982 12.1108",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M11.209 14L13.0981 12.1108",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},63958:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.DeleteIcon=void 0;const o=r(a(48431));n.DeleteIcon=({width:e=16,height:n=16})=>o.default.createElement("svg",{width:e,height:n,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M3.625 3.91699V13.8337H12.375V3.91699H3.625Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M6.83398 6.83301V10.6247",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M9.16602 6.83301V10.6247",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M2.16602 3.91699H13.8327",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M5.66602 3.91667L6.62531 1.5H9.39267L10.3327 3.91667H5.66602Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinejoin:"round"}))},64187:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.UserMessagePathCollectorHoc=n.ToolCallPathCollectorHoc=n.HighlightCodeContext=n.useHighlightCodeContext=void 0;const s=a(69022),c=i(a(48431)),u=a(91015),d=a(20421),f=(0,c.createContext)({});n.useHighlightCodeContext=()=>(0,c.useContext)(f);n.HighlightCodeContext=({children:e})=>{const n=(0,c.useRef)({}),a=(0,c.useRef)({}),r=(0,c.useRef)({}),o=(0,c.useCallback)(((e,n)=>{if(r.current[e]){const a=r.current[e];r.current[e]=new Set([...a,...n])}else r.current[e]=new Set(n)}),[]),l=(0,c.useCallback)((async(e,o)=>{var l;n.current[e]||(n.current[e]={});const i=n.current[e];a.current[e]||(a.current[e]={});const s=a.current[e];if(i[o])return i[o];if(s[o])return s[o];const c=Array.from(null!==(l=r.current[e])&&void 0!==l?l:[]),u=(0,d.getCodeBlockViewService)().resolveCode(e,o,c);s[o]=u;const f=await u;return i[o]=f,f}),[]),i=(0,c.useCallback)(((e,a)=>{if(!e)return;const r=n.current[e];return r?r[a]:void 0}),[]);(0,c.useEffect)((()=>()=>(0,d.getCodeBlockViewService)().cleanCodeFinderCache()),[]);const s=(0,c.useMemo)((()=>({mergePaths:o,resolveCode:l,hasResolvedCode:i})),[o,l,i]);return c.default.createElement(f.Provider,{value:s},e)};n.ToolCallPathCollectorHoc=e=>{const{children:a,status:r,paths:o}=e,{mergePaths:l}=(0,n.useHighlightCodeContext)(),{requestId:i}=(0,c.useContext)(u.CurrentToolContext);return(0,c.useEffect)((()=>{r===s.ToolStatus.EXECUTED&&i&&l(i,o)}),[r]),a};n.UserMessagePathCollectorHoc=e=>{const{children:a,requestId:r,references:o}=e,{mergePaths:l}=(0,n.useHighlightCodeContext)();return(0,c.useEffect)((()=>{const e=o.filter((e=>e.name===s.ReferenceNames.File)).map((e=>{var n,a;return null!==(a=null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.filepath)&&void 0!==a?a:void 0})).filter((e=>!!e));l(r,e)}),[o]),a}},64804:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ChatHistoryView=void 0,a(51562);const l=a(84176),i=o(a(48431)),s=a(15389),c=a(62860),u=a(46921),d=a(59141),f=a(71174),m=a(25380),p=a(20421);n.ChatHistoryView=()=>{(0,m.useActivePage)(),(0,m.useWebviewStatus)();const e=(0,m.useLogger)(p.LOG_CHAT_HISTORY),n=(0,s.useNavigate)(),{data:a,current:r,loadData:o}=(0,u.useGetConversations)();return i.default.createElement("div",{className:"chat-history-container"},i.default.createElement(c.ChatHistoryHeader,{onBack:()=>n("/")}),0===a.length?i.default.createElement("div",{className:"chat-history-empty"},i.default.createElement(f.HistoryEmpty,null)):i.default.createElement(d.ChatHistoryList,{conversations:a,currentConversation:r,onSelectConversation:async a=>{await(0,p.getConversationViewService)().setCurrentConversation(a),e.info(`select conversation ${a}.`),n("/")},onNameChanged:async({id:n,name:a})=>{await(0,p.getConversationViewService)().renameConversation(n,a.trim()),e.info(`rename conversation ${n} to ${a}.`),await o()},exportConversation:async({id:n})=>{await(0,p.getConversationViewService)().exportConversation(n),e.info(`export conversation ${n}.`)},onDelete:async({id:n})=>{await(0,p.getConversationViewService)().deleteConversation(n),e.info(`delete conversation ${n}.`),await o()}}))};let v=class{};v=r([(0,l.View)({path:"/history",component:n.ChatHistoryView})],v),n.default=v},64900:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(46141),n),o(a(85300),n),o(a(26401),n),o(a(78517),n),o(a(36874),n),o(a(91020),n),o(a(26401),n),o(a(78517),n),o(a(11037),n),o(a(84164),n),o(a(51059),n),o(a(41264),n),o(a(6044),n),o(a(49262),n)},64921:(e,n,a)=>{"use strict";a.r(n)},65492:(e,n,a)=>{"use strict";a.r(n)},65611:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),a(25794),o(a(92930),n),o(a(63306),n),o(a(71912),n),o(a(51595),n),o(a(64804),n),o(a(85592),n),o(a(34420),n),o(a(58509),n),o(a(51496),n),o(a(87345),n),o(a(57035),n),o(a(36733),n),o(a(1418),n),o(a(57035),n),o(a(52735),n)},66128:(e,n,a)=>{"use strict";a.r(n)},66319:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Avatar=void 0,a(72113);const s=i(a(48431)),c=a(32134);n.Avatar=s.default.memo((e=>{const{conversationState:{conversation:n}}=(0,s.useContext)(c.ConversationContext),a=(0,s.useMemo)((()=>(null==n?void 0:n.assistantName)||e.assistantName||"CodeBuddy"),[null==n?void 0:n.assistantName,e.assistantName]);return s.default.createElement("div",{className:"avatar"},s.default.createElement("img",{className:"copilot-avatar-icon only-dark",src:"./assets/image/copilot-avatar-dark.png"}),s.default.createElement("img",{className:"copilot-avatar-icon only-light",src:"./assets/image/copilot-avatar-light.png"}),s.default.createElement("span",{className:"username"},a),(null==n?void 0:n.pluginVersion)&&s.default.createElement("span",{className:"version"},"v",n.pluginVersion))}))},66870:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i};Object.defineProperty(n,"__esModule",{value:!0}),n.TencentEmbeddingOptions=void 0;const o=a(88873),l=a(15985);let i=class TencentEmbeddingOptions extends o.OpenAIEmbeddingOptions{};n.TencentEmbeddingOptions=i,n.TencentEmbeddingOptions=i=r([(0,l.Constant)(i,new i)],i)},66952:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(75645),n),o(a(91722),n),o(a(78388),n),o(a(85638),n),o(a(52450),n)},67287:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(96632),n)},67413:(e,n,a)=>{"use strict";a.r(n)},67415:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(23166),n)},67633:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Switch=void 0,a(78559);const c=s(a(73059)),u=i(a(48431));n.Switch=({modelValue:e=!1,disabled:n=!1,loading:a=!1,size:r="default",className:o,style:l,onChange:i})=>{const[s,d]=(0,u.useState)(e),f="code-buddy-switch";(0,u.useEffect)((()=>{d(e)}),[e]);const m=(0,c.default)(f,{[`${f}-checked`]:s,[`${f}-disabled`]:n,[`${f}-loading`]:a,[`${f}-small`]:"small"===r},o);return u.default.createElement("button",{type:"button",role:"switch","aria-checked":s,className:m,style:l,onClick:()=>{if(n||a)return;const e=!s;d(e),null==i||i(e)},disabled:n||a},u.default.createElement("div",{className:`${f}-handle`},a&&u.default.createElement("span",{className:`${f}-loading-icon`},u.default.createElement("i",{className:`${f}-loading-icon-spin`}))))}},68505:(e,n,a)=>{"use strict";a.r(n)},69045:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.UnknownToolRenderer=void 0;const l=a(15985),i=a(69022),s=o(a(48431)),c=a(87783),u=a(42810);let d=class UnknownToolRenderer{constructor(){this.className="unknown-tool",this.clickHeader=!1,this.statusTextMap={DEFAULT:{[i.ToolStatus.EXECUTED]:"Execution successful",[i.ToolStatus.FAILED]:"Execution failed"}}}canHandle(e){return u.ChatToolRendererPriority.DEFAULT}renderTitle(e){var n,a;return s.default.createElement("span",{className:["title",e.status!==i.ToolStatus.EXECUTED?"disabled":""].join(" ")},"Called Tool: ",null===(a=null===(n=e.name)||void 0===n?void 0:n.split("_").map((e=>{var n;return(null===(n=null==e?void 0:e[0])||void 0===n?void 0:n.toUpperCase())+(null==e?void 0:e.slice(1))})))||void 0===a?void 0:a.join(""))}renderControl(e){return s.default.createElement(c.StatusText,{statusTextMap:this.statusTextMap,toolStatus:e.status})}};n.UnknownToolRenderer=d,n.UnknownToolRenderer=d=r([(0,l.Component)(u.ChatToolRenderer)],d)},69083:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.ChatDropdown=function ChatDropdown(e){const{children:n}=e;return c.createElement(s.DropdownMenu.Root,null,c.createElement(s.DropdownMenu.Trigger,null,c.createElement("span",{className:"cursor-pointer"},n)),c.createElement(s.DropdownMenu.Content,{className:"chat-dropdown-menu-content dropdown-menu-content"},e.items.map((e=>c.createElement(s.DropdownMenu.Item,{className:"chat-dropdown-menu-item cursor-pointer",key:e.value,disabled:e.disabled,onClick:()=>e.onClick(e)},e.label)))))},a(44181);const s=a(60139),c=i(a(48431))},69103:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CodeCompletionResponse=n.Generation=n.ModelManager=n.CodeCompletionModel=void 0;const r=a(76503);var o,l;n.CodeCompletionModel=Symbol("CodeCompletionModel"),n.ModelManager=Symbol("ModelManager"),function(e){e.from=function from(e,n=r.CodeCompletionGenerationMetadata.from()){return{output:e,metadata:n}}}(o||(n.Generation=o={})),function(e){e.from=function from(e,n=r.CodeCompletionResponseMetadata.createEmpty()){return{result:e[0],results:e,metadata:n}}}(l||(n.CodeCompletionResponse=l={}))},69185:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ListFileRenderer=void 0;const i=a(15985),s=a(69022),c=a(19606),u=l(a(48431)),d=a(99095),f=a(73671),m=a(87783),p=a(39941),v=a(42810),h=a(63565);let g=class ListFileRenderer{constructor(){this.className="list-file",this.clickHeader=!0,this.resultVisible=!1,this.t=(e,n)=>e}canHandle(e){return e.name===s.ToolNames.LIST_FILES?v.ChatToolRendererPriority.EXACT:v.ChatToolRendererPriority.NONE}renderTitle(e,n){var a;const r=h.ToolUtils.getRelativeFilePath((null===(a=null==e?void 0:e.args)||void 0===a?void 0:a.filePath)||"",n),o=this.getFilePaths(e).map((e=>"string"==typeof e?e:e.filePath));return u.default.createElement(d.ToolCallPathCollectorHoc,{status:e.status,paths:o},u.default.createElement("span",{className:["title",e.status!==s.ToolStatus.EXECUTED?"disabled":""].join(" "),title:r},u.default.createElement(c.FormattedMessage,{id:'Read the "{key}" file list',values:{key:"."===r||""===r||"/"===r?this.t("Root Directory"):r}})),e.status===s.ToolStatus.EXECUTED&&u.default.createElement("span",{className:"file-num"},u.default.createElement(c.FormattedMessage,{id:"{num} files",values:{value:o.length}})))}renderControl(e){const n={DEFAULT:{[s.ToolStatus.IDLE]:"Currently Reading",[s.ToolStatus.PENDING]:"Currently Reading",[s.ToolStatus.PARSING]:"Currently Reading",[s.ToolStatus.STREAM_EXECUTING]:"Currently Reading",[s.ToolStatus.FULL_EXECUTING]:"Currently Reading",[s.ToolStatus.EXECUTED]:"Completed",[s.ToolStatus.FAILED]:"Read failed"}};return u.default.createElement(m.StatusText,{statusTextMap:n,toolStatus:e.status})}renderResult(e){const n=this.getFilePaths(e);return u.default.createElement("div",{className:"container"},e.status!==s.ToolStatus.EXECUTED?u.default.createElement("span",{className:"content-item"},this.t("Reading Files"),u.default.createElement(f.LoadingDots,null)):n.length?n.map((n=>this.renderFileItem(n,e))):u.default.createElement("span",{className:"content-item"},this.t("No Content Available")))}renderFileItem(e,n){"string"==typeof e&&(e={filePath:e,size:"",modifyTime:""});const{filePath:a,size:r,modifyTime:o}=e,openFile=e=>{var a;(e=>e.endsWith("/"))(e)||this.chatViewService.openRelativeFileWithRange((null===(a=null==n?void 0:n.args)||void 0===a?void 0:a.filePath)||"",e,[])};return u.default.createElement("div",{key:a,className:"content-item"},u.default.createElement("span",{className:"file-path-clickable",onClick:()=>openFile(a),title:a},u.default.createElement("span",{className:"line-file-icon"},a.endsWith("/")?u.default.createElement(c.Icon,{name:c.SvgIconName.FolderIcon}):u.default.createElement(c.Icon,{name:a,type:c.IconType.VSCODE})),u.default.createElement("span",{className:"line-file-name truncate"},a),o&&u.default.createElement("span",{className:"line-file-mtime"},o),r&&u.default.createElement("span",{className:"line-file-size"},r)))}renderIcon(e,n){return u.default.createElement(p.ArrowIcon,{className:n?"":"arrow-left"})}getFilePaths(e){var n,a,r;return(null===(n=null==e?void 0:e.result)||void 0===n?void 0:n.success)&&(null===(r=null===(a=null==e?void 0:e.result)||void 0===a?void 0:a.result)||void 0===r?void 0:r.files)?e.result.result.files:[]}};n.ListFileRenderer=g,r([(0,i.Autowired)(s.ChatViewService),o("design:type",Object)],g.prototype,"chatViewService",void 0),n.ListFileRenderer=g=r([(0,i.Component)({id:v.ChatToolRenderer,scope:i.Scope.Transient})],g)},69405:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.welcomeCopywriterMap=void 0;const r=a(96593),o={[r.WelcomeMode.ASK]:{title:"Ask with Chat",describe:"Codebase understanding, technical answers and efficient solution to coding problems",guideList:[{title:"Technical FAQ",describe:"How to revert to specific commit ID in Git",options:{isPlan:!1}},{title:"Knowledge base call",describe:"What is the difference between functional components and class components in React",options:{isPlan:!1}},{title:"Codebase Q&A",describe:"Analyze and install the environment and run the project in conjunction with the current project",options:{isPlan:!1,codebase:!0}}]},[r.WelcomeMode.CRAFT]:{title:"Build with Craft",describe:"Demand analysis, plan sub-task, and then application generation from 0 to 1",guideList:{[r.WorkspaceStatus.HAS]:[{title:"Engineering architecture documentation",describe:"Generate a complete architecture document arch.md for the project",options:{isPlan:!1}},{title:"Explain codebase",describe:"Explain core code logic for the current project",options:{isPlan:!1}},{title:"Start running the current project",describe:"According to the current project, analyze and install the environment and run project",options:{isPlan:!1}}],[r.WorkspaceStatus.NOT]:[{title:"Generate an application and start `Generating Plan`",describe:"Create a Todo project website application",options:{isPlan:!0,workspace:"todoapp-craft-demo"}},{title:"Generate a local application",describe:"Create a cool calculator local application based on Python, with key sounds",options:{isPlan:!0,workspace:"calculator-mini-program"}},{title:"Generate a mini game",describe:"Create a Tetris web game",options:{isPlan:!0,workspace:"tetris-web-game"}}]}}},l={[r.WelcomeMode.ASK]:{title:"Ask with Chat",describe:"Codebase understanding, technical answers and efficient solution to coding problems",guideList:[{title:"Technical FAQ",describe:"How to revert to specific commit ID in Git",options:{isPlan:!1}},{title:"Knowledge base call",describe:"What is the difference between functional components and class components in React",options:{isPlan:!1}},{title:"Codebase Q&A",describe:"Analyze and install the environment and run the project in conjunction with the current project",options:{isPlan:!1,codebase:!0}}]},[r.WelcomeMode.CRAFT]:{title:"Build with Craft",describe:"Demand analysis, plan sub-task, and then application generation from 0 to 1",guideList:[{title:"Engineering architecture documentation",describe:"Generate a complete architecture document arch.md for the project",options:{isPlan:!1}},{title:"Explain codebase",describe:"Explain core code logic for the current project",options:{isPlan:!1}},{title:"Start running the current project",describe:"According to the current project, analyze and install the environment and run project",options:{isPlan:!1}}]}},i={[r.WelcomeMode.ASK]:{title:"Ask with Chat",describe:"Codebase understanding, technical answers and efficient solution to coding problems",guideList:[{title:"WeChat Mini Program Development Suggestions",describe:"Suggested steps and examples for Mini Program Development",options:{isPlan:!1}},{title:"Explain codebase",describe:"Through project analysis, interpret the core code logic of the current Mini Program",options:{isPlan:!1}},{title:"Diagnose project projects",describe:"Through project analysis, diagnose code problems and give review suggestions",options:{isPlan:!1}}]},[r.WelcomeMode.CRAFT]:{title:"Build with Craft",describe:"Demand analysis, plan sub-task, and then application generation from 0 to 1",guideList:{[r.WorkspaceStatus.HAS]:[{title:"Mini Program Documentation",describe:"Through project analysis, summarize into Markdown documents",options:{isPlan:!1}},{title:"Rewrite the Mini Program page",describe:"In the current project, rewrite the current Mini Program page",options:{isPlan:!1}},{title:"Explain codebase",describe:"Through project analysis, interpret the core code logic of the current Mini Program",options:{isPlan:!1}}],[r.WorkspaceStatus.SC]:[{title:"Generate an accounting applet",describe:"Create a daily accounting WeChat applet with weekly and monthly accounting statistics",options:{isPlan:!1}},{title:"Generate a calculator applet",describe:"Create a cool calculator WeChat applet with key sounds",options:{isPlan:!1}},{title:"Generate a daily to-do applet",describe:"Create a Todo personal to-do WeChat applet",options:{isPlan:!1}}]}}};n.welcomeCopywriterMap={[r.PlatformType.VSCODE]:o,[r.PlatformType.JB]:l,[r.PlatformType.WEIXIN]:i}},69865:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AegisWebviewInitializer=void 0,n.AegisWebviewInitializer=Symbol("AegisWebviewInitializer")},70231:(e,n,a)=>{"use strict";a.r(n)},70291:(e,n,a)=>{"use strict";var r=a(78);Object.defineProperty(n,"__esModule",{value:!0}),n.useCopy=void 0;const o=a(48431);n.useCopy=e=>{const[n,a]=(0,o.useState)(!1);return{copied:n,onCopy:(0,o.useCallback)((async()=>{await copyContent(e),a(!0),await wait(3e3),a(!1)}),[])}};const wait=e=>new Promise((n=>setTimeout(n,e))),copyContent=async e=>{try{return await navigator.clipboard.writeText(e),!0}catch(e){r.log("Clipboard API failed:",e)}try{const n=document.createElement("textarea");n.value=e,n.setAttribute("readonly",""),n.style.position="fixed",n.style.top="0",n.style.left="-9999px",n.style.opacity="0",n.style.pointerEvents="none",document.body.appendChild(n),n.focus(),n.select();const a=document.execCommand("copy");if(document.body.removeChild(n),a)return!0}catch(e){r.log("Fallback textarea copy failed:",e)}return!1}},70605:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(23674),n),o(a(60983),n),o(a(50836),n),o(a(63958),n),o(a(60448),n),o(a(21384),n),o(a(19713),n),o(a(29530),n),o(a(55225),n),o(a(95595),n),o(a(51943),n),o(a(97959),n)},70710:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.McpInstalledCard=void 0,a(34244);const c=s(a(73059)),u=i(a(48431)),d=a(64900),f=a(25380),m=a(19600),p=a(70605),v=a(49147),h=a(20815),g=a(95973);n.McpInstalledCard=e=>{var n,a;const{data:r,onEdit:o,onReconnect:l,onToggleServer:i,onDelete:s,onTryToRun:y,onCopy:b,onOpenExternal:_}=e,C=(0,h.useInstalledCardL10n)(),{state:E,toggle:w}=(0,f.useToggle)(!1),[O,M]=(0,u.useState)(!1),S=null!==(n=r.tools)&&void 0!==n?n:[],P=!r.error,T=(0,u.useCallback)((()=>{r.official_url&&_(r.official_url)}),[r]),j=(0,u.useCallback)((()=>{_(h.troubleshootingUrl)}),[]),k=(0,u.useCallback)((()=>{r.error&&b(r.error)}),[r]),I=(0,u.useCallback)((async()=>{try{M(!0),await l(r)}finally{M(!1)}}),[r]);return u.default.createElement("div",{className:"mcp-installed-card"},u.default.createElement("div",{className:"mcp-installed-card__header"},u.default.createElement("div",{className:"mcp-installed-card__header-left"},u.default.createElement(p.RightArrowIcon,{className:(0,c.default)("mcp-installed-card__expand-icon shrink-0",{expand:E}),onClick:w}),r.logo_url&&u.default.createElement("div",{className:"shrink-0"},u.default.createElement(m.Avatar,{src:r.logo_url})),u.default.createElement("div",{className:"overflow-hidden ml-4"},u.default.createElement("div",{className:"flex-align-items-center gap-4"},u.default.createElement("div",{className:"overflow-hidden",onClick:T},u.default.createElement("div",{title:r.name,className:(0,c.default)("mcp-installed-card__title","truncate",{"no-hover":!r.official_url})},r.name)),u.default.createElement("div",{className:(0,c.default)("mcp-installed__status shrink-0",r.status)})),u.default.createElement("div",{className:"mcp-installed-card-title__description truncate"},`${S.length} tools`))),u.default.createElement("div",{className:"mcp-installed-card__header-right gap-4"},P&&u.default.createElement(d.IconButton,{className:"mcp-installed-card__icon-button",title:C.tryToRun,onClick:()=>y(r)},u.default.createElement(p.PlayIcon,null)),(null===(a=null==r?void 0:r.install_commands)||void 0===a?void 0:a.env)&&u.default.createElement(d.IconButton,{className:"mcp-installed-card__icon-button",title:C.edit,onClick:()=>o(r)},u.default.createElement(p.EditorIcon,null)),u.default.createElement(d.IconButton,{className:"mcp-installed-card__icon-button",title:C.reconnect,onClick:I,disabled:O},u.default.createElement(p.RefreshIcon,{className:(0,c.default)({"infinite-spin":O})})),u.default.createElement(d.IconButton,{className:"mcp-installed-card__icon-button",title:C.delete,onClick:()=>s(r)},u.default.createElement(p.DeleteIcon,null)),u.default.createElement(g.Switch,{className:"ml-4",size:"small",modelValue:!r.disabled,disabled:O,onChange:e=>i(r.name,e)}))),P?u.default.createElement("ul",{className:(0,c.default)("mcp-installed-card__list",{expand:E})},S.map(((e,n)=>{var a;return u.default.createElement("li",{className:"mcp-installed-card__list-item",key:n},u.default.createElement("span",{className:"shrink-0"},e.name),u.default.createElement("span",{title:null==e?void 0:e.description,className:"mcp-installed-card__list-description truncate"},null!==(a=null==e?void 0:e.description)&&void 0!==a?a:""))}))):u.default.createElement("div",{className:"mcp-installed-card__error"},u.default.createElement("div",{className:"mcp-installed-card__error-box"},r.error),u.default.createElement("div",{className:"flex-align-items-center gap-8"},u.default.createElement(d.IconTextButton,{className:"mcp-installed-card__icon-button",icon:u.default.createElement(v.LinkIcon,null),text:C.troubleshooting,onClick:j}),u.default.createElement(d.IconTextButton,{className:"mcp-installed-card__icon-button",icon:u.default.createElement(p.CopyIcon,null),text:C.copy,onClick:k}))))}},70719:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconCloseSmall=void 0;const o=r(a(48431));n.IconCloseSmall=()=>o.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("path",{d:"M9.375 2.625L2.625 9.375",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M9.375 9.375L2.625 2.625",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}))},70871:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.JsonUtils=void 0;n.JsonUtils=class JsonUtils{static safeParse(...e){try{return JSON.parse(...e)}catch(e){}}static safeStringify(...e){try{return JSON.stringify(...e)}catch(e){}}}},71174:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.TimeDays=n.TimeHours=n.TimeMinutes=n.TimeJustNow=n.CurrentConversation=n.DialogCancel=n.DialogConfirm=n.DialogContent=n.DialogTitle=n.HistoryEmpty=n.HistoryTitle=void 0;const o=a(19606),l=r(a(48431));n.HistoryTitle=()=>l.default.createElement(o.FormattedMessage,{id:"Conversation history"});n.HistoryEmpty=()=>l.default.createElement(o.FormattedMessage,{id:"No historical records"});n.DialogTitle=()=>l.default.createElement(o.FormattedMessage,{id:"Delete Conversation"});n.DialogContent=()=>l.default.createElement(o.FormattedMessage,{id:"Once deleted, the conversation history cannot be recovered. Please operate with caution!"});n.DialogConfirm=()=>l.default.createElement(o.FormattedMessage,{id:"Confirm"});n.DialogCancel=()=>l.default.createElement(o.FormattedMessage,{id:"Cancel"});n.CurrentConversation=()=>l.default.createElement(o.FormattedMessage,{id:"current conversation"});n.TimeJustNow=()=>l.default.createElement(o.FormattedMessage,{id:"Just now"});n.TimeMinutes=({value:e})=>l.default.createElement(o.FormattedMessage,{id:"Minutes ago",values:{value:e}});n.TimeHours=({value:e})=>l.default.createElement(o.FormattedMessage,{id:"Hours ago",values:{value:e}});n.TimeDays=({value:e})=>l.default.createElement(o.FormattedMessage,{id:"Days ago",values:{value:e}})},71732:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.TerminalIcon=void 0;const o=r(a(48431));n.TerminalIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:e,style:n,...a},o.default.createElement("rect",{x:"1.5",y:"3",width:"13",height:"10",rx:"1",stroke:"currentColor",strokeWidth:"1.3"}),o.default.createElement("path",{d:"M4 6L5.29289 7.29289C5.68342 7.68342 5.68342 8.31658 5.29289 8.70711L4 10",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),o.default.createElement("path",{d:"M8 10L12 10",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}))},71912:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Chat=Chat,a(51062),a(9213);const c=a(84176),u=a(19606),d=a(60139),f=s(a(48431)),m=a(63306),p=a(99095),v=a(25380);function Chat(e){(0,v.useActivePage)();const[n]=(0,u.useTheme)();return f.createElement(f.Fragment,null,f.createElement(d.Theme,{appearance:n},f.createElement(p.GlobalContextWrapper,null,f.createElement(c.Slot,{area:m.ChatArea.Layout}))))}let h=class{};h=i([(0,c.View)({index:!0,component:Chat})],h),n.default=h},72113:(e,n,a)=>{"use strict";a.r(n)},72956:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.WelcomeContent=function WelcomeContent(e){return o.default.createElement("div",{className:"welcome-content"},o.default.createElement(l.WelcomeIcon,{isAsk:e.isAsk}),o.default.createElement("div",{className:"welcome-content_title",title:e.title},e.title),o.default.createElement("div",{className:"welcome-content_describe",title:e.describe},e.describe))};const o=r(a(48431)),l=a(45176)},73e3:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(55681),n)},73257:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),a(86595);const s=a(19606),c=i(a(48431)),u=a(20993);n.default=()=>{const e=(0,s.useIntl)(),translations=(n,a)=>e.formatMessage({id:n},a),n=c.useMemo((()=>translations("Tencent Cloud Developer Community MCP Plaza")),[translations]),a=c.useMemo((()=>translations("The above MCP Server is provided by {source}",{source:n})),[]);return c.createElement("div",{className:"mcp-market-footer"},c.createElement("div",{className:"mcp-market-footer-desc"},c.createElement(u.WithLink,{sourceString:n,text:a,linkUrl:"https://cloud.tencent.com/developer/mcp?from=28174&from_column=28174"})))}},73491:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),c=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.WriteToFileRenderer=void 0,a(18365);const d=a(15985),f=a(51662),m=a(76243),p=a(69022),v=a(19606),h=s(a(48431)),g=a(50473),y=a(64900),b=a(99095),_=a(32134),C=a(25380),E=u(a(6949)),w=a(4882),O=a(50759),M=a(86285),S=a(75831),P=a(87783),T=a(54540),j=a(39941),k=a(46506),I=a(89317),N=a(91015),x=a(42810),D=a(63565);let R=class WriteToFileRenderer{constructor(){this.className="write-to-file",this.clickHeader=!0}canHandle(e){return e.name===p.ToolNames.WRITE_TO_FILE||e.name===p.ToolNames.REPLACE_IN_FILE||e.name===p.ToolNames.APPEND_TO_FILE?x.ChatToolRendererPriority.EXACT:x.ChatToolRendererPriority.NONE}clickCardHeader(e){this.openFile(e)}renderTitle(e,n){return h.default.createElement(RenderTitle,{tool:e,workspace:n})}renderControl(e,n){return h.default.createElement(WriteFileToolControl,{tool:e,config:n})}renderButtons(e,n){return h.default.createElement(F,{tool:e,config:n})}renderIcon(e){return e.args.filePath?h.default.createElement(v.Icon,{type:v.IconType.VSCODE,name:e.args.filePath}):h.default.createElement(k.CodeIcon,null)}openFile(e){var n;(null===(n=null==e?void 0:e.args)||void 0===n?void 0:n.filePath)&&this.chatViewService.openFile(e.args.filePath)}};n.WriteToFileRenderer=R,i([(0,d.Autowired)(p.ChatViewService),c("design:type",Object)],R.prototype,"chatViewService",void 0),n.WriteToFileRenderer=R=i([(0,d.Component)(x.ChatToolRenderer)],R);const L=new Set([]),A=new Set([]),F=(0,h.memo)((e=>{const n=d.ContainerUtil.get(p.FileTreeViewService),a=d.ContainerUtil.get(m.ToolViewService),{tool:r,config:o}=e,{status:l}=r,i=(0,h.useContext)(b.GlobalContext),s=(0,h.useContext)(_.ConversationIdContext),{setToolStatus:c}=(0,h.useContext)(N.CurrentToolContext),[u,f]=(0,h.useState)(!1),C=(0,v.useIntl)(),t=e=>C.formatMessage({id:e}),w=d.ContainerUtil.get(g.ChatModeController),O=[{label:t("Ask Each Time"),value:"false",onClick:()=>{}},{label:t("Automatically Modify Files"),value:"true",onClick:()=>S()}],M=O[0].label,S=(0,h.useCallback)((async()=>{const e=await w.getChatModeSettings()||{};await w.updateChatModeSettings({...e,craft:{...e.craft||{},autoModifyFile:!0}}),executeTool()}),[i]),executeTool=async()=>{a.execute(r.id,s),null==c||c(p.ToolStatus.STREAM_EXECUTING),f(!1),A.add(r.id)};return(0,h.useEffect)((()=>{var e;const n=D.ToolUtils.isToolCallPending(l);if(!(null===(e=r.args)||void 0===e?void 0:e.filePath))return void f(!1);const a=!o.autoModifyFile;f(a&&n),!a&&D.ToolUtils.isToolCallExecutable(l)&&executeTool()}),[o.autoModifyFile,r,l]),(0,h.useEffect)((()=>{l===p.ToolStatus.EXECUTED&&n.refresh()}),[l]),h.default.createElement(h.default.Fragment,null,u&&h.default.createElement("div",{className:"write-file-control command-control"},h.default.createElement("div",{className:"button-container"},h.default.createElement(E.default,{type:"primary",btnText:t("Modify"),onClick:executeTool}),h.default.createElement(E.default,{btnText:t("Cancel"),onClick:()=>{a.cancel(r.id,s),null==c||c(p.ToolStatus.CANCELLED),f(!1)}}),h.default.createElement("div",{className:"command-options"},h.default.createElement(y.ChatDropdown,{items:O},h.default.createElement("div",{className:"command-options-label"},h.default.createElement("span",null,M),h.default.createElement(j.ArrowIcon,null)))))))})),WriteFileToolControl=e=>{const n=d.ContainerUtil.get(p.FileTreeViewService),a=(0,h.useContext)(_.ConversationIdContext),{message:r}=(0,h.useContext)(w.CurrentMessageContext),{tool:o,config:l}=e,{fileVersion:i,fileNode:s,isNewFile:c}=useFileVersion(o,null==r?void 0:r.complete),{result:u,args:m,status:g}=o,[y,E]=(0,h.useState)(void 0),S=(0,v.useIntl)(),{eventMap:j,report:k}=(0,C.useDataReport)(),[N,x]=(0,h.useState)({addedLines:0,removedLines:0}),R=!(!N.addedLines&&!N.removedLines),F=(0,h.useContext)(b.GlobalContext),V={[p.ToolNames.REPLACE_IN_FILE]:{[p.ToolStatus.IDLE]:"Modifying",[p.ToolStatus.PENDING]:"Modifying",[p.ToolStatus.PARSING]:"Modifying",[p.ToolStatus.STREAM_EXECUTING]:"Modifying",[p.ToolStatus.FULL_EXECUTING]:"Modifying",[p.ToolStatus.EXECUTED]:"Modified",[p.ToolStatus.FAILED]:"Failed to modify"},DEFAULT:{[p.ToolStatus.IDLE]:"Generating",[p.ToolStatus.PENDING]:"Generating",[p.ToolStatus.PARSING]:"Generating",[p.ToolStatus.STREAM_EXECUTING]:"Generating",[p.ToolStatus.FULL_EXECUTING]:"Generating",[p.ToolStatus.EXECUTED]:"Generated",[p.ToolStatus.FAILED]:"Failed to generate"}},getReportArgs=e=>({mode:null==F?void 0:F.globalState.mode,languageIdMap:{[e]:(0,O.getLanguageId)(e.split("/").pop()||"")}}),B=(0,h.useCallback)((async e=>{e.stopPropagation();const a=await n.acceptFile((null==m?void 0:m.filePath)||"",(null==i?void 0:i.versionId)||"");n.reportFileOperation([(null==m?void 0:m.filePath)||""],getReportArgs((null==m?void 0:m.filePath)||"")),E(a?f.FileNodeStatus.ACCEPTED:f.FileNodeStatus.ERROR)}),[m,i]),U=(0,h.useCallback)((async e=>{e.stopPropagation();const a=await n.rejectFile((null==m?void 0:m.filePath)||"",(null==i?void 0:i.versionId)||"");n.reportFileOperation([(null==m?void 0:m.filePath)||""],getReportArgs((null==m?void 0:m.filePath)||""),!1),E(a?f.FileNodeStatus.REJECTED:f.FileNodeStatus.ERROR)}),[m,i]);return(0,h.useEffect)((()=>{s&&i&&(E(i.status),((e,n)=>{var o,l,i,s,u,d;const m=e.filePath+(null==r?void 0:r.id),p="string"!=typeof(null==r?void 0:r.content)?null==r?void 0:r.content.find((n=>"tool-call"===n.type&&D.ToolUtils.normalizePath(e.filePath)===D.ToolUtils.normalizePath(n.tool.args.filePath))):void 0;if(n&&n.status===f.FileNodeStatus.IDLE&&p&&"tool-call"===p.type&&A.has(p.tool.id||"")&&!L.has(m)){L.add(m);const f=n.oldContent.length<n.content.length,v=n.content.length-n.oldContent.length;k(j.ChatFileAction,{conversationId:a,requestId:(null==r?void 0:r.requestId)||"",messageId:(null==r?void 0:r.id)||"",addLineCount:(null===(l=null===(o=p.tool.result)||void 0===o?void 0:o.result)||void 0===l?void 0:l.addLineCount)||0,removedLines:(null===(s=null===(i=p.tool.result)||void 0===i?void 0:i.result)||void 0===s?void 0:s.removedLines)||0,requestModelId:(null===(u=null==r?void 0:r.extra)||void 0===u?void 0:u.modelId)||"",requestModelName:(null===(d=null==r?void 0:r.extra)||void 0===d?void 0:d.modelName)||"",languageId:e.language||(0,O.getLanguageId)(e.name),addCharCount:f?v:0,deleteCharCount:f?0:Math.abs(v),isNewFile:!!c},{})}})(s,i))}),[i,s]),(0,h.useEffect)((()=>{var e,n,a,r,o,l,s,c;x({addedLines:null!==(r=null!==(n=null===(e=null==u?void 0:u.result)||void 0===e?void 0:e.addLineCount)&&void 0!==n?n:null===(a=null==i?void 0:i.diff)||void 0===a?void 0:a.addedLines)&&void 0!==r?r:0,removedLines:null!==(c=null!==(l=null===(o=null==u?void 0:u.result)||void 0===o?void 0:o.removedLines)&&void 0!==l?l:null===(s=null==i?void 0:i.diff)||void 0===s?void 0:s.removedLines)&&void 0!==c?c:0})}),[i,u]),h.default.createElement(h.default.Fragment,null,D.ToolUtils.isToolCallEnd(g)&&h.default.createElement(h.default.Fragment,null,g===p.ToolStatus.EXECUTED&&i&&"pending"!==i.status?h.default.createElement("div",{className:"control-wrapper status-executed"},"idle"===y&&R&&h.default.createElement(h.default.Fragment,null,h.default.createElement(T.AcceptIcon,{className:"icon-active icon-accept-pending",onClick:B}),h.default.createElement(I.RejectIcon,{className:"icon-active",onClick:U})),"idle"!==y||R?("accepted"===y||"rejected"===y)&&h.default.createElement(M.FileOperateStatusText,{type:"accepted"===y?M.FileOperateStatus.APPLY:M.FileOperateStatus.REJECT}):h.default.createElement(M.FileOperateStatusText,{type:M.FileOperateStatus.NOMODIFY}),"error"===y&&h.default.createElement("span",{className:"info"},(W="Operation Failed",S.formatMessage({id:W})))):h.default.createElement(P.StatusText,{statusTextMap:V,toolStatus:g===p.ToolStatus.EXECUTED&&"pending"===y?p.ToolStatus.STREAM_EXECUTING:g,toolName:o.name})),D.ToolUtils.isToolCallRunning(g)&&h.default.createElement(P.StatusText,{statusTextMap:V,toolStatus:g,toolName:o.name,isWaitingUserConfirm:g===p.ToolStatus.PENDING&&((null==m?void 0:m.requiresApproval)||!l.autoModifyFile)}));var W},RenderTitle=e=>{const n=d.ContainerUtil.get(p.ChatViewService),{formatMessage:a}=(0,v.useIntl)(),{message:r}=(0,h.useContext)(w.CurrentMessageContext),{tool:o,workspace:l}=e,{args:i,result:s}=o,{fileVersion:c}=useFileVersion(o,null==r?void 0:r.complete),[u,f]=(0,h.useState)({addedLines:0,removedLines:0}),m=D.ToolUtils.getRelativeFilePath((null==i?void 0:i.filePath)||"",l),g=(0,h.useCallback)((e=>{e.stopPropagation(),n.openFile((null==i?void 0:i.filePath)||"",!0,(null==o?void 0:o.id)||"")}),[i,o]);return(0,h.useEffect)((()=>{var e,n,a,r,o,l,i,u;f({addedLines:null!==(r=null!==(n=null===(e=null==s?void 0:s.result)||void 0===e?void 0:e.addLineCount)&&void 0!==n?n:null===(a=null==c?void 0:c.diff)||void 0===a?void 0:a.addedLines)&&void 0!==r?r:0,removedLines:null!==(u=null!==(l=null===(o=null==s?void 0:s.result)||void 0===o?void 0:o.removedLines)&&void 0!==l?l:null===(i=null==c?void 0:c.diff)||void 0===i?void 0:i.removedLines)&&void 0!==u?u:0})}),[c,s]),h.default.createElement(h.default.Fragment,null,h.default.createElement("span",{className:"title"},m||""),o.name&&h.default.createElement(S.FileOperateTypeText,{type:o.name===p.ToolNames.REPLACE_IN_FILE?S.FileOperateType.MODIFY:S.FileOperateType.WIRTE}),!D.ToolUtils.isToolCallRunning(o.status)&&h.default.createElement("div",{className:"change-line-info"},h.default.createElement("span",{className:"add"},"+",u.addedLines||0),h.default.createElement("span",{className:"delete"},"-",u.removedLines||0),h.default.createElement("span",{className:"diff-btn",onClick:g},a({id:"View Changes"}))))},useFileVersion=(e,n)=>{var a;const r=d.ContainerUtil.get(p.FileTreeViewService),[o,l]=(0,h.useState)(void 0),[i,s]=(0,h.useState)(void 0),[c,u]=(0,h.useState)(!1);return(0,h.useEffect)((()=>{const n=r.fileTreeObserver.subscribe((n=>{var a;const r=n.find((n=>{var a;return D.ToolUtils.normalizePath(n.filePath)===D.ToolUtils.normalizePath((null===(a=e.args)||void 0===a?void 0:a.filePath)||"")}));s(r);const o=e.id,i=null===(a=null==r?void 0:r.versions)||void 0===a?void 0:a.find((e=>e.versionId===o));if("file"===(null==i?void 0:i.type))return u(((e,n)=>!e||!e.versions.length||""===(n||e.versions[e.versions.length-1]).oldContent)(r,i)),void l(i);l(void 0)}));return()=>n.unsubscribe()}),[e.status,e.result,null===(a=e.args)||void 0===a?void 0:a.filePath]),{fileVersion:o,fileNode:i,isNewFile:c}}},73671:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.LoadingDots=function LoadingDots(){return o.default.createElement("span",{className:"loading-dots"})},a(55889);const o=r(a(48431))},73751:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useVscodeThemeChange=void 0;const r=a(48431);n.useVscodeThemeChange=(e,n)=>{(0,r.useEffect)((()=>{const n=new MutationObserver((n=>{for(const a of n)"attributes"===a.type&&"data-vscode-theme-kind"===a.attributeName&&e()}));return n.observe(document.body,{attributes:!0,attributeFilter:["data-vscode-theme-kind"]}),()=>n.disconnect()}),n)}},73769:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(86897),n),o(a(87593),n),o(a(38221),n),o(a(18720),n),o(a(54136),n),o(a(63913),n),o(a(50372),n),o(a(40474),n),o(a(13969),n),o(a(58732),n),o(a(46163),n)},74325:(e,n,a)=>{"use strict";a.r(n)},75006:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.MessageRenderer=function MessageRenderer(){const{conversationState:{conversation:e}}=(0,u.useContext)(d.ConversationContext),{messages:n,pendingMessage:a,allVersions:r}=(0,u.useContext)(f.CurrentConversationContext),[o,l]=(0,u.useState)([]),i=(0,u.useMemo)((()=>c.ContainerUtil.getAll(m.ChatMessageRenderer)),[]),s=(0,u.useCallback)(((e,n)=>{let a=!1,o=-1;l(e.map(((e,l)=>{var i;const s=e.requestId;let c=null===(i=r.find((e=>e.requestId===s)))||void 0===i?void 0:i.isDiscarded;return c&&(o=l),e.id===(null==n?void 0:n.currentEditMessageId)&&(a=!0),c=n?n.isDiscard:-1!==o&&o<=l,(null==n?void 0:n.currentEditMessageId)&&!a||e.isDiscard===c?e:{...e,isDiscard:c,className:c||a?"gray-message":""}})))}),[r]);if((0,u.useEffect)((()=>{const e=[...n,...a?[a]:[]];s(e)}),[n,a,s,r]),(0,u.useEffect)((()=>{const e=f.messageContextSubject.subscribe((e=>{s(o,e)}));return()=>{e.unsubscribe()}}),[o,s]),!e)return;return u.default.createElement(u.default.Fragment,null,o.map(((n,a)=>u.default.createElement(p,{conversation:e,className:n.className||"",key:n.id||a,discard:n.isDiscard,prevMessage:o[a-1],nextMessage:o[a+1],message:n,messageRenderers:i}))))};const s=a(398),c=a(15985),u=i(a(48431)),d=a(32134),f=a(4882),m=a(4841),p=(0,u.memo)((({conversation:e,message:n,discard:a,messageRenderers:r,className:o,prevMessage:l,nextMessage:i})=>{if(!e)return;return r.map((e=>({priority:e.canHandle(n)||0,renderer:e}))).sort(((e,n)=>n.priority-e.priority))[0].renderer.render(n,e,{discard:a,className:o,prevMessage:l,nextMessage:i,isShowTitle:(null==l?void 0:l.messageType)===s.MessageType.USER})}),((e,n)=>e.message===n.message&&e.nextMessage===n.nextMessage))},75053:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ReadFileRenderer=void 0;const i=a(15985),s=a(69022),c=a(19606),u=l(a(48431)),d=a(99095),f=a(75831),m=a(87783),p=a(46506),v=a(42810),h=a(63565);let g=class ReadFileRenderer{constructor(){this.className="read-file",this.clickHeader=!0,this.t=(e,n)=>e}canHandle(e){return e.name===s.ToolNames.READ_FILE?v.ChatToolRendererPriority.EXACT:v.ChatToolRendererPriority.NONE}clickCardHeader(e){this.openFile(e)}renderTitle(e,n){const{args:a,status:r}=e,o=(null==a?void 0:a.filePath)||"",l=h.ToolUtils.getRelativeFilePath(o,n);return u.default.createElement(d.ToolCallPathCollectorHoc,{status:r,paths:[o]},u.default.createElement("span",{className:"title",title:o},l),u.default.createElement(f.FileOperateTypeText,{type:f.FileOperateType.READ}),r===s.ToolStatus.EXECUTED&&u.default.createElement("span",{className:"line-info"},"L",(null==a?void 0:a.startLine)||0,"-",(null==a?void 0:a.endLine)||"End"))}renderControl(e){const n={DEFAULT:{[s.ToolStatus.IDLE]:"Reading Files",[s.ToolStatus.PENDING]:"Reading Files",[s.ToolStatus.PARSING]:"Reading Files",[s.ToolStatus.STREAM_EXECUTING]:"Reading Files",[s.ToolStatus.FULL_EXECUTING]:"Reading Files",[s.ToolStatus.EXECUTED]:"Completed",[s.ToolStatus.FAILED]:"Read failed"}};return u.default.createElement(m.StatusText,{statusTextMap:n,toolStatus:e.status})}renderIcon(e){return e.args.filePath?u.default.createElement(c.Icon,{type:c.IconType.VSCODE,name:e.args.filePath}):u.default.createElement(p.CodeIcon,null)}openFile(e){var n,a,r;const o=(null===(n=null==e?void 0:e.args)||void 0===n?void 0:n.filePath)||"";(null===(a=null==e?void 0:e.args)||void 0===a?void 0:a.startLine)&&(null===(r=null==e?void 0:e.args)||void 0===r?void 0:r.endLine)?this.chatViewService.openFileWithRange(o,[{line:e.args.startLine-1,character:0},{line:e.args.endLine,character:0}]):this.chatViewService.openFile(o)}};n.ReadFileRenderer=g,r([(0,i.Autowired)(s.ChatViewService),o("design:type",Object)],g.prototype,"chatViewService",void 0),n.ReadFileRenderer=g=r([(0,i.Component)(v.ChatToolRenderer)],g)},75339:(e,n,a)=>{"use strict";a.r(n)},75538:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useChatState=function useChatState(){const e=r.ContainerUtil.get(o.ChatStateViewService),n=(0,s.newChatViewService)(),a=(0,l.useRef)(e.getState()),[c,u]=(0,l.useState)(e.getState()),[d,f]=(0,l.useState)("");(0,l.useEffect)((()=>{const r=[e.stateObserver.subscribe((e=>{u(e),a.current=e,e!==o.ChatState.IDLE?(n.inConversation(!0),setChatStateText("")):n.inConversation(!1)})),i.chatStateTextSubject.subscribe((e=>{e&&e!==d&&f(e)}))];return()=>r.forEach((e=>e.unsubscribe()))}),[c]);const setChatStateText=e=>{e!==d&&(f(e),i.chatStateTextSubject.next(e))};return{chatState:c,chatStateRef:a,chatStateText:d,setChatStateText,triggerChatState:n=>{e.event(n)}}};const r=a(15985),o=a(69022),l=a(48431),i=a(73e3),s=a(40109)},75576:(e,n,a)=>{"use strict";a.r(n)},75645:(e,n)=>{"use strict";var a,r,o;Object.defineProperty(n,"__esModule",{value:!0}),n.PromptEvaluateScore=n.PromptEvaluatorPriority=n.PromptRendererPriority=n.PromptRenderer=n.PromptEvaluator=n.PromptProvider=n.PromptManager=void 0,n.PromptManager=Symbol("PromptManager"),n.PromptProvider=Symbol("PromptProvider"),n.PromptEvaluator=Symbol("PromptEvaluator"),n.PromptRenderer=Symbol("PromptRenderer"),function(e){e[e.Default=1]="Default"}(a||(n.PromptRendererPriority=a={})),function(e){e[e.Default=1]="Default"}(r||(n.PromptEvaluatorPriority=r={})),function(e){e[e.Default=1]="Default"}(o||(n.PromptEvaluateScore=o={}))},75831:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.FileOperateType=void 0,n.FileOperateTypeText=function FileOperateTypeText(e){return i.default.createElement("span",{className:(0,l.default)("file-operate-type",e.type.toLocaleLowerCase())},"(",i.default.createElement(o.FormattedMessage,{id:e.type}),")")},a(81409);const o=a(19606),l=r(a(73059)),i=r(a(48431));var s;!function(e){e.MODIFY="Modify",e.WIRTE="Write",e.READ="Read"}(s||(n.FileOperateType=s={}))},75857:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),a(45639);const o=r(a(73059)),l=r(a(48431));n.default=({type:e="default",size:n="middle",disabled:a=!1,btnText:r,onClick:i,width:s="auto",outline:c=!1})=>{const u="code-buddy-button",d=(0,o.default)(u,`${u}-${e}`,`${u}-${n}`,{[`${u}-disabled`]:a},{[`${u}-outline`]:c}),f={opacity:a?.5:1,width:s};return l.default.createElement("button",{type:"button",className:d,style:f,onClick:e=>{a||null==i||i(e)},disabled:a},r)}},76427:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),a(96885);const o=r(a(48431)),Input=({onChange:e,onFocus:n,onBlur:a,onKeyDown:r,onInput:l,onClick:i,onPressEnter:s,...c})=>o.default.createElement("input",{...c,onChange:e,onFocus:n,onBlur:a,onKeyDown:e=>{null==r||r(e),"Enter"===e.key&&(null==s||s(e))},onInput:l,onClick:i});n.default=e=>{const{placeholder:n,prefix:a,suffix:r,...l}=e;return o.default.createElement("div",{className:"code-buddy-input"},a&&o.default.createElement("div",{className:"code-buddy-input__input-prefix"},a),o.default.createElement(Input,{className:"code-buddy-input__input",placeholder:n,...l}),r&&o.default.createElement("div",{className:"code-buddy-input__input-suffix"},r))}},76503:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CodeCompletionResponseMetadata=n.CodeCompletionResponseMetadataBuilder=n.CodeCompletionGenerationMetadata=void 0;const r=a(398),o=a(15985);n.CodeCompletionGenerationMetadata=class CodeCompletionGenerationMetadata{static from(e,n={},a){return{finishReason:e,contentFilterMetadata:a,metadata:n}}};class CodeCompletionResponseMetadataBuilder{constructor(){this.responseMetadata=l.createEmpty()}id(e){return this.responseMetadata.id=e,this}model(e){return this.responseMetadata.model=e,this}costs(e){return this.responseMetadata.costs=e,this}rateLimit(e){return this.responseMetadata.rateLimit=e,this}usage(e){return this.responseMetadata.usage=e,this}promptMetadata(e){return this.responseMetadata.promptMetadata=e,this}keyValue(e,n){if(!e)throw new o.IllegalArgumentError("Key must not be empty");return n&&(this.responseMetadata.extra[e]=n),this}build(){return this.responseMetadata}}var l;n.CodeCompletionResponseMetadataBuilder=CodeCompletionResponseMetadataBuilder,function(e){e.createEmpty=function createEmpty(){return{id:"",model:"",rateLimit:r.RateLimit.createEmpty(),usage:r.Usage.createEmpty(),promptMetadata:[],extra:{}}},e.builder=function builder(){return new CodeCompletionResponseMetadataBuilder}}(l||(n.CodeCompletionResponseMetadata=l={}))},76514:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useDataReport=function useDataReport(){const e=(0,r.useMemo)((()=>(0,o.getDataReportViewService)()),[]),n=(0,r.useMemo)((()=>e.getReportEventMap()),[e]),a=(0,r.useCallback)(((...n)=>e.report(...n)),[e]),l=(0,r.useCallback)(((...n)=>e.modelReport(...n)),[e]);return{eventMap:n,report:a,modelReport:l}};const r=a(48431),o=a(20421)},77237:(e,n,a)=>{"use strict";a.r(n)},77478:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.KnowledgeBaseReferences=void 0,a(65492);const s=a(15985),c=a(69022),u=a(19606),d=i(a(48431)),f=a(37232),m=a(6044),p=a(39941),v=a(82966);n.KnowledgeBaseReferences=d.default.memo((e=>{const{reference:n}=e,[a,r]=(0,d.useState)([]);(0,d.useEffect)((()=>{if(!n.length)return;const e=n.map((e=>{const{startPos:n,endPos:a,source:r,fileName:o}=e.metadata;let l="",i="";try{const e=new URL(r);l=decodeURIComponent(e.pathname.slice(1))}catch(e){}const s=getFileName(o)||getFileName(l||r);return e.chunk&&(i=transformCodeText(e.chunk,s)),{...e,filename:s,expand:!1,content:i,pathname:l||r,url:l?`${r}${n?`#L${n}`:""}${n&&a?`-L${a}`:""}`:""}}));r(e)}),[n]);const getFileName=e=>(null==e?void 0:e.split("/").pop())||"",transformCodeText=(e,n)=>{const a=n.split(".").pop()||"md";return"md"===a||e.includes("```")?e:`\`\`\`${a}\n${e}\n\`\`\``};return d.default.createElement("div",{className:"knowledge-base-reference"},!!a.length&&d.default.createElement(d.default.Fragment,null,d.default.createElement(u.FormattedMessage,{id:"Knowledgebase search"})," (",a.length,")",d.default.createElement("div",{className:"reference-wrapper"},a.map(((e,n)=>d.default.createElement("div",{key:`${e.knowledgeBaseId}-${n}`,className:["reference-detail",e.url?"pointer":""].join(" ")},d.default.createElement(m.Tooltip,{content:e.pathname},d.default.createElement("div",{className:"path-item",onClick:()=>((e,n)=>{e.url?s.ContainerUtil.get(c.ChatViewService).openExternalLink(e.url):r(a.map(((e,a)=>a===n?{...e,expand:!e.expand}:e)))})(e,n)},d.default.createElement("span",null,n+1,"."),d.default.createElement("div",{className:"file-name text-hover"},e.filename,":"),d.default.createElement("div",{className:"file-line text-hover"},e.metadata.startPos,"-",e.metadata.endPos),d.default.createElement("div",{className:"file-source"},d.default.createElement("div",{className:"file-source-text text-hover"},e.pathname),e.url?d.default.createElement(v.ShareIcon,null):d.default.createElement(p.ArrowIcon,{className:["expand-icon",e.expand?"expand":""].join(" ")})))),!e.url&&e.expand&&d.default.createElement("div",{className:"code-area"},d.default.createElement(f.MarkdownRenderer,null,e.content))))))))}))},78071:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getProcessingEvent=n.setProcessingEvent=n.McpInstallPathMap=n.evnentLocalKey=void 0,n.evnentLocalKey="ProcessingEventKey",n.McpInstallPathMap={"Playwright MCP Server":"Playwright MCP Server"};n.setProcessingEvent=e=>{localStorage.setItem(n.evnentLocalKey,JSON.stringify({datetime:new Date,eventMessage:e}))};n.getProcessingEvent=()=>{const e=localStorage.getItem(n.evnentLocalKey);if(e){const{datetime:a,eventMessage:r}=JSON.parse(e);return localStorage.removeItem(n.evnentLocalKey),(new Date).getTime()-new Date(a).getTime()>3e5?void 0:r}}},78101:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.AgentManagerImpl=void 0;const l=a(15985),i=a(18725),s=a(26020),c=a(93108);let u=class AgentManagerImpl{async getAgents(){const{agents:e=[]}=await this.productManager.waitConfiguration();return e}async getAgent(e){const n=await this.getAgents();for(const a of n)if(a.name===e)return a;throw new l.IllegalArgumentError(`Agent ${e} not found`)}async getAgentModel(e,n){var a;const r=null!==(a=(await this.getAgent(e)).models)&&void 0!==a?a:[];let o=r[0];const{productFeatures:l}=await this.productManager.waitConfiguration();if(n&&(null==l?void 0:l.UseDefaultModelIfCurrentNotInList)?r.includes(n)&&(o=n):o=n||o,o)try{return await this.modelManager.getModel(o)}catch(e){return{id:o}}}};n.AgentManagerImpl=u,r([(0,l.Autowired)(s.ProductManager),o("design:type",Object)],u.prototype,"productManager",void 0),r([(0,l.Autowired)(i.ModelManager),o("design:type",Object)],u.prototype,"modelManager",void 0),n.AgentManagerImpl=u=r([(0,l.Component)(c.AgentManager)],u)},78388:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i};Object.defineProperty(n,"__esModule",{value:!0}),n.DefaultPromptEvaluator=void 0;const o=a(15985),l=a(75645);let i=class DefaultPromptEvaluator{async priority(e){return l.PromptEvaluatorPriority.Default}async evaluate(e,n){var a,r;let o=l.PromptEvaluateScore.Default;return(null===(a=e.tags)||void 0===a?void 0:a.length)&&(null===(r=n.tags)||void 0===r?void 0:r.length)&&(o+=this.calculateIntersectionCount(e.tags,n.tags)),o}calculateIntersectionCount(e,n){const a=new Set(n);return e.filter((e=>a.has(e))).length}};n.DefaultPromptEvaluator=i,n.DefaultPromptEvaluator=i=r([(0,o.Component)(l.PromptEvaluator)],i)},78517:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(36425),n),o(a(46700),n)},78559:(e,n,a)=>{"use strict";a.r(n)},78819:(e,n,a)=>{"use strict";a.r(n)},78988:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.UserMessageRenderer=void 0,a(8900);const u=a(398),d=a(15985),f=a(84176),m=a(59659),p=a(76243),v=a(69022),h=a(19606),g=s(a(48431)),y=a(57035),b=a(18196),_=a(63306),C=a(64900),E=c(a(63235)),w=a(99095),O=a(32134),M=a(73e3),S=a(4882),P=a(4841),T=a(83917),j=a(48990),k=a(82878),I=a(50759),N=a(6976);let x=class UserMessageRenderer{canHandle(e){return e.messageType===u.MessageType.USER?10:0}render(e,n,a){var r;return g.default.createElement(D,{message:e,discard:null!==(r=null==a?void 0:a.discard)&&void 0!==r&&r,className:(null==a?void 0:a.className)||""})}};n.UserMessageRenderer=x,n.UserMessageRenderer=x=i([(0,m.Widget)({area:_.ChatBodyConversionMessageArea.Tools,component:N.Tools}),(0,d.Component)(P.ChatMessageRenderer)],x);const D=(0,g.memo)((e=>{var n,a,r,o,l;const i=d.ContainerUtil.get(v.CheckpointViewService),{message:s,discard:c,className:m}=e,{messages:P,allVersions:N,deleteRun:x}=(0,g.useContext)(S.CurrentConversationContext),{conversationState:D}=(0,g.useContext)(O.ConversationContext),R=(0,g.useRef)(null),L=(0,g.useRef)(c),A=(0,g.useRef)(null),[F,V]=(0,g.useState)(!1),[B,U]=(0,g.useState)(!1),[W,H]=(0,g.useState)(!1),[,G]=(0,g.useState)(0),q=(0,g.useRef)(new d.DeferredPromise),[$,X]=(0,g.useState)(!1),[K,z]=(0,g.useState)([]),Z=s.requestId,J=(0,h.useIntl)(),t=e=>J.formatMessage({id:e}),Y=(0,g.useCallback)((async()=>{var e;X(!0);const n=null===(e=N.find((e=>e.requestId===Z)))||void 0===e?void 0:e.versionId;if(!n)return void X(!1);await i.rollbackVersion(n)||E.default.error(t("Revert Failed")),X(!1)}),[N]),Q=`dialog.storage.key.edit.from.checkpoint-${(null===(n=D.conversation)||void 0===n?void 0:n.id)||""}`,ee=(0,C.useConfirmDialog)((0,g.useCallback)((async()=>{await Y(),M.chatActionSubject.next(void 0),U(!0),L.current=!0,S.messageContextSubject.next({currentEditMessageId:s.id,isDiscard:!0,versionChange:!0})}),[Y]),Q),te={title:t("Restore the content of this checkpoint"),content:t("This action will undo all changes made after this checkpoint. Are you sure you want to continue?"),confirm:t("Continue"),cancel:t("Cancel")},ne={title:t("Re-prompt"),content:t("Re-prompting will revert all file changes made after the original question. Please confirm if you wish to continue?"),confirm:t("Continue and revert"),confirmWithNoRollback:t("Continue without reverting")},ae=(0,g.useCallback)((()=>{M.chatActionSubject.next(void 0),U(!0),F&&S.messageContextSubject.next({currentEditMessageId:s.id})}),[F,R]),rollbackToMessageVersion=()=>{ee.onOpenDialog(void 0)},displayRequestMessage=()=>{i.displayRequestMessage(s.id)},re=(0,g.useCallback)((async()=>{const e=await i.isDevMode();H(e)}),[]),oe=(0,g.useCallback)((async()=>{await new Promise((e=>setTimeout(e,100))),U(!1),S.messageContextSubject.next({currentEditMessageId:L.current?s.id:"",isDiscard:L.current})}),[L]),le=(0,g.useCallback)((async()=>{U(!1),null==x||x(Z)}),[P,N]),ie=`dialog.storage.key.edit.question-${(null===(a=D.conversation)||void 0===a?void 0:a.id)||""}`,se=(0,C.useConfirmDialog)((0,g.useCallback)((()=>{Y(),q.current.complete(!0)}),[Y]),ie),ce=(0,g.useCallback)((async()=>{if(!F||L.current)return setTimeout(le),!0;q.current=new d.DeferredPromise,se.onOpenDialog(void 0);try{await q.current.p}catch(e){return!1}finally{setTimeout(le)}return!0}),[F]),ue=(0,g.useCallback)((async()=>{const e=await i.restoreToLatestVersion();if(Array.isArray(e))return z(e.map((e=>e.filePath))),void de.onOpenDialog(void 0);e?(U(!1),L.current=!1,S.messageContextSubject.next({currentEditMessageId:void 0,isDiscard:!1,versionChange:!0})):E.default.error(t("Revert Failed"))}),[]),de=(0,C.useConfirmDialog)((0,g.useCallback)((async()=>{await i.restoreToLatestVersion(!0)?(U(!1),L.current=!1,S.messageContextSubject.next({currentEditMessageId:void 0,isDiscard:!1,versionChange:!0}),z([])):E.default.error(t("Revert Failed"))}),[])),fe=(0,g.useCallback)((e=>{const n=d.ContainerUtil.get(p.FileSearchViewService);if(e.name===v.ReferenceNames.File||e.name===v.ReferenceNames.Code){const a=e.metadata.selection?JSON.parse(JSON.stringify(e.metadata.selection)):void 0;a&&(a.start.line-=1,a.end.line-=1),n.openFile(e.metadata.filepath,a?[a.start,a.end]:void 0)}}),[]),{convertSelectionContextInfoToReferences:me}=(0,b.useReference)(),pe=me((null===(r=s.extra)||void 0===r?void 0:r.selectionContexts)||[]);(0,g.useEffect)((()=>{setTimeout((()=>{var e;null===(e=R.current)||void 0===e||e.focus()}),10)}),[B]),(0,g.useEffect)((()=>{L.current=c,G(Date.now())}),[c]),(0,g.useEffect)((()=>{if(!s)return;const e=N.map((e=>e.requestId));V(s.messageType===u.MessageType.USER&&!!s.requestId&&e.includes(s.requestId))}),[s,N]),(0,g.useEffect)((()=>{re()}),[]);const ve=(0,g.useMemo)((()=>({message:s,editQuestion:ae,rollbackToMessageVersion,displayRequestMessage,isDevMode:W,rollbackPending:$})),[s,ae,rollbackToMessageVersion,displayRequestMessage,W,$]);return g.default.createElement("div",{className:"user-message",key:s.id},g.default.createElement("div",{className:!B&&L.current?m:""},g.default.createElement(w.UserMessagePathCollectorHoc,{requestId:s.requestId,references:pe},g.default.createElement(I.UserMessageReference,{references:pe,onClick:fe})),g.default.createElement("div",{className:"flex flex-row-reverse"},!B&&g.default.createElement(j.Bubble,null,g.default.createElement("div",{style:{whiteSpace:"pre-wrap"}},g.default.createElement((()=>{var e,n;return(null===(n=null===(e=s.extra)||void 0===e?void 0:e.inputPhrase)||void 0===n?void 0:n.length)?s.extra.inputPhrase.map(((e,n)=>"normal"===e.type?e.content.toString():g.default.createElement("span",{className:"marker",key:n},e.content.toString()))):s.content}),{key:s.id}))),B&&g.default.createElement(g.default.Fragment,null,g.default.createElement("div",{className:"user-message-popper",onClick:oe}),g.default.createElement("div",{className:"user-message-input flex-1",ref:A},g.default.createElement(y.ChatInputWrapper,{autoFocus:!0,componentMode:!0,defaultInputText:s.content,defaultInputPhrase:null===(o=s.extra)||void 0===o?void 0:o.inputPhrase,defaultContexts:null===(l=s.extra)||void 0===l?void 0:l.selectionContexts,beforeSend:ce})))),!B&&!L.current&&g.default.createElement("div",{className:"toolbar flex flex-row-reverse"},g.default.createElement(S.CurrentMessageContext.Provider,{value:ve},g.default.createElement(f.Slot,{area:_.ChatBodyConversionMessageArea.Tools})))),L.current&&B&&g.default.createElement(T.RecoverMessage,{className:"flex-row-reverse",onReplayConversation:ue}),g.default.createElement(C.Dialog,{storageKey:Q,visible:ee.visible,title:te.title,onClose:ee.onCloseDialog,actions:g.default.createElement(g.default.Fragment,null,g.default.createElement(C.Button,{variant:"primary",onClick:ee.onConfirmDialog},te.confirm),g.default.createElement(C.Button,{variant:"secondary",onClick:ee.onCloseDialog},te.cancel))},te.content),g.default.createElement(C.Dialog,{storageKey:ie,visible:se.visible,title:g.default.createElement("div",{className:"flex flex-items-center gap-8"},g.default.createElement(k.WarningIcon,null),g.default.createElement(h.FormattedMessage,{id:"Re-prompt"})),onClose:se.onCloseDialog,actions:g.default.createElement(g.default.Fragment,null,g.default.createElement(C.Button,{variant:"primary",onClick:se.onConfirmDialog},ne.confirm),g.default.createElement(C.Button,{variant:"secondary",onClick:()=>{q.current.complete(!1)}},ne.confirmWithNoRollback),g.default.createElement("div",{className:"cursor-pointer",onClick:se.onCloseDialog},g.default.createElement(h.FormattedMessage,{id:"Cancel"})))},te.content),g.default.createElement(C.Dialog,{visible:de.visible,title:t("File Changes Detected"),onClose:de.onCloseDialog,actions:g.default.createElement(g.default.Fragment,null,g.default.createElement(C.Button,{variant:"danger",onClick:de.onConfirmDialog},t("Continue")),g.default.createElement(C.Button,{variant:"secondary",onClick:de.onCloseDialog},t("Cancel")))},g.default.createElement(g.default.Fragment,null,K.length>0&&g.default.createElement("div",null,g.default.createElement("div",null,t("The following files have manual changes: ")),g.default.createElement("div",null,K.map((e=>g.default.createElement("p",null,e)))),g.default.createElement("div",null,t("Continuing will overwrite these changes. Are you sure"))))))}))},80337:(e,n,a)=>{"use strict";a.r(n)},81409:(e,n,a)=>{"use strict";a.r(n)},81426:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),c=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.DeleteFileRenderer=void 0;const d=a(15985),f=a(76243),m=a(69022),p=a(19606),v=s(a(48431)),h=a(50473),g=a(64900),y=a(99095),b=u(a(6949)),_=a(87783),C=a(39941),E=a(46506),w=a(91015),O=a(42810),M=a(63565);let S=class DeleteFileRenderer{constructor(){this.className="delete-file"}canHandle(e){return e.name===m.ToolNames.DELETE_FILES?O.ChatToolRendererPriority.EXACT:O.ChatToolRendererPriority.NONE}renderTitle(e,n){var a,r;const o=M.ToolUtils.getRelativeFilePath((null===(a=null==e?void 0:e.args)||void 0===a?void 0:a.filePath)||"",n),l=(null===(r=null==e?void 0:e.args)||void 0===r?void 0:r.filePath)||"";return v.default.createElement(y.ToolCallPathCollectorHoc,{status:e.status,paths:[l]},v.default.createElement("span",{className:"title",title:l},o))}renderControl(e,n){const a={DEFAULT:{[m.ToolStatus.IDLE]:"Receiving",[m.ToolStatus.PARSING]:"Receiving",[m.ToolStatus.PENDING]:"Receiving",[m.ToolStatus.STREAM_EXECUTING]:"Deleting",[m.ToolStatus.FULL_EXECUTING]:"Deleting",[m.ToolStatus.EXECUTED]:"Deleted",[m.ToolStatus.FAILED]:"Failed to delete"}};return v.default.createElement(_.StatusText,{statusTextMap:a,toolStatus:e.status,isWaitingUserConfirm:e.status===m.ToolStatus.PENDING&&!n.autoModifyFile})}renderIcon(e){return v.default.createElement(E.CodeIcon,{className:e.status===m.ToolStatus.EXECUTED?"disabled":""})}renderButtons(e,n){return v.default.createElement(P,{tool:e,config:n})}};n.DeleteFileRenderer=S,i([(0,d.Autowired)(m.ChatViewService),c("design:type",Object)],S.prototype,"chatViewService",void 0),n.DeleteFileRenderer=S=i([(0,d.Component)(O.ChatToolRenderer)],S);const P=(0,v.memo)((e=>{const n=d.ContainerUtil.get(m.FileTreeViewService),a=d.ContainerUtil.get(f.ToolViewService),{tool:r,config:o}=e,{status:l}=r,i=(0,v.useContext)(y.GlobalContext),s=(0,v.useContext)(y.ConversationIdContext),{setToolStatus:c}=(0,v.useContext)(w.CurrentToolContext),[u,_]=(0,v.useState)(!1),E=(0,p.useIntl)(),t=e=>E.formatMessage({id:e}),O=d.ContainerUtil.get(h.ChatModeController),S=[{label:t("Ask Each Time"),value:"false",onClick:()=>{}},{label:t("Automatically Modify Files"),value:"true",onClick:()=>T()}],P=S[0].label,T=(0,v.useCallback)((async()=>{const e=await O.getChatModeSettings()||{};await O.updateChatModeSettings({...e,craft:{...e.craft||{},autoModifyFile:!0}}),executeTool()}),[i]),executeTool=()=>{a.execute(r.id,s),null==c||c(m.ToolStatus.STREAM_EXECUTING),_(!1)};return(0,v.useEffect)((()=>{var e;const n=M.ToolUtils.isToolCallPending(l);if(!(null===(e=r.args)||void 0===e?void 0:e.filePath))return void _(!1);const a=!o.autoModifyFile;_(a&&n),!a&&M.ToolUtils.isToolCallExecutable(l)&&executeTool()}),[o.autoModifyFile,r,l]),(0,v.useEffect)((()=>{l===m.ToolStatus.EXECUTED&&n.refresh()}),[l]),v.default.createElement(v.default.Fragment,null,u&&v.default.createElement("div",{className:"delete-file-control command-control"},v.default.createElement("div",{className:"button-container"},v.default.createElement(b.default,{type:"primary",btnText:t("Delete"),onClick:executeTool}),v.default.createElement(b.default,{btnText:t("Cancel"),onClick:()=>{a.cancel(r.id,s),null==c||c(m.ToolStatus.CANCELLED),_(!1)}}),v.default.createElement("div",{className:"command-options"},v.default.createElement(g.ChatDropdown,{items:S},v.default.createElement("div",{className:"command-options-label"},v.default.createElement("span",null,P),v.default.createElement(C.ArrowIcon,null)))))))}))},81521:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SearchFileRenderer=void 0;const i=a(15985),s=a(69022),c=a(19606),u=l(a(48431)),d=a(99095),f=a(73671),m=a(87783),p=a(39941),v=a(42810),h=a(63565);let g=class SearchFileRenderer{constructor(){this.className="search-file",this.clickHeader=!0,this.resultVisible=!1,this.t=(e,n)=>e}canHandle(e){return e.name===s.ToolNames.SEARCH_FILE?v.ChatToolRendererPriority.EXACT:v.ChatToolRendererPriority.NONE}renderTitle(e){var n;const a=(null===(n=null==e?void 0:e.args)||void 0===n?void 0:n.pattern)||"",r=this.filePaths.map((e=>"string"==typeof e?e:e.filePath));return u.default.createElement(d.ToolCallPathCollectorHoc,{status:e.status,paths:r},h.ToolUtils.isToolCallEnd(e.status)&&u.default.createElement(u.default.Fragment,null,u.default.createElement("span",{className:"title"},u.default.createElement(c.FormattedMessage,{id:'Searching for "{key}"',values:{key:a}})),u.default.createElement("span",{className:"file-num"},u.default.createElement(c.FormattedMessage,{id:"{num} result",values:{value:r.length}}))),h.ToolUtils.isToolCallRunning(e.status)&&u.default.createElement("span",{className:["title","disabled"].join(" ")},u.default.createElement(c.FormattedMessage,{id:'Searching for "{key}"',values:{key:a}})))}renderControl(e){const n={DEFAULT:{[s.ToolStatus.IDLE]:"Currently Searching",[s.ToolStatus.PENDING]:"Currently Searching",[s.ToolStatus.PARSING]:"Currently Searching",[s.ToolStatus.STREAM_EXECUTING]:"Currently Searching",[s.ToolStatus.FULL_EXECUTING]:"Currently Searching",[s.ToolStatus.EXECUTED]:"Completed",[s.ToolStatus.FAILED]:"Search failed"}};return u.default.createElement(m.StatusText,{statusTextMap:n,toolStatus:e.status})}renderSearching(e){return u.default.createElement("span",{className:"content-item"},u.default.createElement(c.FormattedMessage,{id:'Searching for "{key}"',values:{key:e}}),u.default.createElement(f.LoadingDots,null))}renderFileList(){return 0===this.filePaths.length?u.default.createElement("span",{className:"no-search"},u.default.createElement(c.FormattedMessage,{id:"No relevant content was found"})):this.filePaths.map((e=>this.renderFileItem(e)))}renderResult(e){var n;const a=(null===(n=null==e?void 0:e.args)||void 0===n?void 0:n.pattern)||"",r=h.ToolUtils.isToolCallRunning(e.status);return u.default.createElement("div",{className:"container"},r?this.renderSearching(a):this.renderFileList())}renderFileItem(e){"string"==typeof e&&(e={filePath:e,size:"",modifyTime:""});const{filePath:n,size:a}=e,isDirectory=e=>e.endsWith("/"),openFile=e=>{if(isDirectory(e))return!1;this.chatViewService.openFile(e)};return u.default.createElement("div",{key:n,className:"content-item"},u.default.createElement("span",{className:"file-path-clickable",onClick:()=>openFile(n),title:n},u.default.createElement("span",{className:"line-file-icon"},isDirectory(n)?u.default.createElement(c.Icon,{name:c.SvgIconName.FolderIcon}):u.default.createElement(c.Icon,{name:n,type:c.IconType.VSCODE})),u.default.createElement("span",{className:"line-file-name truncate"},(isDirectory(r=n)&&(r=r.slice(0,-1)),r.split("/").pop()||"/")),u.default.createElement("span",{className:"line-file-path truncate"},n),a&&u.default.createElement("span",{className:"line-file-size"},a)));var r}renderIcon(e,n){return u.default.createElement(u.default.Fragment,null,e.status===s.ToolStatus.EXECUTED&&u.default.createElement(p.ArrowIcon,{className:n?"":"arrow-left"}))}get filePaths(){var e,n,a,r,o;return(null===(n=null===(e=this.tool)||void 0===e?void 0:e.result)||void 0===n?void 0:n.success)&&(null===(a=this.tool.result.result)||void 0===a?void 0:a.results)&&null!==(o=null===(r=this.tool.result.result)||void 0===r?void 0:r.results)&&void 0!==o?o:[]}get searchPath(){var e,n;return(null===(n=null===(e=this.tool)||void 0===e?void 0:e.args)||void 0===n?void 0:n.filePath)||""}get searchPattern(){var e,n;return(null===(n=null===(e=this.tool)||void 0===e?void 0:e.args)||void 0===n?void 0:n.pattern)||""}};n.SearchFileRenderer=g,r([(0,i.Autowired)(s.ChatViewService),o("design:type",Object)],g.prototype,"chatViewService",void 0),n.SearchFileRenderer=g=r([(0,i.Component)({id:v.ChatToolRenderer,scope:i.Scope.Transient})],g)},81634:(e,n,a)=>{"use strict";a.r(n)},81766:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FileEditService=void 0,n.FileEditService=Symbol("FileEditService")},81768:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useGuardedNavigate=n.chatPageGuard=void 0;const r=a(15985),o=a(69022),l=a(19606),i=a(48431),s=a(15389),c=a(75538);n.chatPageGuard=(e,n)=>{const{to:a,options:l,currentPath:i,chatState:s}=e,c=r.ContainerUtil.get(o.NewChatViewServie),u=r.ContainerUtil.get(o.ChatViewService),{params:d}=l||{};"/"!==i||s!==o.ChatState.TALKING&&s!==o.ChatState.PLAN?("/"===i&&(null==d?void 0:d.newConversation)&&u.clearConversation(),n(a,l)):(null==d?void 0:d.newConversation)&&c.ifShowConfirm(!0)};const u=[n.chatPageGuard];n.useGuardedNavigate=(e=u)=>{const n=(0,s.useNavigate)(),a=(0,s.useLocation)(),r=(0,l.useIntl)(),{chatState:o}=(0,c.useChatState)(),d=(0,i.useRef)(r),f=(0,i.useRef)(o);return(0,i.useEffect)((()=>{d.current=r,f.current=o}),[o,r]),(0,i.useCallback)(((r,o)=>{let l=r,i=o;const next=()=>{n(l,i)};if(0===e.length)return void next();const runGuards=n=>{if(n>=e.length)return void next();(0,e[n])({to:l,options:i,currentPath:a.pathname,intl:d.current,chatState:f.current},((e,a)=>{l=e,i=a,runGuards(n+1)}))};runGuards(0)}),[n,e,a])}},82878:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.WarningIcon=void 0;const o=r(a(48431));n.WarningIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("path",{d:"M9.46667 1.26667H10.5333L18.7333 16.6L18.2 17.4667H1.8L1.26667 16.6L9.46667 1.26667ZM10 2.86667L2.86667 16.2667H17.1333L10 2.86667ZM10.8 15V13.7333H9.2V15H10.8ZM9.2 12.4667V7.46667H10.8V12.4667H9.2Z",fill:"#CCA700"}))},82966:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ShareIcon=void 0;const o=r(a(48431));n.ShareIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("path",{d:"M6.75 1.5H10.5V5.25",stroke:"currentColor",strokeWidth:"1.04",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M10.5 7.36842V9.75C10.5 10.1642 10.1642 10.5 9.75 10.5H2.25C1.83579 10.5 1.5 10.1642 1.5 9.75V2.25C1.5 1.83579 1.83579 1.5 2.25 1.5H4.5",stroke:"currentColor",strokeWidth:"1.04",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M6.375 5.625L10.125 1.875",stroke:"currentColor",strokeWidth:"1.04",strokeLinecap:"round",strokeLinejoin:"round"}))},83364:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.MentionItems=function MentionItems(e){const n=(0,s.useIntl)(),t=e=>n.formatMessage({id:e}),{selectedIndex:a,multiChatSelectionEnabled:r,selectedMenuItem:o,items:l,showRecentFiles:i,rencentFiles:m,rencentAddFiles:p,defaultAddFileNum:v,allRencentFilesLen:h,isExpandRecentAddFiles:g,setIsExpandRecentAddFiles:y,onMentionItemMouseOver:b,onSubMenuBack:_,onSearch:C,onKeydown:E,onApply:w,isItemCheck:O}=e,M=(0,c.useRef)(null),S=(0,c.useRef)(null),P=(0,c.useMemo)((()=>{const e=new Set;return l.filter(((n,a)=>{if(a<(i?h:0))return!0;if(n.type===f.IMentionType.file||n.type===f.IMentionType.folder){const a=`${n.type}|${n.label}|${n.value}`;if(e.has(a))return!1;e.add(a)}return!0}))}),[l,i,h]);(0,c.useLayoutEffect)((()=>{r&&setTimeout((()=>{var e;null===(e=M.current)||void 0===e||e.focus()}))}),[r,e.selections,l]),(0,c.useLayoutEffect)((()=>{setTimeout((()=>{var e;if(S.current){const n=null===(e=S.current)||void 0===e?void 0:e.getElementsByClassName("mention-item-area")[0],a=null==n?void 0:n.getElementsByClassName("mention-selected")[0];if(a&&n){const e=n.getBoundingClientRect(),r=a.getBoundingClientRect();r.bottom>e.bottom?a.scrollIntoView({behavior:"smooth",block:"start"}):r.top<e.top&&a.scrollIntoView({behavior:"smooth",block:"end"})}}}))}),[a]);const highlightText=e=>{var n;return null!==(n=e.highlightText)&&void 0!==n?n:e.value},highlightDescText=e=>e.highlightDescText||e.label;return c.default.createElement("div",{ref:S,className:"mention-item-wrapper",onClick:e=>e.stopPropagation()},(r||o)&&c.default.createElement("div",{className:"search-input-container"},o&&c.default.createElement("div",{className:"header",onClick:e=>{e.stopPropagation(),_()}},c.default.createElement(d.BackIcon,null),o.type===f.IMentionType.file&&c.default.createElement("div",{className:"type-name"},t("Files")),o.type===f.IMentionType.knowledge&&c.default.createElement("div",{className:"type-name"},t("Knowledge Base"))),r&&c.default.createElement(u.TextField,{ref:M,className:"search-input mentionable-search-input",onInput:e=>C(e.target.value),onKeyDown:E,placeholder:(()=>{const e=t("Add files, knowledge base and other materials as context");if(o)switch(o.type){case f.IMentionType.knowledge:return t("Add knowledge base as context");case f.IMentionType.file:return t("Add file as answer background");default:return e}return e})()})),!P.length&&c.default.createElement("div",{className:"mention-item-area no-result "+(r||o?"has-selected-items-with-header":"")},t("No search results")),i&&c.default.createElement(c.default.Fragment,null,m.length>0&&c.default.createElement("div",{className:"at-command-child-area"},m.map(((e,n)=>c.default.createElement("div",{key:e.label+n,className:"mention-item at-command-child-area-item "+(a===e.index?"mention-selected":""),onMouseOver:()=>b(e.index),onMouseDown:()=>w(e.index,e)},c.default.createElement("div",{className:"repository"},c.default.createElement("div",{title:e.value,className:"repository-item"},c.default.createElement("span",{className:"line-icon"},c.default.createElement(s.Icon,{name:e.value,type:s.IconType.VSCODE})),c.default.createElement("span",{className:"name"},highlightText(e)),c.default.createElement("span",{title:e.label,className:"desc"},highlightDescText(e))),c.default.createElement("div",null,O(e)&&c.default.createElement(d.CheckIcon,{className:"check-icon"}))))))),p.length>0&&c.default.createElement("div",{className:"at-command-child-area added-files"},c.default.createElement("div",{className:"title"},t("Added")),p.map(((e,n)=>(g||!g&&n<v)&&c.default.createElement("div",{key:e.label,className:"mention-item at-command-child-area-item "+(a===e.index?"mention-selected":""),onMouseOver:()=>b(e.index),onMouseDown:()=>w(e.index,e)},c.default.createElement("div",{className:"repository"},c.default.createElement("div",{title:e.value,className:"repository-item"},c.default.createElement("span",{className:"line-icon"},c.default.createElement(s.Icon,{name:e.value,type:s.IconType.VSCODE})),c.default.createElement("span",{className:"name"},highlightText(e)),c.default.createElement("span",{title:e.label,className:"desc"},highlightDescText(e))),c.default.createElement("div",null,O(e)&&c.default.createElement(d.CheckIcon,{className:"check-icon"})))))),!g&&p.length>v&&c.default.createElement("div",{className:"mention-item more-add-file "+(a===m.length+v?"mention-selected":""),onClick:e=>{y(!0),e.stopPropagation()}},c.default.createElement("span",{className:"content repository"},c.default.createElement("span",{className:"info"},t("More"),"(",p.length-v,")"))))),c.default.createElement("div",{className:"mention-item-area "+(o||r?"has-selected-items-with-header":"")},P.map(((e,n)=>n>=(i?h:0)&&c.default.createElement("div",{key:e.label+n,className:"mention-item "+(a===n?"mention-selected":""),onMouseOver:()=>b(n),onMouseDown:()=>w(n,e)},e.separatorLabel&&c.default.createElement("div",{className:"title"},e.separatorLabel),c.default.createElement("div",{className:"repository"},c.default.createElement("div",{title:e.value,className:"repository-item"},c.default.createElement("span",{className:"line-icon"},(e=>{if("file"===e.type)return e.id?c.default.createElement(s.Icon,{name:s.SvgIconName.FileIcon}):c.default.createElement(s.Icon,{name:e.value,type:s.IconType.VSCODE});switch(e.type){case"folder":return c.default.createElement(s.Icon,{name:s.SvgIconName.FolderIcon});case"command":return c.default.createElement(d.CommandIcon,null);case"knowledge":return c.default.createElement(s.Icon,{name:s.SvgIconName.DocsIcon});case"diff":return c.default.createElement(s.Icon,{name:s.SvgIconName.DiffIcon});case"terminal":case"problem":return c.default.createElement(s.Icon,{name:s.SvgIconName.TermianlIcon});case"topic":return c.default.createElement(s.Icon,{name:s.SvgIconName.AgentIcon});default:return c.default.createElement(c.default.Fragment,null)}})(e)),c.default.createElement("span",{className:"name"},highlightText(e)),c.default.createElement("span",{title:e.label,className:"desc"},highlightDescText(e))),O(e)&&c.default.createElement(d.CheckIcon,{className:"check-icon"}),e.children&&c.default.createElement(d.ChevronRightIcon,null)))))))},a(35681);const s=a(19606),c=i(a(48431)),u=a(64900),d=a(48924),f=a(50473)},83917:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.RecoverMessage=function RecoverMessage(e){const{onReplayConversation:n,className:a=""}=e,r=(0,o.useIntl)(),t=e=>r.formatMessage({id:e});return l.default.createElement("div",{className:"replay-button-container "+a},l.default.createElement("div",{className:"replay-button",onClick:n,title:t("Resume Conversation")},l.default.createElement(i.ReplayIcon,null),l.default.createElement("span",null,t("Resume"))))};const o=a(19606),l=r(a(48431)),i=a(12562)},84164:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(1179),n)},84332:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MoreIcon=void 0;const o=r(a(48431));n.MoreIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,style:n,...a},o.default.createElement("g",{id:"å¾æ _16px"},o.default.createElement("circle",{id:"Ellipse 560",cx:"3",cy:"8",r:"1",fill:"#808080"}),o.default.createElement("circle",{id:"Ellipse 561",cx:"8",cy:"8",r:"1",fill:"#808080"}),o.default.createElement("circle",{id:"Ellipse 562",cx:"13",cy:"8",r:"1",fill:"#808080"})))},85126:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),a(33708);const s=a(69022),c=a(19606),u=i(a(48431)),d=a(15389),f=a(46141),m=a(78517),p=a(73e3);n.default=({visible:e,title:n,content:a="",onCancel:r,onOk:o})=>{const[l,i]=(0,u.useState)(!1),[v,h]=(0,u.useState)(""),[g,y]=(0,u.useState)(!1),b=(0,d.useNavigate)(),_=(0,c.useIntl)(),translations=(e,n)=>_.formatMessage({id:e},n);(0,u.useEffect)((()=>{i(e)}),[e]),(0,u.useEffect)((()=>{y(a.indexOf("错误")>-1),h(a)}),[a]);return u.default.createElement(m.Dialog,{visible:l,title:u.default.createElement("div",{className:"mcp-dialog-terminal-title"},u.default.createElement("div",{className:"mcp-dialog-terminal-title-text"},translations("Install"),n),u.default.createElement("div",{className:"mcp-dialog-terminal-title-subtext"},translations("If installation is stuck, you can stop and reinstall"))),actions:u.default.createElement(u.default.Fragment,null,u.default.createElement(f.Button,{variant:"secondary",onClick:()=>r()},translations("Cancel")),g&&u.default.createElement(f.Button,{variant:"secondary",onClick:()=>(()=>{const e={chatType:s.ChatType.CRAFT,prompt:n+translations("Install failed, analyze the error reason: {info} and try to fix it through the error information",{info:a}),codebase:!1,options:{autoSend:!0,newChat:!0}};p.chatActionSubject.next(e),b("/")})()},translations("Try to resolve"))),onClose:r},u.default.createElement("div",{className:"terminal-output"},u.default.createElement("textarea",{className:"terminal-output-text",value:v,readOnly:!0})))}},85300:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(58715),n)},85310:(e,n,a)=>{"use strict";a.r(n)},85371:(e,n,a)=>{"use strict";a.r(n)},85592:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i};Object.defineProperty(n,"__esModule",{value:!0});const o=a(84176),l=a(51724);let i=class{};i=r([(0,o.View)({index:!1,path:"/mcp",component:l.Mcp})],i),n.default=i},85638:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.DefaultPromptRenderer=void 0;const l=a(15985),i=o(a(75329)),s=a(75645);let c=class DefaultPromptRenderer{constructor(){this.templateCache=new Map}async priority(e){return s.PromptRendererPriority.Default}async render(e,n){return this.getCompiledTemplate(e).render(n.variables)}getCompiledTemplate(e){if(this.templateCache.has(e))return this.templateCache.get(e);const n=i.default.compile(e);return this.templateCache.set(e,n),n}};n.DefaultPromptRenderer=c,n.DefaultPromptRenderer=c=r([(0,l.Component)(s.PromptRenderer)],c)},86243:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ChatActiveSelection=function ChatActiveSelection(e){const n=(0,c.useIntl)(),a=(0,d.useCallback)((0,u.default)((e=>e()),100),[]),r=(0,d.useRef)(null),[o,l]=(0,d.useState)(-1),i=(e.selections||[]).filter((e=>[p.ChatSelectionInfoType.AUTO_ADD_CURRENT_FILE,p.ChatSelectionInfoType.SELECT_FILE,p.ChatSelectionInfoType.CONTEXT].includes(e.type))).map((e=>({...e,label:e.label,value:e.value}))).reduce(((e,n)=>(e.some((e=>e.value===n.value&&e.mentionType===n.mentionType&&JSON.stringify(e.selection)===JSON.stringify(n.selection)))||e.push(n),e)),[]),calcOverflowIndex=()=>{if(!i.length||!r.current)return;const e=Array.from(r.current.querySelectorAll(".selection-item-wrapper"));let n,a=1;for(const[r,o]of e.entries()){const{top:e}=o.getBoundingClientRect();if(n){if(e!==n){if(2===a){l(r-1);break}l(-1),a+=1,n=e}}else n=e}};return(0,d.useLayoutEffect)((()=>{calcOverflowIndex();const calcIndex=()=>a(calcOverflowIndex);return window.addEventListener("resize",calcIndex),()=>window.removeEventListener("resize",calcIndex)}),[i]),d.default.createElement("div",{className:"selection-wrapper"},d.default.createElement("div",{className:"selection-list",ref:r},i.length?d.default.createElement("div",{className:"btn-sm",ref:e.addContextRef,...e.referenceProps(),onClick:e.onAddContext},d.default.createElement("span",{className:"icon"})):d.default.createElement(m.Tooltip,{content:(e=>n.formatMessage({id:e}))("Add Context")},d.default.createElement("div",{className:"btn-sm",ref:e.addContextRef,...e.referenceProps(),onClick:e.onAddContext},d.default.createElement("span",{className:"icon"}),d.default.createElement("span",{style:{marginLeft:"4px"}},"Add"))),i.map(((n,a)=>d.default.createElement("div",{key:((null==n?void 0:n.label)||"")+a,className:"selection-item-wrapper"},d.default.createElement(m.Tooltip,{content:n?n.label:""},n&&d.default.createElement("div",{className:"selection-item",onClick:()=>(n=>{var a;null===(a=e.onClick)||void 0===a||a.call(e,n)})(n)},(e=>{switch(e.mentionType){case"code":case"file":return d.default.createElement(c.Icon,{name:e.value,type:c.IconType.VSCODE});case"folder":return d.default.createElement(c.Icon,{name:c.SvgIconName.FolderIcon});case"command":return d.default.createElement(f.CommandIcon,null);case"knowledge":return d.default.createElement(c.Icon,{name:c.SvgIconName.DocsIcon});case"diff":return d.default.createElement(c.Icon,{name:c.SvgIconName.DiffIcon});case"terminal":return d.default.createElement(c.Icon,{name:c.SvgIconName.TermianlIcon});case"topic":return d.default.createElement(c.Icon,{name:c.SvgIconName.AgentIcon});default:return d.default.createElement(d.default.Fragment,null)}})(n),d.default.createElement("span",{className:"selection-name"},n.value),n.selection&&d.default.createElement("div",{className:"selection-desc",style:{marginLeft:2}},d.default.createElement("span",null,"(",n.selection&&n.selection.start&&n.selection.end?[n.selection.start.line,"-",n.selection.end.line].join(""):"",")")),d.default.createElement("span",{style:{display:"flex",alignItems:"center"}},d.default.createElement(f.CloseIcon,{className:"close-icon",onClick:n=>{n.stopPropagation(),e.onRemove(a)}})))),a===o&&i.length-a-1>0&&d.default.createElement("span",{...e.selectionReferenceProps(),className:"selection-item more-selection-btn",ref:e.showSelectionContextRef,onClick:e.onShowSelectionContext},i.length-a-1,"+"))))))},a(87349);const c=a(19606),u=s(a(83753)),d=i(a(48431)),f=a(48924),m=a(6044),p=a(50473)},86285:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.FileOperateStatus=void 0,n.FileOperateStatusText=function FileOperateStatusText(e){return i.default.createElement("div",{className:"status-executed status-common"},i.default.createElement(o.FormattedMessage,{id:e.type}),i.default.createElement("span",{className:(0,l.default)("status-icon",e.type!==s.REJECT?"accept":"reject")}))},a(81409);const o=a(19606),l=r(a(73059)),i=r(a(48431));var s;!function(e){e.APPLY="Applied",e.REJECT="Rejected",e.NOMODIFY="No modification required"}(s||(n.FileOperateStatus=s={}))},86595:(e,n,a)=>{"use strict";a.r(n)},86897:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconApply=void 0;const o=r(a(48431));n.IconApply=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M6.34856 4.97077C6.41299 4.79665 6.65927 4.79664 6.7237 4.97077L7.88659 8.11341L11.0292 9.2763C11.2034 9.34073 11.2034 9.58701 11.0292 9.65144L7.88659 10.8143L6.7237 13.957C6.65927 14.1311 6.41299 14.1311 6.34856 13.957L5.18568 10.8143L2.04303 9.65144C1.86891 9.58701 1.86891 9.34073 2.04303 9.2763L5.18568 8.11341L6.34856 4.97077Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M12.2662 1.53613L12.8599 3.14038L14.4641 3.73401L12.8599 4.32763L12.2662 5.93188L11.6726 4.32763L10.0684 3.73401L11.6726 3.14038L12.2662 1.53613Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}))},87298:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.ChatLayout=ChatLayout,n.ChatHeader=ChatHeader,n.ChatBody=ChatBody,n.ChatBodyConversion=ChatBodyConversion,n.ChatFooter=ChatFooter;const c=a(398),u=a(15985),d=a(84176),f=a(59659),m=a(69022),p=s(a(48431)),v=a(48431),h=a(63306),g=a(64900),y=a(32134),b=a(25380),_=a(34636),C=a(20421);function ChatLayout(e){return p.createElement("div",{id:"chat-container",className:"chat-container"},p.createElement(d.Slot,{area:h.ChatArea.Header}),p.createElement(d.Slot,{area:h.ChatArea.Body}),p.createElement(d.Slot,{area:h.ChatArea.Footer}))}function ChatHeader(e){return p.createElement(p.Fragment,null,p.createElement(d.Slot,{area:h.ChatHeaderArea.Toolbar}))}function ChatBody(e){const n=u.ContainerUtil.get(m.ChatViewService),a=u.ContainerUtil.get(m.FileTreeViewService),r=(0,C.newChatViewService)(),{triggerChatState:o,chatState:l}=(0,b.useChatState)(),[i,s]=(0,v.useState)({}),[f,_]=(0,v.useState)(!1),E=(0,v.useRef)([]),w=(0,v.useRef)(!1),O=(0,v.useRef)(void 0),getCurrentConversation=async()=>{var e;const r=await n.getCurrentConversation();(null===(e=O.current)||void 0===e?void 0:e.id)&&w.current||(O.current=r,E.current=[],s({conversation:O.current,pendingMessages:[]}),a.refresh())};return(0,v.useEffect)((()=>{w.current=!0,getCurrentConversation().then((()=>{w.current=!1}))}),[]),(0,v.useEffect)((()=>{const e=n.conversationObserver.subscribe((e=>{O.current=e,E.current=[],s({conversation:e}),a.refresh()}));return()=>e.unsubscribe()}),[i,l]),(0,v.useEffect)((()=>{const e=n.messageObserver.subscribe((async e=>{var n,a,r,l;if((null===(n=O.current)||void 0===n?void 0:n.id)||await getCurrentConversation(),!(null===(a=O.current)||void 0===a?void 0:a.id)||e.conversationId!==O.current.id)return;const u=!(null===(l=null===(r=i.conversation)||void 0===r?void 0:r.messages)||void 0===l?void 0:l.length);e.messageType===c.MessageType.USER?u&&(E.current=[e]):e.isEnd&&u&&(o(m.ChatStateEvent.STOP),E.current=[...E.current,e]),u&&s({conversation:O.current,pendingMessages:E.current})}));return()=>e.unsubscribe()}),[i]),(0,v.useEffect)((()=>{const e=r.confimNewChatSubject.subscribe((e=>{_(e)}));return()=>e.unsubscribe()}),[]),p.createElement(p.Fragment,null,p.createElement(y.ConversationContext.Provider,{value:{getCurrentConversation,conversationState:i}},p.createElement(d.Slot,{area:h.ChatBodyArea.Conversion})),p.createElement(d.Slot,{area:h.ChatBodyArea.FindBug}),f&&p.createElement(g.NewChatDialog,{setVisible:_,visible:f}))}function ChatBodyConversion(e){var n,a,r,o;const{conversationState:l}=(0,v.useContext)(y.ConversationContext),i=!(null===(a=null===(n=l.conversation)||void 0===n?void 0:n.messages)||void 0===a?void 0:a.length)&&!(null===(r=l.pendingMessages)||void 0===r?void 0:r.length);return p.createElement(p.Fragment,null,p.createElement(_.NotifyActivity,null),p.createElement(y.ConversationIdContext.Provider,{value:(null===(o=l.conversation)||void 0===o?void 0:o.id)||""},l.conversation&&p.createElement(p.Fragment,null,p.createElement(d.Slot,{area:i?h.ChatBodyConversionArea.Welcome:h.ChatBodyConversionArea.Messages}),p.createElement(d.Slot,{area:h.ChatBodyConversionArea.Input})),p.createElement(d.Slot,{area:h.ChatBodyConversionArea.CompatibilityShim})))}function ChatFooter(e){return p.createElement(p.Fragment,null)}let E=class{};E=i([(0,f.Widget)({area:h.ChatBodyArea.Conversion,component:ChatBodyConversion}),(0,f.Widget)({area:h.ChatArea.Footer,component:ChatFooter}),(0,f.Widget)({area:h.ChatArea.Body,component:ChatBody}),(0,f.Widget)({area:h.ChatArea.Header,component:ChatHeader}),(0,f.Widget)({area:h.ChatArea.Layout,component:ChatLayout})],E),n.default=E},87345:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.LoginWxide=LoginWxide,a(85310),a(39466);const l=a(84176),i=a(19606),s=o(a(48431)),c=a(35372),u=a(91963);function LoginWxide(){(0,c.useActivePage)(),(0,u.useWebviewStatus)();const e=(0,i.useIntl)();return s.default.createElement("div",{className:"codebuddy-login-container"},s.default.createElement("div",{className:"codebuddy-login-content"},s.default.createElement("h1",{className:"codebuddy-login-title"},e.formatMessage({id:"CodeBuddy"})),s.default.createElement("div",{className:"codebuddy-login-spinner"}),s.default.createElement("p",{className:"codebuddy-login-text"},e.formatMessage({id:"Logging in"}),"..."),s.default.createElement("p",{className:"codebuddy-login-subtitle"},e.formatMessage({id:"Verifying your identity information, please wait"}))))}let d=class{};d=r([(0,l.View)({index:!1,path:"/login-wxide",component:LoginWxide})],d),n.default=d},87349:(e,n,a)=>{"use strict";a.r(n)},87593:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IconCheck=void 0;const o=r(a(48431));n.IconCheck=e=>o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.default.createElement("path",{d:"M13.1972 4.53999C13.4511 4.28615 13.8633 4.28615 14.1171 4.53999C14.3706 4.79382 14.3707 5.20521 14.1171 5.45894L7.04585 12.5302C6.91885 12.6572 6.75236 12.7198 6.58589 12.7197C6.41937 12.7197 6.25285 12.6571 6.12593 12.5302L1.88374 8.28804C1.6299 8.0342 1.6299 7.62196 1.88374 7.36811C2.13751 7.11459 2.5489 7.11461 2.80269 7.36811L6.58589 11.1513L13.1972 4.53999Z",fill:"currentColor"}))},87783:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.StatusText=function StatusText(e){var n;const a={[o.ToolStatus.IDLE]:"Processing",[o.ToolStatus.PARSING]:"Processing",[o.ToolStatus.PENDING]:"Processing",[o.ToolStatus.STREAM_EXECUTING]:"Processing",[o.ToolStatus.FULL_EXECUTING]:"Processing",[o.ToolStatus.EXECUTED]:"Completed",[o.ToolStatus.FAILED]:"Execution failed",[o.ToolStatus.CANCELLED]:"Aborted",[o.ToolStatus.SKIPPED]:"Skipped"},{statusTextMap:r={},toolName:d="DEFAULT",toolStatus:f,isWaitingUserConfirm:m}=e;let p=(null===(n=r[d]||r.DEFAULT)||void 0===n?void 0:n[f])||a[f];if(c.ToolUtils.isToolCallRunning(f))return m&&(p="Waiting for user confirmation"),s.default.createElement("div",{className:"status-common status-pending"},p?s.default.createElement(l.FormattedMessage,{id:p}):"",s.default.createElement(u.LoadingDots,null));return s.default.createElement("div",{className:"status-executed status-common"},p?s.default.createElement(l.FormattedMessage,{id:p}):"",s.default.createElement("span",{className:(0,i.default)("status-icon",f===o.ToolStatus.EXECUTED?"accept":"reject")}))},a(81409);const o=a(69022),l=a(19606),i=r(a(73059)),s=r(a(48431)),c=a(63565),u=a(73671)},88151:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),a(31041);const s=a(15985),c=a(69022),u=a(19606),d=i(a(48431)),f=a(64900);n.default=()=>{const e=(0,u.useIntl)(),translations=n=>e.formatMessage({id:n});return d.createElement("div",{className:"mcp-installed-empty"},d.createElement("div",{className:"mcp-installed-empty-desc"},translations("Model Context Protocol supports communication with MCP servers running locally, which provide additional tools and resources to extend AI's capabilities. You can use servers created by the market, or manually create your own MCP servers")),d.createElement("div",{className:"mcp-installed-empty-btn"},d.createElement(f.Button,{variant:"primary",style:{width:"100%"},onClick:()=>{s.ContainerUtil.get(c.McpViewService).openSettingFile()}},translations("Config MCP Server"))))}},88246:(e,n)=>{"use strict";var a,r;Object.defineProperty(n,"__esModule",{value:!0}),n.InstallStatus=n.TabKey=void 0,function(e){e.Market="1",e.Installed="2"}(a||(n.TabKey=a={})),function(e){e.Installed="installed",e.Installing="installing",e.Uninstalled="uninstalled"}(r||(n.InstallStatus=r={}))},88469:(e,n,a)=>{"use strict";a.r(n)},88604:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getGlobalTheme=void 0;const a=["vscode-dark","vscode-high-contrast"],r=["vscode-light","vscode-high-contrast-light vscode-high-contrast"];n.getGlobalTheme=()=>{const e=document.body.classList.toString();return a.includes(e)?"dark":r.includes(e)?"light":void 0}},88620:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ChatInputEditor=void 0;const c=a(19606),u=s(a(83753)),d=i(a(48431)),f=a(50473),m=a(18196);n.ChatInputEditor=(0,d.forwardRef)(((e,n)=>{const a=(0,c.useIntl)(),r=e.triggers||[],o=(0,d.useRef)(null),l=(0,d.useRef)(null),[i,s]=(0,d.useState)(""),[p,v]=(0,d.useState)(!1),h=(0,d.useCallback)((0,u.default)((e=>e()),100),[]),{invisibleText:g,encodeText:y,getEncodeTextId:b}=(0,m.useInvisibleEncoder)(),cancelEvent=e=>{e.preventDefault(),e.stopPropagation(),s(e.key)},onInput=n=>{e.onInputTextChange(n),o.current.value=n;const a=o.current.selectionStart,l=o.current.selectionEnd;if(a>=0){const{key:i,keyIndex:s}=(e=>{if(!o.current)return;const[n]=r.map((n=>({key:n,keyIndex:o.current.value.lastIndexOf(n,e-1)}))).sort(((e,n)=>n.keyIndex-e.keyIndex));return n})(a),c=((e,n)=>{if(o.current&&-1!==n){const a=o.current.value.substring(n+1,e);if(!/\s/.test(a))return a}})(a,s);if(!(s<1||/\s/.test(n[s-1])))return!1;if(void 0!==c){if(!getMarkerRanges(n).find((e=>e.start<=a&&e.end>=l)))return e.onOpen(i,s,c||""),e.onSearch(c||"",i),!0}}e.onClose()},setInputHeight=()=>{o.current&&(o.current.style.height="auto",o.current.style.height=`${o.current.scrollHeight}px`)},onKeydown=n=>{if(e.mentionKey){if("ArrowDown"===n.key||40===n.keyCode){let a=e.getIndexByArrowDownOrUp(e.selectedIndex,n.key||n.keyCode);a=a>=e.mentionItems.length?0:a,e.onSelectedIndexChange(a),cancelEvent(n)}if("ArrowUp"===n.key||38===n.keyCode){let a=e.getIndexByArrowDownOrUp(e.selectedIndex,n.key||n.keyCode);a=a<0?e.mentionItems.length-1:a,e.onSelectedIndexChange(a),cancelEvent(n)}("Enter"===n.key||"Tab"===n.key||13===n.keyCode||9===n.keyCode)&&e.mentionItems.length>0&&(e.onApply(e.selectedIndex),cancelEvent(n)),"Escape"!==n.key&&27!==n.keyCode||(e.onClose(),cancelEvent(n))}else{"Backspace"!==n.key&&8!==n.keyCode||onBackspace(n),p||n.shiftKey||"Enter"!==n.key&&13!==n.keyCode||(cancelEvent(n),e.onEnter(e.prompt));const a="ArrowLeft"===n.key||37===n.keyCode,r="ArrowRight"===n.key||39===n.keyCode;if(a||r){const{selectionStart:e,selectionEnd:n}=o.current,l=getMarkerRanges().find((a=>a.start<=e&&a.end>=n));l&&(a&&e!==l.start?(o.current.selectionStart=l.start+1,o.current.selectionEnd=l.start+1):r&&n!==l.end&&(o.current.selectionStart=l.end-1,o.current.selectionEnd=l.end-1))}}e.onKeydown(n)},findVariable=(e,n)=>e.type!==f.ChatSelectionInfoType.CONTEXT?e.label===n.value:e.value===(n.value||n.label),removePrompt=(n,a=e.prompt)=>{let r=getContextMarkerRangesForVariables(a).filter(findVariable.bind(this,n));for(;r.length;)a=onBackspace(void 0,{selectionStart:r[0].start,selectionEnd:r[0].end},a)||"",1===r.length&&e.onVariableRecordsChange(e.variableRecords.filter((e=>!findVariable(n,e.value)))),r=getContextMarkerRangesForVariables(a||"").filter(findVariable.bind(this,n));return a},onBackspace=(n,a,r=e.prompt)=>{if(!r)return void e.onRemoveSelections();if(p)return;const{selectionStart:l,selectionEnd:i}=a||o.current,s=getMarkerRanges(r),c=[],u=[];if(s.forEach((e=>{(({start:e,end:n})=>n===l||e>=l&&n<=i||e<=l&&n>=l||e<=i&&n>=i)(e)?c.push(e):u.push(e)})),c.sort(((e,n)=>e.start-n.start)),!c.length)return;e.onSelectionsChange((e=>{for(let n=e.length-1;n>=0;n--){const a=u.some((a=>findVariable(e[n],a))),r=c.findIndex((a=>findVariable(e[n],a)));a||-1===r||e.splice(n,1)}return[...e]}));const d=Math.min(c[0].start,l),f=Math.max(c[c.length-1].end,i),m=r.substring(0,d)+r.substring(f);return e.onInputTextChange(m),e.onClose(),n&&cancelEvent(n),o.current.focus(),o.current.selectionStart=d,o.current.selectionEnd=d,m},escapeHtml=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),getCommandMarkerRangesForVariables=(n=e.prompt)=>{var a;const r=[],o=n.match(/^(?:(?<cmd>\/[\w-_\u4e00-\u9fa5]+)\s?)?(?<prompt>[\s\S]*)/);if(!o)return[];const{groups:{cmd:l}={}}=o;if(l){const o=l.trim().replace(/^\//,"");if(null===(a=e.validCmd)||void 0===a?void 0:a.call(e,o)){const e=n.indexOf(l);r.push({type:f.IMentionType.command,start:e,end:e+l.length,label:o,value:o})}}return r},getContextMarkerRangesForVariables=(n=e.prompt)=>{const a=[];let r=-1;return n.split("@").forEach(((n,o)=>{if(!o&&n||!n)return void(r+=n.length+1);const l=n.length-n.split("").reverse().findIndex((e=>e===g)),i=n.slice(0,l),s=b(i),c=e.variableRecords.find((e=>e.value.id===s));c&&a.push({id:s,type:c.type,start:r,end:r+y(c.value.label,s).length+1,label:c.value.label,value:c.value.value}),r+=n.length+1})),a},getMarkerRanges=(n=e.prompt)=>[...getCommandMarkerRangesForVariables(n),...getContextMarkerRangesForVariables(n)],getPhraseNodes=()=>{const getExpandContent=e=>{const{type:n,value:a}=e;return["terminal"].includes(n)?`@${n}:output`:`@${n}:${a}`},n=[],a=e.prompt,r=[...getMarkerRanges()];return r.sort(((e,n)=>e.start-n.start)),r.reduce(((e,n,r,o)=>{if(0===r)e.push({type:"normal",content:a.substring(0,n.start),expandContent:a.substring(0,n.start)},{type:n.type,content:a.substring(n.start,n.end),expandContent:getExpandContent(n)});else{const l=o[r-1];e.push({type:"normal",content:a.substring(l.end,n.start),expandContent:a.substring(l.end,n.start)},{type:n.type,content:a.substring(n.start,n.end),expandContent:getExpandContent(n)})}return r===o.length-1&&e.push({type:"normal",content:a.substring(n.end),expandContent:a.substring(n.end)}),e}),n),!n.length&&e.prompt&&n.push({type:"normal",content:e.prompt,expandContent:e.prompt}),n};return(0,d.useEffect)((()=>{e.onInputPhraseChange(getPhraseNodes()),h(setInputHeight)}),[e.prompt,e.variableRecords]),(0,d.useEffect)((()=>{const foucsFunc=()=>{var e;"visible"===document.visibilityState&&(null===(e=o.current)||void 0===e||e.focus())};return window.addEventListener("visibilitychange",foucsFunc),()=>window.removeEventListener("visibilitychange",foucsFunc)}),[]),(0,d.useImperativeHandle)(n,(()=>({removePrompt,onInput:e=>onInput(e),onKeydown,focus:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()},setSelectionStart:e=>o.current.selectionStart=e,setSelectionEnd:e=>o.current.selectionEnd=e,get value(){var e;return(null===(e=o.current)||void 0===e?void 0:e.value)||""},get phrase(){return getPhraseNodes()}}))),d.default.createElement("div",{className:"control-wrapper"},d.default.createElement("div",{ref:l,className:"shadow-textarea"},d.default.createElement((()=>{if(e.followingPlaceholder)return"function"==typeof e.followingPlaceholder?e.followingPlaceholder():e.followingPlaceholder;const n="_$_keep_$_",a=e.prompt,r=[...getMarkerRanges()];r.sort(((e,n)=>e.start-n.start));const o=r.reduce(((e,r,o,l)=>{if(0===o)e.push(escapeHtml(a.substring(0,r.start))),e.push(d.default.createElement("span",{className:"marker",type:`${r.type}`,key:`marker-${o}`},escapeHtml(a.substring(r.start,r.end))));else{const n=l[o-1];e.push(escapeHtml(a.substring(n.end,r.start))),e.push(d.default.createElement("span",{className:"marker",type:`${r.type}`,key:`marker-${o}`},escapeHtml(a.substring(r.start,r.end))))}if(o===l.length-1){const l=escapeHtml(a.substring(r.end));/\n$/.test(l)?(e.push(l.replace(/\n$/,"")),e.push(d.default.createElement("div",{key:`wrap1-${o}`},n)),e.push("\n"),e.push(d.default.createElement("div",{key:`wrap2-${o}`},n))):e.push(l)}return e}),[]),l=o.filter((e=>{var n;return!(null===(n=null==e?void 0:e.props)||void 0===n?void 0:n.type)})).join("").trim();return(""===l||l===n)&&o.push(d.default.createElement("span",{className:"virtual-placeholder",key:"virtual-placeholder"},d.default.createElement("span",null,""))),o}),null)),d.default.createElement("textarea",{maxLength:e.maxLength,autoFocus:e.autoFocus,className:"control",ref:o,value:e.prompt,placeholder:(e=>{try{return a.formatMessage({id:e})}catch(n){return e}})('Please enter a question, or enter "/" to use shortcut commands'),onKeyDown:onKeydown,onKeyUp:e=>{i&&e.key===i&&cancelEvent(e),s("")},onScroll:e=>{null==e||e.stopPropagation();const n=o.current.scrollTop;l.current.scrollTop=n||0},onInput:e=>onInput(e.target.value),onCompositionStart:()=>v(!0),onCompositionEnd:()=>v(!1)}))}))},88891:function(e,n,a){"use strict";var r,o=a(78),l=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),i=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),s=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},c=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),o=0;o<a.length;o++)"default"!==a[o]&&l(n,e,a[o]);return i(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.Messages=Messages,a(81634);const u=a(398),d=a(15985),f=a(59659),m=a(69022),p=a(19606),v=c(a(48431)),h=a(63306),g=a(99095),y=a(32134),b=a(25380),_=a(4882),C=a(75006),E=a(39941),w=a(63565),O=50;function createPendingMessage(){return{requestId:"",complete:!1,content:[],createTime:0,id:"",messageType:u.MessageType.ASSISTANT,conversationId:""}}function Messages(){const e=d.ContainerUtil.get(m.ChatViewService),n=d.ContainerUtil.get(m.CheckpointViewService),{conversationState:{conversation:a,pendingMessages:r},getCurrentConversation:l}=(0,v.useContext)(y.ConversationContext),{triggerChatState:i,chatState:s,chatStateRef:c}=(0,b.useChatState)(),[f,h]=(0,v.useState)([]),[M,S]=(0,v.useState)(void 0),[P,T]=(0,v.useState)(!1),[j,k]=(0,v.useState)(!1),[I,N]=(0,v.useState)(0),[x,D]=(0,v.useState)([]),[R,L]=(0,v.useState)(!1),A=(0,v.useRef)(null),F=(0,v.useRef)(null),V=(0,v.useRef)([]),B=(0,v.useRef)(void 0),U=(0,v.useRef)(void 0),W=(0,v.useRef)({autoScroll:!0,trust:!0}),H=(0,v.useRef)({lock:!1,scrollHeight:0}),G=(0,v.useRef)(0),q=(0,v.useRef)(!1),$=(0,v.useRef)(void 0),X=(0,v.useRef)(void 0),K=(0,v.useRef)(""),z=(0,v.useRef)(void 0),Z=(0,b.useLogger)("Messages"),J=(0,v.useCallback)((()=>{var e;if(!A.current)return;const n=A.current,a=n.scrollTop,r=null===(e=n.querySelector("#chat-message-inner"))||void 0===e?void 0:e.children[1];r&&($.current={element:r,offset:r.offsetTop-a})}),[]),Y=(0,v.useCallback)((()=>{if(!A.current||!$.current)return;const{element:e,offset:n}=$.current;A.current.scrollTo({top:Math.max(0,e.offsetTop-n),behavior:"instant"}),$.current=void 0}),[]),Q=(0,v.useCallback)((async()=>{if(!q.current&&j&&(null==a?void 0:a.id)){q.current=!0,T(!0),J();try{const n=await e.getMessagesPaginated(3,X.current,a.id);if(n.lastRequestId&&(X.current=n.lastRequestId),n.messages.length>0){const e=V.current,a=n.messages,r=[...a.filter((n=>!e.some((e=>e.id===n.id)))),...e];V.current=r,requestAnimationFrame((()=>{h(r),k(n.hasMore),requestAnimationFrame(Y)}))}else k(!1)}catch(e){o.error("Failed to load more messages:",e)}finally{q.current=!1,T(!1)}}}),[j,null==a?void 0:a.id,e,J,Y]),ee=(0,v.useCallback)(((e=[])=>{e.forEach((e=>{e.type===m.AssistantMessageContentType.TOOL_CALL&&w.ToolUtils.isToolCallRunning(e.tool.status)&&(e.tool.status=m.ToolStatus.CANCELLED)}))}),[]),showThinking=(e,n)=>{var a,r;if(e.isEnd)return!1;const o=null===(a=null==e?void 0:e.content)||void 0===a?void 0:a.find((e=>e.type===m.AssistantMessageContentType.TOOL_CALL&&!w.ToolUtils.isToolCallEnd(e.tool.status)));if(e.complete&&!o)return!n;const l=!!(null===(r=null==e?void 0:e.content)||void 0===r?void 0:r.find((e=>e.type===m.AssistantMessageContentType.TOOL_CALL&&!e.tool.ready)));return o&&l?!n:!!n&&(!o&&!l)},te=(0,v.useCallback)((e=>{clearTimeout(z.current),e.messageType===u.MessageType.ASSISTANT&&(z.current=window.setTimeout((()=>{var n,a,r,o;""!==(null===(n=B.current)||void 0===n?void 0:n.id)&&c.current!==m.ChatState.IDLE&&(null===(r=null===(a=B.current)||void 0===a?void 0:a.content)||void 0===r?void 0:r.length)&&showThinking(e,!0)&&((null===(o=B.current)||void 0===o?void 0:o.id)&&(V.current=[...V.current,B.current],h(V.current)),ne())}),1e3))}),[]),ne=(0,v.useCallback)((()=>{B.current=createPendingMessage(),S(B.current)}),[]),ae=(0,v.useCallback)(((e,a=!1)=>{var r;const o=[];let i=!1;const s=e||(null===(r=x.find((e=>e.isDiscarded)))||void 0===r?void 0:r.requestId);s&&(V.current=V.current.filter((e=>{const r=e.requestId;return!o.includes(r)&&(r===s?i=!0:a&&(i=!1),!i||(n.deleteRequest(r),o.push(r),!1))})),h(V.current),a&&N(0),!V.current.length&&a&&l(),n.clearDiscardedVersions())}),[x,n]),re=(0,v.useCallback)((e=>{const n=V.current.findIndex((n=>n.id===e));n>-1&&(V.current.splice(n,1),h(V.current))}),[]),oe=(0,v.useCallback)(((e=!1,n="instant")=>{var a;A.current&&(W.current.autoScroll||e)&&(W.current.trust=e,null===(a=A.current)||void 0===a||a.scrollTo({top:A.current.scrollHeight,behavior:n}))}),[]),le=(0,v.useCallback)((e=>{const n=e.currentTarget,a=n.scrollTop,r=n.clientHeight,o=n.scrollHeight-n.scrollTop-r;if(L(o>r),H.current.lock&&a+r+5>=H.current.scrollHeight&&(setTimeout((()=>oe(!0)),100),H.current.lock=!1),!W.current.trust)return void(W.current.trust=!0);const l=a<G.current;a<=O&&j&&!q.current&&Q(),!l&&Math.abs(o)<10?W.current.autoScroll=!0:l&&o>20&&(W.current.autoScroll=!1),G.current=a}),[j,Q]),ie=(0,v.useCallback)(((e=!1)=>{var n,a;const r=[];let o=null===(n=B.current)||void 0===n?void 0:n.content;if(null==o?void 0:o.length)ee(o);else{const e=V.current[V.current.length-1];(null==e?void 0:e.messageType)===u.MessageType.ASSISTANT&&(o=e.content,ee(o),V.current[V.current.length-1]=JSON.parse(JSON.stringify(e)))}return(null===(a=B.current)||void 0===a?void 0:a.id)&&r.push({...B.current,complete:!0}),B.current=void 0,e&&(V.current=[...V.current,...r],h(V.current),S(B.current)),r}),[]),se=(0,v.useCallback)((()=>{clearTimeout(z.current),ie(!0)}),[]),ce=(0,v.useCallback)((e=>{var n;const a=V.current.findIndex((n=>n.id===e.id));if(-1!==a&&[u.MessageType.USER,u.MessageType.SYSTEM].includes(e.messageType))return;let r=!1,o=[];if(e.messageType===u.MessageType.USER)ae(),o.push(e),B.current=createPendingMessage();else if(e.messageType===u.MessageType.SYSTEM){try{Z.info(`system message ${JSON.stringify(e)}`,"updateMessage")}catch(e){}o=ie(),o.push(e)}else if(e.messageType===u.MessageType.ASSISTANT){const l=showThinking(e),i=e.isEnd||e.complete;-1!==a?(V.current[a]=e,r=!0,B.current=l?createPendingMessage():void 0):i||l?(o.push(e),B.current=l?createPendingMessage():void 0):((null===(n=B.current)||void 0===n?void 0:n.id)&&B.current.id!==e.id&&o.push({...B.current,complete:!0}),B.current=e)}S(B.current),(o.length||r)&&(V.current=[...V.current,...o],h(V.current)),setTimeout((()=>{e.messageType===u.MessageType.USER&&ue(),oe()}),100)}),[ae]),ue=(0,v.useCallback)((()=>{if(!(null==A?void 0:A.current)||!F.current)return;const e=F.current.querySelectorAll(".user-message");let n=e[e.length-1],a=0;for(;n;)a+=n.offsetHeight,n=n.nextElementSibling;N(A.current.offsetHeight+F.current.offsetHeight-a),A.current.dispatchEvent(new Event("scroll")),setTimeout((()=>oe(!0,"smooth")),100)}),[oe]);(0,v.useEffect)((()=>{const n=e.messageObserver.subscribe((e=>{const n=!K.current||K.current===e.requestId;n&&e.isEnd&&(K.current=""),e.conversationId===(null==a?void 0:a.id)&&[m.ChatState.TALKING,m.ChatState.PLAN].includes(c.current)&&n&&(e.isEnd&&i(m.ChatStateEvent.STOP),K.current=e.requestId,ce(e),te(e))}));return()=>n.unsubscribe()}),[a,ce,te]),(0,v.useEffect)((()=>{s===m.ChatState.TALKING?ne():s===m.ChatState.IDLE&&(se(),K.current="")}),[s]),(0,v.useEffect)((()=>{const e=n.versionsObserver.subscribe((e=>{D(e)}));return()=>e.unsubscribe()}),[]),(0,v.useEffect)((()=>{var e,n;if((null===(e=U.current)||void 0===e?void 0:e.id)===(null==a?void 0:a.id))return;const o=(null==a?void 0:a.messages)||[];if((null==r?void 0:r.length)&&(o.push(...r),(null===(n=o[o.length-1])||void 0===n?void 0:n.isEnd)||ne()),X.current=void 0,V.current=o,h(o),k(o.length>=3),o.length>0){const e=o[0];X.current=e.requestId}U.current=a}),[a,r,oe]),(0,v.useEffect)((()=>{const e=Date.now(),n=new ResizeObserver((n=>{Date.now()-e>500||setTimeout((()=>oe(!0)),100)}));return F.current&&n.observe(F.current),()=>n.disconnect()}),[]);const de=(0,v.useMemo)((()=>({messages:f,pendingMessage:M,allVersions:x,deleteRun:ae,deleteMessage:re})),[f,M,x,ae]);return v.default.createElement("div",{className:"chat-message-container"},a&&v.default.createElement("div",{className:"chat-message",ref:A,onScroll:le},v.default.createElement("div",{id:"chat-message-box",className:"chat-message-box",style:{minHeight:I+"px"}},v.default.createElement("div",{id:"chat-message-inner",ref:F},P&&v.default.createElement("div",{className:"load-more-indicator"},v.default.createElement("div",{className:"load-more-spinner"}),v.default.createElement("span",null,v.default.createElement(p.FormattedMessage,{id:"Loading history messages"}))),v.default.createElement(_.CurrentConversationContext.Provider,{value:de},v.default.createElement(g.HighlightCodeContext,null,v.default.createElement(C.MessageRenderer,null)))))),v.default.createElement("div",{className:"chat-message-bottom-toolbar "+(R?"show":"")},v.default.createElement("div",{className:"chat-message-bottom-toolbar-item",onClick:()=>{var e;H.current={lock:!0,scrollHeight:(null===(e=null==A?void 0:A.current)||void 0===e?void 0:e.scrollHeight)||0},oe(!0,"smooth")}},v.default.createElement(E.ArrowIcon,{className:"chat-message-bottom-toolbar-icon"}))))}let M=class{};M=s([(0,f.Widget)({area:h.ChatBodyConversionArea.Messages,component:Messages})],M),n.default=M},89200:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SystemMessageRenderer=void 0,a(60528);const u=a(398),d=a(15985),f=a(69022),m=a(19606),p=s(a(48431)),v=a(99095),h=a(25380),g=c(a(6949)),y=a(73e3),b=a(4882),_=a(4841),C=a(58271),E=a(66319),w=a(43053),O=a(31055),M=a(40908);let S=class SystemMessageRenderer{canHandle(e){return e.messageType===u.MessageType.SYSTEM&&e.error?10:0}render(e,n,a){return p.default.createElement(P,{message:e,conversation:n,config:a})}};n.SystemMessageRenderer=S,n.SystemMessageRenderer=S=i([(0,d.Component)(_.ChatMessageRenderer)],S);const P=(0,p.memo)((e=>{var n,a,r,o,l,i,s,c;const _=(0,m.useIntl)(),t=e=>_.formatMessage({id:e}),S=d.ContainerUtil.get(f.ChatViewService),{conversation:P,message:T,config:j}=e,k=(0,M.createErrorMessages)(t),I=k[`${null===(n=T.error)||void 0===n?void 0:n.code}`]||k.DEFAULT,N=(0,p.useContext)(v.GlobalContext),{deleteMessage:x}=(0,p.useContext)(b.CurrentConversationContext),{triggerChatState:D,chatState:R}=(0,h.useChatState)(),L=(0,p.useCallback)((()=>{const e=[...P.messages].reverse().find((e=>e.messageType===u.MessageType.USER));null==N||N.setGlobalState({...(null==N?void 0:N.globalState)||{},mode:f.ChatType.ASK}),y.chatActionSubject.next({chatType:f.ChatType.ASK,prompt:(null==e?void 0:e.content)||""})}),[N]),A=(0,p.useCallback)((()=>{R!==f.ChatState.TALKING&&(S.retry(P.id),D(f.ChatStateEvent.RETRY),null==x||x(T.id))}),[T,R]);return p.default.createElement(p.default.Fragment,{key:`error-message-${T.id}`},I&&!I.hide&&p.default.createElement("div",{className:"error-message-container"},p.default.createElement("div",{className:"assistant-message craft-error-message"},(null==j?void 0:j.isShowTitle)&&p.default.createElement("div",{className:"assistant-message__title"},p.default.createElement(E.Avatar,null)),p.default.createElement("div",{className:"craft-error-message__content"},p.default.createElement("div",{className:"craft-error-message__content__block"},p.default.createElement("div",{className:"error-title"},p.default.createElement("span",{className:"error-icon"},"error"===I.level?p.default.createElement(w.ErrorIcon,null):p.default.createElement(O.WarnIcon,null)),p.default.createElement("span",null,I.title,"(Code: ",null!==(r=null===(a=T.error)||void 0===a?void 0:a.code)&&void 0!==r?r:0,")")),I.subTitle&&p.default.createElement("div",{className:"error-sub-title"},I.subTitle),!!(null===(o=T.error)||void 0===o?void 0:o.requestId)&&!I.hideRequestId&&p.default.createElement("div",{className:"requestid"},"Request ID: ",(null===(l=T.error)||void 0===l?void 0:l.requestId)||""," / ",(null===(i=T.error)||void 0===i?void 0:i.traceId)||"",p.default.createElement(C.Copy,{content:`${(null===(s=T.error)||void 0===s?void 0:s.requestId)||""}/${(null===(c=null==T?void 0:T.error)||void 0===c?void 0:c.traceId)||""}`})),p.default.createElement("div",{className:"craft-error-tools"},I.tools.map((e=>p.default.createElement(p.default.Fragment,{key:`error-message-tool-${T.id}`},"toChat"===e&&(null==N?void 0:N.globalState.mode)===f.ChatType.CRAFT&&p.default.createElement(g.default,{btnText:t("Switch to Ask Mode"),onClick:L}),"retry"===e&&p.default.createElement(g.default,{type:"primary",btnText:t("Retry"),onClick:A}),"retry-text"===e&&p.default.createElement("span",{onClick:A},t("Retry")))))))))))}))},89317:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.RejectIcon=void 0;const o=r(a(48431));n.RejectIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:e,style:n,...a},o.default.createElement("path",{d:"M12.5 3.5L3.5 12.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),o.default.createElement("path",{d:"M12.5 12.5L3.5 3.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}))},89655:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.MovingBorder=void 0;const s=a(57254),c=i(a(48431));n.MovingBorder=({children:e,duration:n=2e3,rx:a,ry:r,...o})=>{const l=(0,c.useRef)(null),i=(0,s.useMotionValue)(0),u=(0,c.useRef)(!0);(0,c.useEffect)((()=>()=>{u.current=!1}),[]),(0,s.useAnimationFrame)((e=>{var a;if(!u.current)return;const r=null===(a=l.current)||void 0===a?void 0:a.getTotalLength();if(r){const a=r/n;i.set(e*a%r)}}));const d=(0,s.useTransform)(i,(e=>{var n,a;try{return(null===(a=null===(n=l.current)||void 0===n?void 0:n.getPointAtLength(e))||void 0===a?void 0:a.x)||0}catch(e){return 0}})),f=(0,s.useTransform)(i,(e=>{var n,a;try{return(null===(a=null===(n=l.current)||void 0===n?void 0:n.getPointAtLength(e))||void 0===a?void 0:a.y)||0}catch(e){return 0}})),m=s.useMotionTemplate`translateX(${d}px) translateY(${f}px) translateX(-50%) translateY(-50%)`;return c.default.createElement(c.default.Fragment,null,c.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",style:{position:"absolute",top:0,left:0,bottom:0,right:0},width:"100%",height:"100%",...o},c.default.createElement("rect",{fill:"none",width:"100%",height:"100%",rx:a,ry:r,ref:l})),c.default.createElement(s.motion.div,{style:{position:"absolute",top:0,left:0,display:"inline-block",transform:m}},e))}},90194:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.ChatDropFile=function ChatDropFile(){const e=s.ContainerUtil.get(f.ChatInputController),[n,a]=(0,u.useState)(!1),r=(0,u.useRef)(null),o=(0,c.useIntl)(),t=e=>{try{return o.formatMessage({id:e})}catch(n){return e}};return(0,u.useEffect)((()=>{var n;const drop=n=>{var r,o;a(!1);const l=(null===(r=n.dataTransfer)||void 0===r?void 0:r.getData("application/vnd.code.uri-list"))||"",i=(null===(o=n.dataTransfer)||void 0===o?void 0:o.getData("resourceurls"))||"",s=(l?l.split(/\r\n?|\n/):d.JsonUtils.safeParse(i))||[];s.length&&e.triggerAddToChat(s)},dragenter=e=>{e.shiftKey&&a(!0)};function dragleave(e){var n;(null===(n=r.current)||void 0===n?void 0:n.contains(e.relatedTarget))||a(!1)}return document.body.addEventListener("drop",drop),document.body.addEventListener("dragenter",dragenter),null===(n=r.current)||void 0===n||n.addEventListener("dragleave",dragleave),()=>{var e;document.body.removeEventListener("drop",drop),document.body.removeEventListener("dragenter",dragenter),null===(e=r.current)||void 0===e||e.removeEventListener("dragleave",dragleave)}}),[]),u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{ref:r,className:["chat-drop-file",n?"chat-drop-file-visible":""].join(" ")},u.default.createElement("div",null,u.default.createElement("span",null,t("Hold down")),u.default.createElement("span",{className:"chat-drop-btn-tip"},"Shift"),u.default.createElement("span",null,t("Add to input box")))))},a(5176);const s=a(15985),c=a(19606),u=i(a(48431)),d=a(20421),f=a(50473)},90456:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.CopiedIcon=void 0;const o=r(a(48431));n.CopiedIcon=({className:e,style:n,...a})=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:e,style:n,...a},o.default.createElement("path",{d:"M13.2997 4.45597C13.5519 4.28973 13.8951 4.31806 14.1171 4.53995C14.3705 4.79373 14.3705 5.20516 14.1171 5.45889L7.0458 12.5302L6.94424 12.6142C6.92674 12.6257 6.90687 12.6328 6.88857 12.6425C6.87159 12.6515 6.85534 12.6615 6.83779 12.6689C6.82472 12.6743 6.81109 12.6779 6.79775 12.6825C6.77353 12.6909 6.74938 12.6986 6.72451 12.704C6.70769 12.7077 6.69074 12.7095 6.67373 12.7118C6.65192 12.7148 6.63026 12.7169 6.6083 12.7177C6.59131 12.7183 6.5745 12.7184 6.55752 12.7177C6.53457 12.7167 6.51192 12.7143 6.48916 12.7108C6.47275 12.7084 6.45654 12.7058 6.44033 12.7021C6.41742 12.6968 6.39529 12.6893 6.37295 12.6816C6.35687 12.676 6.34078 12.6708 6.32509 12.664C6.30911 12.657 6.29371 12.6489 6.27822 12.6405C6.22396 12.6113 6.17168 12.576 6.12588 12.5302L1.88369 8.288L2.34365 7.82804L2.80263 7.36807L6.58584 11.1513L13.1972 4.53995L13.2997 4.45597ZM1.88369 7.36807C2.13744 7.11473 2.54889 7.11473 2.80263 7.36807L1.88369 8.288C1.62995 8.03415 1.62988 7.62188 1.88369 7.36807Z",fill:"currentColor"}))},91015:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CurrentToolContext=void 0;const r=a(48431);n.CurrentToolContext=(0,r.createContext)({})},91020:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(69083),n)},91713:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.TencentChatModel=void 0;const l=a(398),i=a(88873),s=a(15985),c=a(98494),u=a(63066);let d=class TencentChatModel extends i.OpenAIChatModel{};n.TencentChatModel=d,r([(0,s.Autowired)(u.TencentChatOptions),o("design:type",u.TencentChatOptions)],d.prototype,"defaultOptions",void 0),r([(0,s.Autowired)(c.TencentAPI),o("design:type",Object)],d.prototype,"chatApi",void 0),n.TencentChatModel=d=r([(0,s.Component)(l.ChatModel)],d)},91722:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.PromptManagerImpl=void 0;const l=a(15985),i=a(75645);let s=class PromptManagerImpl{constructor(){this.promptProviders=[],this.promptEvaluators=[],this.promptRenderers=[],this.promptTemplateMap=new Map}initialize(){this.doInitialize()}async get(e,n){n||(n={});const a=this.promptTemplateMap.get(e)||[];if(0===a.length)return;let r=a[0];const o=await this.getEvaluator(n);if(o){const e=await this.evaluatePromptTemplates(a,n,o);e&&(r=e)}return r}async render(e,n){const a=await this.getRenderer(n);return a?a.render(e,n):e}async doInitialize(){for(const e of this.promptProviders)e.productTemplateSubject.subscribe((()=>{this.loadPrompts()}))}async loadPrompts(){var e,n;if(this.promptTemplateMap.clear(),null===(e=this.promptProviders)||void 0===e?void 0:e.length)for(const e of this.promptProviders){const a=await e.productTemplateSubject.getValue();if(a)for(const e of a)this.promptTemplateMap.has(e.name)||this.promptTemplateMap.set(e.name,[]),null===(n=this.promptTemplateMap.get(e.name))||void 0===n||n.push(e)}}async evaluatePromptTemplates(e,n,a){if(0===e.length)return;if(await a.priority(n)<=0)return;let r,o=0;for(const l of e){const e=await a.evaluate(l,n);e>o&&(o=e,r=l)}return o<=0?void 0:r}async getEvaluator(e){return(await l.Prioritizeable.prioritizeAll(this.promptEvaluators,(async n=>{try{return await n.priority(e)}catch(e){return 0}}))).filter((e=>e.priority>0)).map((e=>e.value))[0]}async getRenderer(e){return(await l.Prioritizeable.prioritizeAll(this.promptRenderers,(async n=>{try{return await n.priority(e)}catch(e){return 0}}))).filter((e=>e.priority>0)).map((e=>e.value))[0]}};n.PromptManagerImpl=s,r([(0,l.Autowired)(i.PromptProvider),(0,l.Optional)(),o("design:type",Array)],s.prototype,"promptProviders",void 0),r([(0,l.Autowired)(i.PromptEvaluator),o("design:type",Array)],s.prototype,"promptEvaluators",void 0),r([(0,l.Autowired)(i.PromptRenderer),o("design:type",Array)],s.prototype,"promptRenderers",void 0),n.PromptManagerImpl=s=r([(0,l.Component)(i.PromptManager,l.ApplicationLifecycle)],s)},91963:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.useWebviewStatus=function useWebviewStatus(){const e=o.ContainerUtil.get(l.ChatViewService);i.default.useEffect((()=>{setTimeout((()=>{e.handleWebviewReady()}))}),[])};const o=a(15985),l=a(69022),i=r(a(48431))},92545:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),a(94003);const c=a(15985),u=a(69022),d=a(19606),f=s(a(73059)),m=i(a(48431)),p=a(15389),v=a(46141),h=a(48924),g=s(a(63235)),y=a(25380),b=a(73e3),_=s(a(883)),C=s(a(60247)),E=s(a(17030)),w=s(a(85126)),O=a(88246),M=s(a(3760)),S=s(a(73257)),P=a(92820);n.default=({onChange:e,isUpdate:n})=>{var a;const{data:r,fetchMarketServers:o}=(0,P.useMarketServers)(),{eventMap:l,report:i}=(0,y.useDataReport)(),[s,T]=(0,m.useState)({}),[j,k]=(0,m.useState)(r.items),[I,N]=(0,m.useState)(!1),[x,D]=(0,m.useState)(!1),[R,L]=(0,m.useState)(!1),[A,F]=(0,m.useState)({}),[V,B]=(0,m.useState)({}),U=(0,p.useNavigate)(),[W]=(0,p.useSearchParams)(),H=W.get("name"),[G,q]=(0,m.useState)(""),$=(0,d.useIntl)(),translations=e=>$.formatMessage({id:e});let X;const K=c.ContainerUtil.get(u.McpViewService),[z,Z]=(0,m.useState)(!1),[J,Y]=(0,m.useState)([]);(0,m.useEffect)((()=>{(async()=>{I||x||!n||await o()})()}),[I,x,n]),(0,m.useEffect)((()=>{const e=K.mcpInstallMessage.subscribe((e=>{T(e)}));return()=>e.unsubscribe()}),[]),(0,m.useEffect)((()=>{k(r.items)}),[r]),(0,m.useEffect)((()=>{H&&(G.length>0&&search(G),autoInstallServer(H,W.get("mcpConf")))}),[H]);const Q=(0,m.useMemo)((()=>{var e,n;return((null===(n=null===(e=$.locale)||void 0===e?void 0:e.toLowerCase)||void 0===n?void 0:n.call(e))||"zh-cn").startsWith("zh")}),[null==$?void 0:$.locale]),ee=(0,m.useMemo)((()=>{const e=r.items.flatMap((e=>Q?(null==e?void 0:e.categories)||[]:(null==e?void 0:e.categories_en)||[]));return Array.from(new Set(e.filter(Boolean)))}),[r,Q]),autoInstallServer=async(e,n)=>{search(e),await K.install(decodeURIComponent(e)),b.chatActionSubject.next(JSON.parse(n)),U("/"),await o()},search=e=>{q(e)},installMcpServer=async n=>{var a;if(j.some((e=>e.installStatus===O.InstallStatus.Installing)))return void g.default.error($.formatMessage({id:"There is a server installation in progress, please wait for it to complete before installing another server."}));k(j.map((e=>({...e,installStatus:e.name===n?"installing":e.installStatus}))));const r=await K.getMcpServer(n);try{await K.install(n);const o=!!(null===(a=null==r?void 0:r.install_commands)||void 0===a?void 0:a.env);L(o),F(r),e(O.TabKey.Installed),i(l.McpServerAction,{id:(null==r?void 0:r.mcpid)||"",name:n,action:"install",actionSuccessful:!0,isOfficial:/^mcp01/.test((null==r?void 0:r.mcpid)||"")},{})}catch(e){try{B(JSON.parse(e.message))}catch(e){return g.default.error($.formatMessage({id:"Failed to install the server, please install again"})),void await o()}N(!0),i(l.McpServerAction,{id:(null==r?void 0:r.mcpid)||"",name:n,action:"install",actionSuccessful:!1,isOfficial:/^mcp01/.test((null==r?void 0:r.mcpid)||"")},{})}},handleCategoryClick=e=>{Y((n=>n.includes(e)?n.filter((n=>n!==e)):[...n,e]))},te=(0,m.useMemo)((()=>{const e=Q?"categories":"categories_en",n=new Set(J);return J.length>0?G?j.filter((a=>{var r;return a.name.toLowerCase().includes(G.toLowerCase())&&(null===(r=a[e])||void 0===r?void 0:r.some((e=>n.has(e))))})):j.filter((a=>{var r;return null===(r=a[e])||void 0===r?void 0:r.some((e=>n.has(e)))})):G?j.filter((e=>e.name.toLowerCase().includes(G.toLowerCase()))):j}),[G,J,Q,j]);return m.default.createElement("div",{className:"code-buddy-mcp-market"},m.default.createElement("div",{className:"code-buddy-mcp-market-search"},m.default.createElement(_.default,{prefix:m.default.createElement("div",{className:"code-buddy-mcp-market-search-icon"},m.default.createElement(d.Icon,{name:d.SvgIconName.SearchIcon})),placeholder:translations("Search Mcp Server in the store"),value:G,onChange:e=>search(e.target.value)}),(null==ee?void 0:ee.length)>0&&m.default.createElement("div",{className:(0,f.default)("code-buddy-mcp-market-filter",J.length>0&&"pointer"),onClick:()=>Z((e=>!e))},m.default.createElement(h.FilterIcon,null))),m.default.createElement("div",{className:"code-buddy-mcp-market-category"},!z&&J.length>0&&m.default.createElement("span",{className:"code-buddy-mcp-market-category-filter"},translations("Filter")," (",ee.length,") :"),z?ee.map((e=>m.default.createElement(v.Button,{key:e,variant:J.includes(e)?"primary":"secondary",size:"small",onClick:()=>handleCategoryClick(e)},e))):J.length>0?null==J?void 0:J.map((e=>m.default.createElement("div",{key:e,className:"code-buddy-mcp-market-category-item"},m.default.createElement("span",null,e),m.default.createElement(h.CloseIcon,{className:"code-buddy-mcp-market-category-item-icon",onClick:()=>handleCategoryClick(e)})))):""),m.default.createElement("div",{className:"code-buddy-mcp-market-content"},te.map((e=>m.default.createElement("div",{key:e.name+e.id,className:"code-buddy-mcp-market-item"},m.default.createElement(M.default,{...e,installMcpServer})))),m.default.createElement(S.default,null)),m.default.createElement(E.default,{visible:I,title:V.errorMsg,content:V.tipsMsg,onOk:async()=>{N(!1),D(!0),await(async e=>{N(!1);const{cancel:n}=await K.manualInstallation(e);X=n,D(!0)})(V.name)},installGuide:()=>{K.openExternal("https://cloud.tencent.com/document/product/1749/116012#ccc95d49-1377-4e5f-9ffe-e9e61da1a72c"),N(!1)},onCancel:()=>N(!1)}),m.default.createElement(w.default,{visible:x,title:s.name,content:s.output,onCancel:()=>{D(!1),null==X||X()},onOk:()=>D(!1)}),m.default.createElement(C.default,{visible:R,title:A.name,env:(null===(a=A.install_commands)||void 0===a?void 0:a.env)||{},onRun:e=>(async e=>{await K.updateConfigEnv(A.name,{...A.env,...e});const n={chatType:u.ChatType.CRAFT,prompt:`${A.name} ${translations("MCP Server has been installed successfully, and the function of the server can be demonstrated by using one of the tools provided by the server")}`,codebase:!1,options:{autoSend:!0,newChat:!0}};b.chatActionSubject.next(n),L(!1),U("/")})(e),onSave:e=>(async e=>{await K.updateConfigEnv(A.name,{...A.env,...e}),L(!1)})(e),onClose:()=>L(!1)}))}},92820:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useMarketServers=void 0;const r=a(15985),o=a(69022),l=a(48431);n.useMarketServers=()=>{const[e,n]=(0,l.useState)({commitUrl:"",installTemplate:"",items:[]}),fetchMarketServers=async()=>{const e=r.ContainerUtil.get(o.McpViewService),a=await e.getMcpMarket();a&&n(a)};return(0,l.useEffect)((()=>{fetchMarketServers()}),[]),{data:e,fetchMarketServers}}},92930:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(87298),n)},93074:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.TencentAPIImpl=void 0;const l=a(398),i=a(88873),s=a(15985),c=a(56464),u=a(45157),d=a(90905),f=a(27643);let m=class TencentAPIImpl extends i.OpenAIAPIImpl{init(){super.init(),this.finalApiOptions={url:"",baseUrl:"https://copilot.tencent.com",apiKey:"",codeCompletionsPath:"/v2/completions",completionsPath:"/v2/chat/completions",embeddingsPath:"/v2/embeddings",...this.apiOptions,...this.apiOptions2}}async streamingCode(e,n){var a;s.Assert.isTrue(!!e.stream,"Request must set the stream property to true.");const r=Date.now(),o=await this.restOperations.post(this.finalApiOptions.url||this.finalApiOptions.codeCompletionsPath,(0,u.instanceToPlain)(e),{baseURL:this.finalApiOptions.baseUrl,headers:{...this.finalHeaders,[c.HttpHeaders.ACCEPT]:c.MediaType.TEXT_EVENT_STREAM,...n},signal:e.signal,responseType:"stream"});if(null===(a=e.signal)||void 0===a?void 0:a.aborted)throw new Error("canceled");const i=[],{data:m,headers:p,status:v}=o;return l.SSEUtil.toObservable(m).pipe((0,d.map)((e=>{i.push(Date.now()-r);const n=(0,u.plainToInstance)(f.CodeCompletion,e.data);return n.costs=i,{status:v,headers:p,body:n}})))}};n.TencentAPIImpl=m,r([(0,s.Value)("genie.models.api"),o("design:type",Object)],m.prototype,"apiOptions",void 0),r([(0,s.Autowired)(f.TencentAPIOptions),(0,s.Optional)(),o("design:type",Object)],m.prototype,"apiOptions2",void 0),r([(0,s.PostConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],m.prototype,"init",null),n.TencentAPIImpl=m=r([(0,s.Component)(f.TencentAPI)],m)},93108:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AgentDispatcher=n.AgentManager=n.InvokableAgent=void 0,n.InvokableAgent=Symbol("InvokableAgent"),n.AgentManager=Symbol("AgentManager"),n.AgentDispatcher=Symbol("AgentDispatcher")},93285:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LOG_LOGIN=n.LOG_MCP=n.LOG_CHAT_HISTORY=n.LOG_CHAT=void 0,n.LOG_CHAT="Chat",n.LOG_CHAT_HISTORY="ChatHistory",n.LOG_MCP="Mcp",n.LOG_LOGIN="Login"},93660:(e,n,a)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useLogger=void 0;const r=a(48431),o=a(20421);n.useLogger=e=>(0,r.useMemo)((()=>(0,o.createLogger)(e)),[])},93737:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.TencentCodeCompletionModel=void 0;const l=a(398),i=a(15985),s=a(56464),c=a(90905),u=a(98494),d=a(76503),f=a(69103);let m=class TencentCodeCompletionModel{buildGeneration(e){var n;const a=null!==(n=e.finishReason)&&void 0!==n?n:"",r=d.CodeCompletionGenerationMetadata.from(a);return{output:e.text,metadata:r}}buildCodeCompletionResponseMetadataByResult(e,n,a=l.RateLimit.createEmpty()){var r,o,i,s,c;return d.CodeCompletionResponseMetadata.builder().id(null!==(r=e.id)&&void 0!==r?r:"").usage(n).model(null!==(o=e.model)&&void 0!==o?o:"").costs(null!==(i=e.costs)&&void 0!==i?i:[]).keyValue("created",null!==(s=e.created)&&void 0!==s?s:0).keyValue("system-fingerprint",null!==(c=e.systemFingerprint)&&void 0!==c?c:"").rateLimit(a).build()}buildCodeCompletionResponseMetadata(e,n){var a,r,o;return d.CodeCompletionResponseMetadata.builder().id(null!==(a=e.id)&&void 0!==a?a:"").usage(n).model(null!==(r=e.model)&&void 0!==r?r:"").costs(null!==(o=e.costs)&&void 0!==o?o:[]).rateLimit(e.rateLimit).build()}async stream(e){var n,a;const r=new u.CodeCompletionRequest;r.prompt=e.instructions.prompt,r.suffix=e.instructions.suffix,r.model=null!==(n=e.options.model)&&void 0!==n?n:"",r.temperature=e.options.temperature,r.topP=e.options.topP,r.maxTokens=e.options.maxTokens,r.n=e.options.n,r.frequencyPenalty=e.options.frequencyPenalty,r.presencePenalty=e.options.presencePenalty,r.stop=e.options.stopSequences,r.signal=e.options.signal,r.stream=!0,r.extra=e.options.extra;const o=(await this.codeCompletionApi.streamingCode(r,null===(a=e.options)||void 0===a?void 0:a.httpHeaders)).pipe((0,c.map)((e=>e.body)),(0,c.map)((e=>{try{const n=e.choices.map((e=>this.buildGeneration(e))),a=e.usage,r=a?l.Usage.from(a.promptTokens,a.completionTokens,a.totalTokens):l.Usage.createEmpty(),o=l.UsageUtil.getCumulativeUsage(r);return f.CodeCompletionResponse.from(n,this.buildCodeCompletionResponseMetadataByResult(e,o))}catch(e){return this.logger.error(e),f.CodeCompletionResponse.from([])}})),(0,c.bufferCount)(2,1),(0,c.map)((e=>{var n;const a=e[0];if((null===(n=r.streamOptions)||void 0===n?void 0:n.includeUsage)&&2===e.length){const n=e[1];if(null==n?void 0:n.metadata){const e=n.metadata.usage;if(!l.UsageUtil.isEmpty(e))return f.CodeCompletionResponse.from(a.results,this.buildCodeCompletionResponseMetadata(a.metadata,e))}}return a})));return o}};n.TencentCodeCompletionModel=m,r([(0,i.Autowired)(s.RestOperations),o("design:type",Function)],m.prototype,"restOperations",void 0),r([(0,i.Autowired)(u.TencentAPI),o("design:type",Object)],m.prototype,"codeCompletionApi",void 0),r([(0,i.Autowired)(i.Logger),o("design:type",Object)],m.prototype,"logger",void 0),n.TencentCodeCompletionModel=m=r([(0,i.Component)(f.CodeCompletionModel)],m)},93755:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),a(17301);const c=a(69022),u=i(a(48431)),d=a(15389),f=a(73e3),m=a(20421),p=a(20815),v=s(a(60247)),h=a(70710),g=s(a(88151)),y=a(18817);n.default=({isUpdate:e,isShowAdd:n})=>{var a;const{data:r,fetchInstalledServerList:o}=(0,y.useInstalledServers)(),[l,i]=u.default.useState(!1),[s,b]=u.default.useState({}),_=(0,d.useNavigate)(),[C,E]=(0,u.useState)(r),w=(0,p.useInstalledCardL10n)();(0,u.useEffect)((()=>{e&&o()}),[e]),(0,u.useEffect)((()=>{E(r),n(r.length>0)}),[r]),(0,u.useEffect)((()=>{const e=(0,m.getMcpViewService)().mcpSettingsListener.subscribe((()=>{o()}));return()=>e.unsubscribe()}),[]);const openExternal=e=>{(0,m.getMcpViewService)().openExternal(e)},handleCopy=e=>{(0,m.getMcpViewService)().clipboardWriteText(e)},editServer=async e=>{var n;i(!0);const a=(await(0,m.getMcpViewService)().getSetting()).mcpServers[e.name];b({...e,install_commands:{...e.install_commands,env:null!==(n=null==a?void 0:a.env)&&void 0!==n?n:{}}})},handleTryToRun=e=>{const n={chatType:c.ChatType.CRAFT,prompt:`${e.name} ${w.installedSuccessfully}`,codebase:!1,timestamp:Date.now(),options:{autoSend:!0,newChat:!0}};f.chatActionSubject.next(n),_("/")},deleteServer=async e=>{const{name:n}=e;E(C.filter((e=>e.name!==n))),await(0,m.getMcpViewService)().delServer(n),await o()},toggleServer=async(e,n)=>{E(C.map((n=>({...n,status:n.name===e?"connecting":n.status})))),await(0,m.getMcpViewService)().toggleServerStatus(e,n),await o()},reconnectServer=async e=>{E(C.map((n=>({...n,status:n.name===e.name?"connecting":n.status})))),await(0,m.getMcpViewService)().reconnectServer(e),await o()};return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:"code-buddy-mcp-installed"},C.length?u.default.createElement(u.default.Fragment,null,C.map((e=>u.default.createElement(h.McpInstalledCard,{data:e,key:e.name,onTryToRun:handleTryToRun,onCopy:handleCopy,onOpenExternal:openExternal,onEdit:editServer,onReconnect:reconnectServer,onToggleServer:toggleServer,onDelete:deleteServer})))):u.default.createElement(g.default,null)),u.default.createElement(v.default,{visible:l,title:s.name,env:(null===(a=s.install_commands)||void 0===a?void 0:a.env)||{},onRun:e=>(async e=>{await(0,m.getMcpViewService)().updateConfigEnv(s.name,{...s.env,...e});const n={chatType:c.ChatType.CRAFT,prompt:`${s.name} ${w.installedSuccessfully}`,codebase:!1,options:{autoSend:!0,newChat:!0}};f.chatActionSubject.next(n),i(!1),_("/")})(e),onSave:e=>(async e=>{await(0,m.getMcpViewService)().updateConfigEnv(s.name,{...s.env,...e}),i(!1)})(e),onClose:()=>i(!1)}))}},94003:(e,n,a)=>{"use strict";a.r(n)},94121:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n}),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Switch=function Switch(e){return d.createElement(c.Switch,{className:(0,u.default)("switch",`switch-size-${e.size}`),...e})},a(75339);const c=a(60139),u=s(a(73059)),d=i(a(48431))},94706:(e,n,a)=>{"use strict";var r=a(78);let o;function getAegisInstance(){return o||("undefined"!=typeof window&&window.__aegis__?(o=window.__aegis__,o):void 0)}Object.defineProperty(n,"__esModule",{value:!0}),n.reportWebviewEvent=function reportWebviewEvent(e,n,a,o){if(!e||"string"!=typeof e)return void r.warn("[AegisWebview] 事件上报失败: 事件名称不能为空且必须为字符串");const l=getAegisInstance();if(l)try{l.reportEvent(e,n,a,o)}catch(e){r.warn("[AegisWebview] 事件上报失败:",e)}},n.reportWebviewTime=function reportWebviewTime(e,n,a,o,l){if(!e||"string"!=typeof e)return void r.warn("[AegisWebview] 性能数据上报失败: 指标名称不能为空且必须为字符串");if("number"!=typeof n||isNaN(n)||n<0)return void r.warn("[AegisWebview] 性能数据上报失败: 耗时必须为非负数值");const i=getAegisInstance();if(i)try{i.reportTime(e,n,a,o,l)}catch(e){r.warn("[AegisWebview] 性能数据上报失败:",e)}},n.reportWebviewError=function reportWebviewError(e){if(!e)return void r.warn("[AegisWebview] 错误上报失败: 错误对象不能为空");const n=getAegisInstance();if(n)try{n.error(e)}catch(e){r.warn("[AegisWebview] 错误上报失败:",e)}},n.reportWebviewErrors=function reportWebviewErrors(e){if(!Array.isArray(e)||0===e.length)return void r.warn("[AegisWebview] 批量错误上报失败: 错误数组不能为空");const n=getAegisInstance();if(n)try{n.errorAll?n.errorAll(e):e.forEach((e=>{if(e)try{n.error(e)}catch(e){r.warn("[AegisWebview] 单个错误上报失败:",e)}}))}catch(e){r.warn("[AegisWebview] 批量错误上报失败:",e)}},n.reportWebviewInfo=function reportWebviewInfo(e){if(!e||"string"!=typeof e)return void r.warn("[AegisWebview] 信息日志上报失败: 日志信息不能为空且必须为字符串");const n=getAegisInstance();if(n)try{n.info(e)}catch(e){r.warn("[AegisWebview] 信息日志上报失败:",e)}},n.reportWebviewInfos=function reportWebviewInfos(e){if(!Array.isArray(e)||0===e.length)return void r.warn("[AegisWebview] 批量信息日志上报失败: 信息数组不能为空");const n=getAegisInstance();if(n)try{n.infoAll?n.infoAll(e):e.forEach((e=>{if(e&&"string"==typeof e)try{n.info(e)}catch(e){r.warn("[AegisWebview] 单个信息日志上报失败:",e)}}))}catch(e){r.warn("[AegisWebview] 批量信息日志上报失败:",e)}},n.isAegisInitialized=function isAegisInitialized(){return!!getAegisInstance()},n.resetAegisInstance=function resetAegisInstance(){o=void 0},n.destroyAegisInstance=function destroyAegisInstance(){const e=getAegisInstance();if(e&&"function"==typeof e.destroy)try{e.destroy()}catch(e){r.warn("[AegisWebview] 销毁 Aegis 实例失败:",e)}finally{o=void 0}}},95595:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SearchIcon=void 0;const o=r(a(48431));n.SearchIcon=()=>o.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("g",{clipPath:"url(#clip0_25455_34142)"},o.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.24922 0.637695C2.70182 0.637695 0.636719 2.70279 0.636719 5.2502C0.636719 7.7976 2.70182 9.8627 5.24922 9.8627C6.34732 9.8627 7.3558 9.47896 8.14787 8.83828L10.5295 11.2199C10.7199 11.4103 11.0286 11.4103 11.2189 11.2199C11.4093 11.0295 11.4093 10.7209 11.2189 10.5305L8.8373 8.14885C9.47799 7.35677 9.86172 6.3483 9.86172 5.2502C9.86172 2.70279 7.79662 0.637695 5.24922 0.637695ZM1.61172 5.2502C1.61172 3.24127 3.24029 1.6127 5.24922 1.6127C7.25814 1.6127 8.88672 3.24127 8.88672 5.2502C8.88672 7.25912 7.25814 8.8877 5.24922 8.8877C3.24029 8.8877 1.61172 7.25912 1.61172 5.2502Z",fill:"currentColor"})),o.default.createElement("defs",null,o.default.createElement("clipPath",{id:"clip0_25455_34142"},o.default.createElement("rect",{width:"12",height:"12",fill:"white"}))))},95816:function(e,n,a){"use strict";var r=this&&this.__decorate||function(e,n,a,r){var o,l=arguments.length,i=l<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,a):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,n,a,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(l<3?o(i):l>3?o(n,a,i):o(n,a))||i);return l>3&&i&&Object.defineProperty(n,a,i),i},o=this&&this.__metadata||function(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SearchContentRenderer=void 0;const i=a(15985),s=a(69022),c=a(19606),u=l(a(48431)),d=a(99095),f=a(73671),m=a(87783),p=a(39941),v=a(42810),h=a(63565);let g=class SearchContentRenderer{constructor(){this.className="search-content",this.clickHeader=!0,this.resultVisible=!1,this.t=(e,n)=>e}canHandle(e){return e.name===s.ToolNames.SEARCH_CONTENT?v.ChatToolRendererPriority.EXACT:v.ChatToolRendererPriority.NONE}renderExecutedTitle(e){return u.default.createElement(u.default.Fragment,null,u.default.createElement("span",{className:"title"},u.default.createElement(c.FormattedMessage,{id:'Searching for "{key}"',values:{num:this.totalMatches,key:e}})),u.default.createElement("span",{className:"file-num"},u.default.createElement(c.FormattedMessage,{id:"{num} result",values:{value:this.totalMatches}})))}renderSearchingTitle(e,n){const a=this.t('Searching for "{key}"',{key:e});return u.default.createElement("span",{className:"title disabled",title:a},a)}renderTitle(e,n){var a,r;const o=(null===(a=null==e?void 0:e.args)||void 0===a?void 0:a.directory)||"",l=(null===(r=null==e?void 0:e.args)||void 0===r?void 0:r.key)||"",i=h.ToolUtils.getRelativeFilePath(o,n);return u.default.createElement(d.ToolCallPathCollectorHoc,{status:e.status,paths:this.matchedFiles},e.status===s.ToolStatus.EXECUTED?this.renderExecutedTitle(l):this.renderSearchingTitle(l,i))}renderControl(e){const n={DEFAULT:{[s.ToolStatus.IDLE]:"Currently Searching",[s.ToolStatus.PENDING]:"Currently Searching",[s.ToolStatus.PARSING]:"Currently Searching",[s.ToolStatus.STREAM_EXECUTING]:"Currently Searching",[s.ToolStatus.FULL_EXECUTING]:"Currently Searching",[s.ToolStatus.EXECUTED]:"Completed",[s.ToolStatus.FAILED]:"Search failed"}};return u.default.createElement(m.StatusText,{statusTextMap:n,toolStatus:e.status})}renderResult(e){var n;const a=(null===(n=null==e?void 0:e.args)||void 0===n?void 0:n.key)||"";return u.default.createElement("div",{className:"container"},this.matches.length>0?e.status!==s.ToolStatus.EXECUTED?u.default.createElement("span",{className:"content-item"},this.t('Searching for "{key}"',{key:a}),u.default.createElement(f.LoadingDots,null)):this.renderFileList():u.default.createElement("span",{className:"no-search"},u.default.createElement(c.FormattedMessage,{id:"No relevant content was found"})))}renderIcon(e,n){return u.default.createElement(u.default.Fragment,null,e.status===s.ToolStatus.EXECUTED&&u.default.createElement(p.ArrowIcon,{className:n?"":"arrow-left"}))}renderFileList(){return this.matches.map(((e,n)=>{const a=e.filePath,r=e.startLine===e.endLine?`#L${e.startLine}`:`#L${e.startLine}-L${e.endLine}`,openFile=(e,n,a)=>{var r,o;this.chatViewService.openRelativeFileWithRange((null===(o=null===(r=this.tool)||void 0===r?void 0:r.args)||void 0===o?void 0:o.directory)||"",e,[{line:n-1,character:0},{line:a,character:0}])};return u.default.createElement("div",{key:`${e.filePath}-${e.startLine}-${n}`,className:"content-item"},u.default.createElement("span",{className:"file-path-clickable",onClick:()=>openFile(e.filePath,e.startLine,e.endLine),title:e.filePath},u.default.createElement("span",{className:"line-file-icon"},u.default.createElement(c.Icon,{name:a,type:c.IconType.VSCODE})),u.default.createElement("span",{className:"line-file-name truncate"},a.split("/").pop()),u.default.createElement("span",{className:"line-info"},r),u.default.createElement("span",{className:"line-file-path truncate"},a),e.size&&u.default.createElement("span",{className:"line-file-size"},e.size)))}))}get matches(){var e,n,a,r,o;return(null===(n=null===(e=this.tool)||void 0===e?void 0:e.result)||void 0===n?void 0:n.success)&&(null===(o=null===(r=null===(a=this.tool)||void 0===a?void 0:a.result)||void 0===r?void 0:r.result)||void 0===o?void 0:o.matches)?this.tool.result.result.matches:[]}get matchedFiles(){return[...new Set(this.matches.map((e=>e.filePath)))]}get totalMatches(){var e,n,a,r,o;return(null===(n=null===(e=this.tool)||void 0===e?void 0:e.result)||void 0===n?void 0:n.success)&&void 0!==(null===(o=null===(r=null===(a=this.tool)||void 0===a?void 0:a.result)||void 0===r?void 0:r.result)||void 0===o?void 0:o.totalCount)?this.tool.result.result.totalCount:this.matches.length}};n.SearchContentRenderer=g,r([(0,i.Autowired)(s.ChatViewService),o("design:type",Object)],g.prototype,"chatViewService",void 0),n.SearchContentRenderer=g=r([(0,i.Component)({id:v.ChatToolRenderer,scope:i.Scope.Transient})],g)},95819:function(e,n,a){"use strict";var r,o=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),l=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[n.length]=a);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a=r(e),i=0;i<a.length;i++)"default"!==a[i]&&o(n,e,a[i]);return l(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),a(18981);const s=i(a(48431)),c=a(62855),u=a(31463);n.default=({message:e,type:n="info",duration:a=5e3,showClose:r=!1,offset:o=20,onClose:l})=>{const[i,d]=(0,s.useState)(!1),[f,m]=(0,s.useState)(!1);(0,s.useEffect)((()=>{if(d(!0),a>0){const e=setTimeout((()=>{hide()}),a);return()=>clearTimeout(e)}}),[a]);const hide=()=>{m(!0),setTimeout((()=>{d(!1),m(!1),null==l||l()}),300)};return i?s.default.createElement("div",{className:`craft-vue-toast ${n} ${f?"leaving":""}`,style:{top:`${o}px`}},s.default.createElement("div",{className:"craft-vue-toast__content"},"success"===n&&s.default.createElement(u.SuccessIcon,{className:"craft-vue-toast__icon"}),"success"!==n&&s.default.createElement(c.FailedIcon,{className:"craft-vue-toast__icon failed"}),s.default.createElement("span",{className:"craft-vue-toast__message"},e)),r&&s.default.createElement("span",{className:"toast-close",onClick:hide},"×")):s.default.createElement(s.default.Fragment,null)}},95874:(e,n,a)=>{"use strict";a.r(n)},95973:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(67633),n)},96593:(e,n)=>{"use strict";var a,r,o,l,i;Object.defineProperty(n,"__esModule",{value:!0}),n.FormatType=n.WorkspaceStatus=n.WelcomeMode=n.PlatformType=n.Lang=void 0,function(e){e.ZH="zh-cn",e.EN="en",e.ZHTW="zh-tw"}(a||(n.Lang=a={})),function(e){e.VSCODE="VSCode",e.WEIXIN="WXIDE",e.JB="JetBrains"}(r||(n.PlatformType=r={})),function(e){e.ASK="ask",e.CRAFT="craft"}(o||(n.WelcomeMode=o={})),function(e){e.NOT="notWorkspace",e.HAS="hasWorkspace",e.SC="smartCreation"}(l||(n.WorkspaceStatus=l={})),function(e){e.TITLE="title",e.DESCRIBE="describe",e.GUIDEITEM="guideItem"}(i||(n.FormatType=i={}))},96632:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ReasoningRenderer=void 0,a(30750);const o=a(19606),l=r(a(73059)),i=r(a(48431)),s=a(25380);n.ReasoningRenderer=e=>{const{children:n}=e,{state:a,toggle:r}=(0,s.useToggle)(!1);return i.default.createElement("section",{className:(0,l.default)("assistant-reasoning",{collapse:a})},i.default.createElement("header",{className:"assistant-reasoning__header"},i.default.createElement(o.FormattedMessage,{id:"Deep Thinking"}),i.default.createElement(IconDown,{className:"assistant-reasoning__icon",onClick:r})),i.default.createElement("div",{className:"assistant-reasoning__content"},n))};const IconDown=e=>i.default.createElement("svg",{...e,width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.default.createElement("path",{d:"M9.52058 4.23926L6.00003 7.7598L2.47949 4.23926",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round",strokeLinejoin:"round"}))},96885:(e,n,a)=>{"use strict";a.r(n)},97105:(e,n,a)=>{"use strict";a.r(n)},97959:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.WarningIcon=void 0;const o=r(a(48431));n.WarningIcon=e=>o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",...e},o.default.createElement("path",{d:"M0.844116 9.04237L5.23351 1.90961C5.58494 1.33853 6.41506 1.33853 6.76649 1.90961L11.1559 9.04237C11.5249 9.64202 11.0935 10.4141 10.3894 10.4141H1.61061C0.906519 10.4141 0.475105 9.64202 0.844116 9.04237Z",stroke:"#EE9D28",strokeWidth:"0.975"}),o.default.createElement("path",{d:"M6 4.56934L6 6.81934",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round"}),o.default.createElement("path",{d:"M6 8.38867L6 8.37622",stroke:"currentColor",strokeWidth:"0.975",strokeLinecap:"round"}))},98494:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(27643),n),o(a(93074),n),o(a(61439),n)},98729:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Button=void 0;const o=r(a(73059)),l=r(a(48431));n.Button=e=>{const{variant:n,size:a="medium",className:r,children:i,...s}=e;return l.default.createElement("button",{className:(0,o.default)("codebuddy-button",n,a,r),type:"button",...s},i)}},98810:(e,n,a)=>{"use strict";a.r(n)},99095:function(e,n,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,a,r){void 0===r&&(r=a);var o=Object.getOwnPropertyDescriptor(n,a);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(e,r,o)}:function(e,n,a,r){void 0===r&&(r=a),e[r]=n[a]}),o=this&&this.__exportStar||function(e,n){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(n,a)||r(n,e,a)};Object.defineProperty(n,"__esModule",{value:!0}),o(a(60742),n),o(a(64187),n),o(a(32134),n)},99648:function(e,n,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=a(15985),l=a(69022),i=a(19606),s=r(a(48431)),c=a(50473),u=a(25380),d=a(40109),f=a(46141),m=a(78517);n.default=({setVisible:e,visible:n})=>{const a=(0,i.useIntl)(),r=o.ContainerUtil.get(c.ChatInputController),{triggerChatState:p}=(0,u.useChatState)(),v=(0,d.newChatViewService)(),onCancel=()=>{e(!1)};return s.default.createElement(m.Dialog,{visible:n,title:a.$t({id:"Create a new conversation?"}),actions:s.default.createElement("div",{className:"mcp-dialog-error-actions"},s.default.createElement(f.Button,{size:"small",variant:"primary",onClick:()=>(async()=>{e(!1),v.ignoreClearInputSubject.next(!0),p(l.ChatStateEvent.STOP),await r.stopRequest(),v.startNewChat()})()},a.$t({id:"Create"})),s.default.createElement(f.Button,{size:"small",onClick:()=>onCancel()},a.$t({id:"Cancel"}))),onClose:onCancel},s.default.createElement("div",null,a.$t({id:"The current conversation is in progress. Creating a new conversation will terminate the current conversation. Do you want to continue creating it?"})))}}}]);
//# sourceMappingURL=2239.a382236a132bb33d3868.js.map