"use strict";(self.webpackChunk_genie_chat_webview_app=self.webpackChunk_genie_chat_webview_app||[]).push([[6020],{597:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4080:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,function(e){e[e.Verbose=0]="Verbose",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error"}(r||(t.LogLevel=r={}))},4307:(e,t)=>{var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureToggle=t.ProductFeature=void 0,function(e){e.Chat="Chat",e.InlineChat="InlineChat",e.StatusBar="StatusBar",e.ChatVariable="ChatVariable",e.InlineCompletions="InlineCompletions",e.NesCompletions="NesCompletions",e.MergedNesCompletions="MergedNesCompletions",e.SlashCommand="SlashCommand",e.GenerateCommitMessage="GenerateCommitMessage",e.GenerateReadmeFile="GenerateReadmeFile",e.ConfigServer="ConfigServer",e.StopParamPatch="StopParamPatch",e.OpenAIStyleAPI="OpenAIStyleAPI",e.SecretKeyRequired="SecretKeyRequired",e.MultiFileWithPromptParam="MultiFileWithPromptParam",e.MultiFileWithSeparateParams="MultiFileWithSeparateParams",e.TrimByIndentation="TrimByIndentation",e.ASTForCompletions="ASTForCompletions",e.CompletionsPrefetching="CompletionsPrefetching",e.NESPrefetchingAfterEmptyCompletion="NESPrefetchingAfterEmptyCompletion",e.TriggerNESAfterCompletionHasBeenAccepted="TriggerNESAfterCompletionHasBeenAccepted",e.CursorPositonPrefetching="CursorPositonPrefetching",e.CompletionsRelatedSnippets="CompletionsRelatedSnippets",e.NesDocumentActiveChangeTrigger="NesDocumentActiveChangeTrigger",e.NesCompletionsPrefetching="NesCompletionsPrefetching",e.NesCompletionsJumpToHere="NesCompletionsJumpToHere",e.RemoveBelowExist="RemoveBelowExist",e.NesRepeatFilter="NesRepeatFilter",e.NesRepeatFilterV2="NesRepeatFilterV2",e.NesRangeFix="NesRangeFix",e.CompletionsResultFusion="CompletionsResultFusion",e.ChatHistory="ChatHistory",e.InlineChatSelectionAppendToResult="InlineChatSelectionAppendToResult",e.ChatFollowup="ChatFollowup",e.CRLFCompatible="CRLFCompatible",e.CodeAction="CodeAction",e.InlineChatIntentRecognition="InlineChatIntentRecognition",e.MultiStepCompletions="MultiStepCompletions",e.Codebase="Codebase",e.UseDefaultModelIfCurrentNotInList="UseDefaultModelIfCurrentNotInList",e.Mcp="Mcp",e.McpMarket="McpMarket",e.McpInstallationGuide="McpInstallationGuide",e.SelectImage="SelectImage",e.Aegis="Aegis"}(r||(t.ProductFeature=r={})),function(e){e.SupportHttpsAgentProxy="SupportHttpsAgentProxy"}(o||(t.FeatureToggle=o={}))},7657:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},11741:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CloudProductProvider=void 0;const n=r(15985),a=r(56464),c=r(39322),s=r(2877),d=r(75229),u=r(78680);let l=class CloudProductProvider{constructor(){this.priority=u.ProductProviderPriority.CLOUD}async provide(e){var t,r,o,i;if(null===(t=e.current.config)||void 0===t?void 0:t.disabled)return{};const a=(null===(r=e.current.config)||void 0===r?void 0:r.url)||"/v3/config",c=null===(o=n.ContainerUtil.get(u.ProductManager))||void 0===o?void 0:o.getEndpoint();if((null===(i=e.current.config)||void 0===i?void 0:i.url)||c)try{const e=await this.cloudProductManager.fetch(a);return delete e.endpoint,delete e.stagingEndpoint,{mergeStrategy:u.MergeStrategy.Merge,...e}}catch(e){this.logger.warn(`Failed to get product configuration from ${a} error: ${e}`)}return{}}};t.CloudProductProvider=l,o([(0,n.Autowired)(a.RestOperations),i("design:type",Function)],l.prototype,"restOperations",void 0),o([(0,n.Autowired)(n.Logger),i("design:type",Object)],l.prototype,"logger",void 0),o([(0,n.Autowired)(u.CloudProductManager),i("design:type",Object)],l.prototype,"cloudProductManager",void 0),o([(0,s.ShareCacheable)({domain:"ACC_SHARE_CACHE_PRODUCT_CLOUD",identifierGenerator:async e=>{var t,r;const o=n.ContainerUtil.get(d.ClientInfoProvider),i=n.ContainerUtil.get(s.UserinfoProvider),a=await o.get(),u=await i.provide();return c.HashUtils.md5(`${a.platform}_${a.platformVersion}_${a.productName}_${a.productVersion}_${null==u?void 0:u.token}_${null===(t=e.current.config)||void 0===t?void 0:t.url}_${null===(r=e.current.config)||void 0===r?void 0:r.disabled}`)},expireIn:u.PRODUCT_CONFIGURATION_CACHE_TIMEOUT,onCacheUpdate:()=>{var e;n.ContainerUtil.get(n.Logger).debug("[ShareCache] cache update: PRODUCT_CLOUD"),null===(e=n.ContainerUtil.get(u.ProductManager))||void 0===e||e.sync()},forceUpdate:e=>e.force}),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",Promise)],l.prototype,"provide",null),t.CloudProductProvider=l=o([(0,n.Component)(u.ProductProvider)],l)},14203:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},20199:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},24364:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ENV_CLIENT_INFO_KEYS=t.ClientInfoProvider=void 0,t.ClientInfoProvider=Symbol("ClientInfoProvider"),t.ENV_CLIENT_INFO_KEYS={machineId:"CLIENT_INFO_MACHINE_ID",sessionId:"CLIENT_INFO_SESSION_ID",platform:"CLIENT_INFO_PLATFORM",platformVersion:"CLIENT_INFO_PLATFORM_VERSION",productName:"CLIENT_INFO_PRODUCT_NAME",productVersion:"CLIENT_INFO_PRODUCT_VERSION",ideType:"CLIENT_INFO_IDE_TYPE",pluginName:"CLIENT_INFO_PLUGIN_NAME",pluginVersion:"CLIENT_INFO_PLUGIN_VERSION"}},26020:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,i)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(56506),t),i(r(78680),t),i(r(84953),t),i(r(28365),t),i(r(11741),t),i(r(85973),t),i(r(56528),t),i(r(88822),t),i(r(31558),t),i(r(75229),t),i(r(64173),t)},28365:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultProductProvider=void 0;const n=r(15985),a=r(78680);let c=class DefaultProductProvider{constructor(){this.priority=a.ProductProviderPriority.DEFAULT}async provide(e){return{}}};t.DefaultProductProvider=c,o([(0,n.Autowired)(n.Logger),i("design:type",Object)],c.prototype,"logger",void 0),t.DefaultProductProvider=c=o([(0,n.Component)(a.ProductProvider)],c)},29704:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateApiVersion=void 0,function(e){e.V2="v2"}(r||(t.UpdateApiVersion=r={}))},31558:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.SmartMergeProductMergeStrategy=t.MergeProductMergeStrategy=t.OverrideProductMergeStrategy=void 0;const i=r(15985),n=r(78680),a=r(56506);let c=class OverrideProductMergeStrategy{async merge(e,t){return{...t}}async support(e){return e.mergeStrategy===a.MergeStrategy.Override}};t.OverrideProductMergeStrategy=c,t.OverrideProductMergeStrategy=c=o([(0,i.Component)(n.ProductMergeStrategy)],c);let s=class MergeProductMergeStrategy{async merge(e,t){return this.doMerge(e,t)}mergeArray(e,t){return t}doMerge(e,t){if(void 0===t)return e;if(!e)return t;if(null===t)return e;if(Array.isArray(e)||Array.isArray(t))return this.mergeArray(e,t);let r=t;if("object"==typeof e&&null!==e&&"object"==typeof t&&null!==t){r={...e};for(const o of Object.keys(t))r[o]=this.doMerge(e[o],t[o])}return r}async support(e){return e.mergeStrategy===a.MergeStrategy.Merge||!e.mergeStrategy}};t.MergeProductMergeStrategy=s,t.MergeProductMergeStrategy=s=o([(0,i.Component)(n.ProductMergeStrategy)],s);let d=class SmartMergeProductMergeStrategy extends s{async support(e){return e.mergeStrategy===a.MergeStrategy.SmartMerge}isObjectArray(e){return Array.isArray(e)&&(0===e.length||e.every((e=>"object"==typeof e)))}getItemIdOrName(e){return(null==e?void 0:e.id)||(null==e?void 0:e.name)}mergeArray(e,t){if(!this.isObjectArray(e)||!this.isObjectArray(t))return super.mergeArray(e,t);let r=[...e];for(const o of t){const t=this.getItemIdOrName(o);if(t){const i=e.find((e=>this.getItemIdOrName(e)===t));if(i){const e=this.doMerge(i,o);r=r.map((t=>this.getItemIdOrName(t)===this.getItemIdOrName(e)?e:t))}else r.push(o)}else o&&r.push(o)}return r}};t.SmartMergeProductMergeStrategy=d,t.SmartMergeProductMergeStrategy=d=o([(0,i.Component)(n.ProductMergeStrategy)],d)},34457:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},36234:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},39486:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},51809:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.UserAgentHttpInterceptor=void 0;const n=r(15985),a=r(56464),c=r(24364);let s=class UserAgentHttpInterceptor{initialize(){this.restOperations.interceptors.request.use((async e=>(e.headers||(e.headers={}),e.headers[a.HttpHeaders.USER_AGENT]=await this.buildUserAgent(`${e.headers[a.HttpHeaders.USER_AGENT]||""}`),e)))}async buildUserAgent(e=""){const t=await this.clientInfoProvider.get()||{};return[`${t.platform}/${t.platformVersion||"unknown"}`,`${t.productName}/${t.productVersion||"unknown"}`,e].join(" ")}};t.UserAgentHttpInterceptor=s,o([(0,n.Autowired)(c.ClientInfoProvider),i("design:type",Object)],s.prototype,"clientInfoProvider",void 0),o([(0,n.Autowired)(a.RestOperations),i("design:type",Function)],s.prototype,"restOperations",void 0),o([(0,n.Autowired)(n.Logger),i("design:type",Object)],s.prototype,"logger",void 0),t.UserAgentHttpInterceptor=s=o([(0,n.Component)(n.ApplicationLifecycle)],s)},53811:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},56506:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,i)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(69229),t),i(r(80876),t),i(r(29704),t),i(r(4307),t),i(r(7657),t),i(r(63726),t),i(r(71039),t),i(r(88137),t),i(r(39486),t),i(r(81548),t),i(r(34457),t),i(r(36234),t),i(r(53811),t),i(r(597),t),i(r(14203),t),i(r(84210),t),i(r(29704),t),i(r(4080),t),i(r(98670),t),i(r(99630),t),i(r(20199),t)},56528:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProductEndpointHttpInterceptor=void 0;const n=r(15985),a=r(56464),c=r(39322),s=r(78680);let d=class ProductEndpointHttpInterceptor{initialize(){this.restOperations.interceptors.request.use((e=>{var t,r;const o=n.ContainerUtil.get(s.ProductManager),i=o.getEndpoint();return i&&(e.baseURL=i),e.headers||(e.headers={}),e.headers[c.PRODUCT]||(e.headers[c.PRODUCT]=null!==(r=null===(t=o.configuration.getValue())||void 0===t?void 0:t.deploymentType)&&void 0!==r?r:"SaaS"),e}))}};t.ProductEndpointHttpInterceptor=d,o([(0,n.Autowired)(a.RestOperations),i("design:type",Function)],d.prototype,"restOperations",void 0),t.ProductEndpointHttpInterceptor=d=o([(0,n.Component)(n.ApplicationLifecycle)],d)},63726:(e,t)=>{var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.ReplacementFile=t.ReplacementContent=void 0,function(e){e.is=function is(e){return"pattern"in e&&"search"in e&&"replace"in e}}(r||(t.ReplacementContent=r={})),function(e){e.is=function is(e){return"sourcePath"in e&&"targetPath"in e}}(o||(t.ReplacementFile=o={}))},64173:(e,t,r)=>{var o=r(42649);Object.defineProperty(t,"__esModule",{value:!0}),t.getIDEType=void 0;const i=r(39322),n=r(24364);t.getIDEType=e=>{if(i.EnvUtils.isNodeRuntime()){if(o.env.ACC_IDE_TYPE)return o.env.ACC_IDE_TYPE;if(o.env[n.ENV_CLIENT_INFO_KEYS.ideType])return o.env[n.ENV_CLIENT_INFO_KEYS.ideType];if(o.env.ACC_USER_ID)return`web-${e}`}return e.includes("VSCode")?"VSCode":e.includes("JetBrains")?"JetBrains":e.includes("Vim")?"Vim":e.includes("XCode")?"XCode":e.includes("VisualStudio")?"VisualStudio":e.includes("CodeBuddyIDE")?"CodeBuddyIDE":e.includes("WXIDE")?"WXIDE":e.includes("WebChat")?"WebChat":"VSCode"}},69229:(e,t)=>{var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_MERGE_STRATEGY=t.MergeStrategy=t.Platform=void 0,function(e){e.VSCode="vscode",e.Jetbrains="jetbrains"}(r||(t.Platform=r={})),function(e){e.Override="override",e.Merge="merge",e.SmartMerge="smartMerge"}(o||(t.MergeStrategy=o={})),t.DEFAULT_MERGE_STRATEGY=o.SmartMerge},71039:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AgentPublisherType=void 0,function(e){e.User="user",e.Global="Global",e.Enterprise="enterprise"}(r||(t.AgentPublisherType=r={}))},75229:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,i)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(24364),t),i(r(80841),t),i(r(51809),t)},78680:function(e,t,r){var o,i=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,i)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.CloudProductManager=t.ProductMergeStrategy=t.ProductMerger=t.ProductManager=t.ProductProvider=t.ProductProviderPriority=t.PRODUCT_CONFIGURATION_CACHE_TIMEOUT=void 0,n(r(56506),t),t.PRODUCT_CONFIGURATION_CACHE_TIMEOUT=48e4,function(e){e.CLIENT=5e3,e.CLIENT_SETTINGS_ENDPOINT=6e3,e.CLOUD_PRE=9999,e.CLOUD=1e4,e.MODELS=100100,e.AGENTS=100200,e.CLIENT_SETTINGS=11e3,e.WORKSPACE=15e3,e.MODEL_SETTINGS=18e3,e.ENV=2e4,e.DEFAULT=25e3}(o||(t.ProductProviderPriority=o={})),t.ProductProvider=Symbol("ProductProvider"),t.ProductManager=Symbol("ProductManager"),t.ProductMerger=Symbol("ProductMerger"),t.ProductMergeStrategy=Symbol("ProductMergeStrategy"),t.CloudProductManager=Symbol("CloudProductManager")},80841:function(e,t,r){var o=r(42649),i=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultClientInfoProviderImpl=void 0;const a=r(15985),c=r(39322),s=r(97317),d=r(78680),u=r(64173),l=r(24364);let p=class DefaultClientInfoProviderImpl{constructor(){this.clientInfo$=new s.BehaviorSubject(void 0)}initialize(){this.initClientInfo(),this.productManager.configuration.subscribe((()=>{this.initClientInfo()}))}async get(){const e=this.initClientInfo();return Promise.resolve(e)}initClientInfo(){var e,t;const r=this.productManager.getCurrentConfiguration(),o=this.getProcessEnvInfo(),i={machineId:"",sessionId:"",platform:(null==r?void 0:r.platform)||"",platformVersion:(null==r?void 0:r.platformVersion)||"",productName:(null==r?void 0:r.productName)||"",productVersion:(null==r?void 0:r.productVersion)||"",...o};return i.ideType=(0,u.getIDEType)(i.platform),null===(e=this.filePathService)||void 0===e||e.setIDEType(null!==(t=i.ideType)&&void 0!==t?t:"VSCode"),c.ObjectUtils.isChanged(this.clientInfo,i)&&this.clientInfo$.next(i),i}getProcessEnvInfo(){const e={};if(c.EnvUtils.isNodeRuntime()&&o.env)for(const t of Object.keys(l.ENV_CLIENT_INFO_KEYS)){const r=t,i=l.ENV_CLIENT_INFO_KEYS[r];i in o.env&&o.env[i]&&(e[r]=o.env[i])}return e}};t.DefaultClientInfoProviderImpl=p,i([(0,a.Autowired)(d.ProductManager),n("design:type",Object)],p.prototype,"productManager",void 0),i([(0,a.Autowired)(c.FilePathService),(0,a.Optional)(),n("design:type",Object)],p.prototype,"filePathService",void 0),i([(0,a.PostConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],p.prototype,"initialize",null),t.DefaultClientInfoProviderImpl=p=i([(0,a.Component)(l.ClientInfoProvider)],p)},80876:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationType=void 0,function(e){e.CUSTOM_TOKEN="custom-token",e.WECHAT="wechat",e.EXTERNAL_LINK="external-link",e.EXTERNAL_LINK_V2="external-link-v2",e.IDE_HOST="ide-host",e.CUSTOM_HOSTNAME="custom-hostname"}(r||(t.AuthenticationType=r={}))},81548:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},84210:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},84953:function(e,t,r){var o,i=r(78),n=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProductManagerImpl=t.PRODUCT_KEY=t.INLINE_COMPLETION_MODEL_KEY=void 0;const c=r(15985),s=r(39322),d=r(97317),u=r(78680);t.INLINE_COMPLETION_MODEL_KEY="inlineCompletionModel",t.PRODUCT_KEY="product";let l=o=class ProductManagerImpl{constructor(){this.onDidChangeEmitter=new c.Emitter,this.onDidChange=this.onDidChangeEmitter.event,this.lastSyncTime=0,this.promise=Promise.resolve(),this.configuration=new d.BehaviorSubject(void 0)}init(){this.sync()}getEndpoint(){return this.currentEndpoint}getCurrentConfiguration(){return this.currentConfiguration}async sync(e){return this.promise=this.promise.finally((()=>this.doSync(e))),this.promise}async doSync(e){await(0,c.timeout)(0),this.lastSyncTime=Date.now();const t=await this.productProviderProvider.sort(),r={force:!!e,current:{}};try{for(const e of t.reverse()){const t=await e.provide(r);r.current=await this.productMerger.merge(r.current,t),this.currentConfiguration=r.current,r.current.endpoint&&(this.currentEndpoint=r.current.endpoint)}}catch(e){try{c.ContainerUtil.get(c.Logger).error(`Error while syncing product configuration: ${e}`,o.name)}catch(e){i.error(`Error while syncing product configuration: ${e}`)}}if(!s.ObjectUtils.isChanged(this._configuration,r.current))return;this._configuration=r.current;const n=new Proxy(r.current,{get:(e,t)=>(Date.now()-this.lastSyncTime>u.PRODUCT_CONFIGURATION_CACHE_TIMEOUT&&this.sync(),e[t])});this.configuration.next(n),this.onDidChangeEmitter.fire()}waitConfiguration(){return new Promise((e=>{const t=this.configuration.subscribe((r=>{r&&(e(r),setTimeout((()=>{t.unsubscribe()}),0))}))}))}};t.ProductManagerImpl=l,l.MAX_CACHE_TTL=48e4,n([(0,c.AutowiredProvider)(u.ProductProvider),a("design:type",Object)],l.prototype,"productProviderProvider",void 0),n([(0,c.Autowired)(u.ProductMerger),a("design:type",Object)],l.prototype,"productMerger",void 0),n([(0,c.PostConstruct)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",void 0)],l.prototype,"init",null),t.ProductManagerImpl=l=o=n([(0,c.Component)(u.ProductManager)],l)},85973:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CloudProductManagerImpl=void 0;const n=r(15985),a=r(56464),c=r(39322),s=r(2877),d=r(78680),u="cloud_product_config_cache";let l=class CloudProductManagerImpl{constructor(){this.retrying=!1}init(){this.logger.setContext("CloudProductManager")}async fetch(e){const t=await this.userinfoProvider.provide();try{return await this.fetchFromRemote(e,null==t?void 0:t.userId)}catch(r){if(null==t?void 0:t.userId){this.fetchWithRetry(e,null==t?void 0:t.userId);const r=await this.fetchFromCache(null==t?void 0:t.userId);if(r)return this.logger.info(`Fetch remote configuration failed, use cached configuration instead: ${this.safeStringify(r)}`,null==t?void 0:t.userId),r}throw r}}async fetchWithRetry(e,t){var r,o;if(this.retrying)return;this.retrying=!0;const i=[1e3,2e3,4e3,8e3,16e3];let n;for(let r=0;r<i.length;r++){await this.sleep(i[r]);try{await this.fetchFromRemote(e,t),this.logger.info(`Fetch remote configuration succeeded after ${r+1} attempt(s)`,t),n=void 0;break}catch(e){n=e,this.logger.warn(`Fetch remote configuration failed (attempt ${r+1}), will retry after ${i[r]/1e3} s`)}}if(n){const e="isAxiosError"in n&&n.isAxiosError?null===(o=null===(r=n.response)||void 0===r?void 0:r.config.headers)||void 0===o?void 0:o[c.REQUEST_ID_HEADER]:"";this.logger.error(`Fetch remote configuration failed after all retries: ${this.safeStringify(n)}`,`${e}`)}this.retrying=!1}async fetchFromCache(e){var t;const r=null!==(t=await this.localStorage.get(u,[]))&&void 0!==t?t:[],o=Date.now(),i=r.findIndex((t=>t.userId===e));if(-1===i)return;const n=r[i];if(o-n.ts<2592e5)return r.splice(i,1),r.push(n),await this.localStorage.set(u,r),this.configuration=n.data,n.data;r.splice(i,1),await this.localStorage.set(u,r)}async fetchFromRemote(e,t){var r,o;const i=await this.restOperations.get(e);return this.configuration=null!==(o=null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.data)&&void 0!==o?o:{},t&&await this.saveCache(t,this.configuration),this.configuration}async saveCache(e,t){var r;const o=null!==(r=await this.localStorage.get(u,[]))&&void 0!==r?r:[],i=o.findIndex((t=>t.userId===e));for(-1!==i&&o.splice(i,1),o.push({userId:e,data:t,ts:Date.now()});o.length>20;)o.shift();await this.localStorage.set(u,o),this.logger.info(`Saving product configuration to cache (LRU): ${this.safeStringify(t)}`,e)}sleep(e){return new Promise((t=>setTimeout(t,e)))}safeStringify(e){try{return JSON.stringify(e)}catch(t){return`${e}`}}};t.CloudProductManagerImpl=l,o([(0,n.Autowired)(n.Logger),i("design:type",Object)],l.prototype,"logger",void 0),o([(0,n.Autowired)(a.RestOperations),i("design:type",Function)],l.prototype,"restOperations",void 0),o([(0,n.Autowired)(s.LocalStorage),i("design:type",Object)],l.prototype,"localStorage",void 0),o([(0,n.Autowired)(s.UserinfoProvider),i("design:type",Object)],l.prototype,"userinfoProvider",void 0),o([(0,n.PostConstruct)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",void 0)],l.prototype,"init",null),t.CloudProductManagerImpl=l=o([(0,n.Component)(d.CloudProductManager)],l)},88137:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},88822:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(n<3?i(a):n>3?i(t,r,a):i(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultProductMerger=void 0;const n=r(15985),a=r(78680);let c=class DefaultProductMerger{async merge(...e){let t={};for(const r of e)for(const e of this.productMergeStrategies)if(await e.support(r)){t=await e.merge(t,r);break}return delete t.mergeStrategy,t}};t.DefaultProductMerger=c,o([(0,n.Autowired)(a.ProductMergeStrategy),i("design:type",Array)],c.prototype,"productMergeStrategies",void 0),t.DefaultProductMerger=c=o([(0,n.Component)(a.ProductMerger)],c)},98670:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},99630:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})}}]);
//# sourceMappingURL=6020.90e90bd8efb6f8f16ee3.js.map