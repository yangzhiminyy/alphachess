"use strict";(self.webpackChunk_genie_chat_webview_app=self.webpackChunk_genie_chat_webview_app||[]).push([[7942],{9670:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.TencentKnowledgeBaseProviderFactory=void 0;const o=r(15985),i=r(72396),a=r(59045);let c=class TencentKnowledgeBaseProviderFactory{async support(e){return e.provider===i.KnowledgeBaseProviderName.Tencent}async create(e){const t=o.ContainerUtil.get(a.TencentKnowledgeBaseProvider);return await t.initialize(e),t}};t.TencentKnowledgeBaseProviderFactory=c,t.TencentKnowledgeBaseProviderFactory=c=n([(0,o.Component)(i.KnowledgeBaseProviderFactory)],c)},11564:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigViewServiceImpl=void 0;const o=r(15985),i=r(60317),a=r(58127),c=r(97317),s=r(76243);let l=class ConfigViewServiceImpl{constructor(){this.observer=new c.Subject}get configService(){return a.RpcUtils.getProxy(i.ConfigService)}async get(e){return this.configService.get(e)}async update(e,t){await this.configService.update(e,t),this.observer.next({key:e,value:t})}onDidChange(e){return this.observer.subscribe(e)}};t.ConfigViewServiceImpl=l,t.ConfigViewServiceImpl=l=n([(0,o.Component)(s.ConfigViewService)],l)},13073:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(72396),t),o(r(92253),t),o(r(9670),t),o(r(59045),t),o(r(74149),t)},15625:function(e,t,r){var n=r(78),o=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.ProductViewServiceImpl=void 0;const i=r(15985),a=r(69022),c=r(58127),s=r(13073),l=r(97317);let d=class ProductViewServiceImpl{constructor(){this.configurationSubject=new l.BehaviorSubject(void 0)}get productService(){return c.RpcUtils.getProxy(a.ProductService)}get knowledgeBaseManager(){return c.RpcUtils.getProxy(s.KnowledgeBaseManager)}async getModels(){var e;return null!==(e=(await this.productService.waitConfiguration()).models)&&void 0!==e?e:[]}async getAgents(){var e;return null!==(e=(await this.productService.waitConfiguration()).agents)&&void 0!==e?e:[]}async getCustomAgents(){var e;return null!==(e=(await this.productService.waitConfiguration()).remoteAgents)&&void 0!==e?e:[]}async getVariables(){var e;const t=await this.productService.waitConfiguration();return null!==(e=null==t?void 0:t.variables)&&void 0!==e?e:[]}async getCommands(){var e;const t=await this.productService.waitConfiguration();return null!==(e=null==t?void 0:t.commands)&&void 0!==e?e:[]}async getKnowledges(){return await this.knowledgeBaseManager.list()}async getPlatform(){var e;return null!==(e=(await this.productService.waitConfiguration()).platform)&&void 0!==e?e:""}async getLinks(){var e;return null!==(e=(await this.productService.waitConfiguration()).links)&&void 0!==e?e:{}}async sync(){await this.productService.sync()}onDidChangeConfiguration(e){return this.configurationSubject.subscribe(e)}onConfigurationChanged(e){this.configurationSubject.next(e),n.log("onConfigurationChanged",e)}};t.ProductViewServiceImpl=d,t.ProductViewServiceImpl=d=o([(0,i.Component)(a.ProductViewService)],d)},27942:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(91635),t),o(r(64412),t),o(r(70766),t),o(r(15625),t),o(r(11564),t),o(r(16333),t)},59045:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.TencentKnowledgeBaseProvider=void 0;const i=r(15985),a=r(56464),c=r(25079),s=r(26020),l=r(15076),d=r(72396);let u=class TencentKnowledgeBaseProvider{constructor(){this.configuration={},this.listCacheKey="",this.cache=[],this.pureList=(0,l.memoize)((async(e,t)=>{var r;try{const{data:{data:n}}=await this.restOperations.get(t,{baseURL:e});return this.logger.info(`fetch knowledgeBase from remote ,length : ${(null===(r=n.knowledge_bases)||void 0===r?void 0:r.length)||0}`),n.knowledge_bases||[]}catch(r){return this.logger.error(`knowledge base list error: [${e},${t}] ${r}`),[]}finally{setTimeout((()=>{var e,t;null===(t=(e=this.pureList.cache).clear)||void 0===t||t.call(e)}),d.MAX_CACHE_TTL)}}),((...e)=>this.listCacheKey=e.join("-")))}init(){this.logger.setContext("TencentKnowledgeBaseProvider")}async initialize(e){this.configuration=e,await this.list()}async list(){var e,t,r;if(!await this.authenticationManager.waitAuthSession())return[];const{baseURL:n,path:o}=await this.getBaseUrlAndPath(null!==(r=null===(t=null===(e=this.configuration)||void 0===e?void 0:e.attributes)||void 0===t?void 0:t.listPath)&&void 0!==r?r:"/knowledge-bases"),i=await this.pureList(n,o);return this.cache=i,i}sync(){var e,t;null===(t=(e=this.pureList.cache).clear)||void 0===t||t.call(e),this.list()}listSync(){return this.cache}async query(e){var t,r,n;if(!await this.authenticationManager.waitAuthSession())return[];const{baseURL:o,path:i}=await this.getBaseUrlAndPath(null!==(n=null===(r=null===(t=this.configuration)||void 0===t?void 0:t.attributes)||void 0===r?void 0:r.queryPath)&&void 0!==n?n:"/knowledge-bases/{knowledgeBaseId}/query"),a=[],c=await this.pureList.cache.get(this.listCacheKey)||[];if(e.knowledgeBaseIds)for(const t of e.knowledgeBaseIds)c.find((e=>e.id===t))&&a.push(t);if(0===a.length)return[];const s=[];return await Promise.all(a.map((async t=>{var r;const n=i.replace("{knowledgeBaseId}",t);try{const{data:{data:i}}=await this.restOperations.post(n,{query:e.text},{baseURL:o,signal:e.signal});null===(r=i.items)||void 0===r||r.forEach((e=>{e.knowledgeBaseId=t})),s.push(...i.items||[])}catch(e){this.logger.error(`knowledge base query error: [${o},${n}] ${e}`)}}))),s}async getBaseUrlAndPath(e){var t,r;const[n,o]=await Promise.all([this.authenticationManager.waitAuthSession(),this.productManager.waitConfiguration()]),i=this.configuration;let a=o.endpoint||"",c="/v2"+e;if(i.url&&(a=i.url,c=""),null===(t=n.account)||void 0===t?void 0:t.enterpriseId){const t=null===(r=null==i?void 0:i.attributes)||void 0===r?void 0:r.enterprisePath;c=t||`/v2/enterprises/{enterpriseId}${e}`,c=c.replace("{enterpriseId}",n.account.enterpriseId)}return{baseURL:a,path:c}}};t.TencentKnowledgeBaseProvider=u,n([(0,i.Autowired)(s.ProductManager),o("design:type",Object)],u.prototype,"productManager",void 0),n([(0,i.Autowired)(c.AuthenticationManager),o("design:type",Object)],u.prototype,"authenticationManager",void 0),n([(0,i.Autowired)(a.RestOperations),o("design:type",Function)],u.prototype,"restOperations",void 0),n([(0,i.Autowired)(i.Logger),o("design:type",Object)],u.prototype,"logger",void 0),n([(0,i.PostConstruct)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],u.prototype,"init",null),t.TencentKnowledgeBaseProvider=u=n([(0,i.Component)({id:d.KnowledgeBaseProvider,scope:i.Scope.Request})],u)},64412:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.McpViewServiceImpl=void 0;const o=r(15985),i=r(69022),a=r(58127),c=r(97317);let s=class McpViewServiceImpl{constructor(){this.mcpInstallMessage=new c.Subject,this.mcpSettingsListener=new c.Subject}async getMcpMarket(){return a.RpcUtils.getProxy(i.McpAgentDispatcher).getMcpMarket()}async reconnectServer(e){const t=a.RpcUtils.getProxy(i.McpAgentDispatcher);await t.reconnectServer(e)}async onChunk(e){this.mcpInstallMessage.next(e)}async install(e){const t=a.RpcUtils.getProxy(i.McpAgentDispatcher);await t.install(e)}async getMcpServer(e){return a.RpcUtils.getProxy(i.McpAgentDispatcher).getMcpServer(e)}async getInstalledServers(){return a.RpcUtils.getProxy(i.McpAgentDispatcher).getInstalledServers()}async getMcpMarketEnabled(){return a.RpcUtils.getProxy(i.McpAgentDispatcher).getMcpMarketEnabled()}async delServer(e){const t=a.RpcUtils.getProxy(i.McpAgentDispatcher);await t.delServer(e)}async toggleServerStatus(e,t){const r=a.RpcUtils.getProxy(i.McpAgentDispatcher);await r.toggleServerStatus(e,t)}async manualInstallation(e){const t=a.RpcUtils.getProxy(i.McpAgentDispatcher);return await t.manualInstallation(e)}async updateConfigEnv(e,t){const r=a.RpcUtils.getProxy(i.McpAgentDispatcher);await r.updateConfigEnv(e,t)}async openExternal(e){const t=a.RpcUtils.getProxy(i.McpAgentDispatcher);await t.openExternal(e)}async openSettingFile(){const e=a.RpcUtils.getProxy(i.McpAgentDispatcher);await e.openSettingFile()}async serverIsInstalled(e){return(await this.getInstalledServers()).some((t=>t.name===e&&"connected"===t.status))}listenSetting(){this.mcpSettingsListener.next()}clipboardWriteText(e){a.RpcUtils.getProxy(i.McpAgentDispatcher).clipboardWriteText(e)}async getSetting(){const e=a.RpcUtils.getProxy(i.McpAgentDispatcher);return await e.getSetting()}};t.McpViewServiceImpl=s,t.McpViewServiceImpl=s=n([(0,o.Component)(i.McpViewService)],s)},70766:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationProxyImpl=t.AuthenticationProxy=void 0;const o=r(15985),i=r(69022),a=r(58127);t.AuthenticationProxy=Symbol("AuthenticationProxy");let c=class AuthenticationProxyImpl{async login(){a.RpcUtils.getProxy(i.AuthenticationService).login()}async getAccounts(){return a.RpcUtils.getProxy(i.AuthenticationService).getAccounts()}async switchAccount(e){return a.RpcUtils.getProxy(i.AuthenticationService).switchAccount(e)}};t.AuthenticationProxyImpl=c,t.AuthenticationProxyImpl=c=n([(0,o.Component)(t.AuthenticationProxy)],c)},72396:(e,t)=>{var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.KnowledgeBaseType=t.KnowledgeBaseProviderName=t.INITIALIZE_DELAY=t.MAX_CACHE_TTL=t.KnowledgeBaseProviderFactory=t.KnowledgeBaseProvider=t.KnowledgeBaseManager=void 0,t.KnowledgeBaseManager=Symbol("KnowledgeBaseManager"),t.KnowledgeBaseProvider=Symbol("KnowledgeBaseProvider"),t.KnowledgeBaseProviderFactory=Symbol("KnowledgeBaseProviderFactory"),t.MAX_CACHE_TTL=18e5,t.INITIALIZE_DELAY=3e3,function(e){e.Tencent="Tencent"}(r||(t.KnowledgeBaseProviderName=r={})),function(e){e.Custom="custom",e.Common="common"}(n||(t.KnowledgeBaseType=n={}))},74149:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.KnowledgeBaseContextVariableResolver=void 0;const i=r(15985),a=r(63868),c=r(72396);let s=class KnowledgeBaseContextVariableResolver{constructor(){this.name="knowledgeBase"}async priority(e,t){return 5}async resolve(e,t){var r,n;const o=await this.knowledgeBaseManager.query({text:(null===(r=e.resolveOptions)||void 0===r?void 0:r.text)||"",knowledgeBaseIds:(null===(n=null==e?void 0:e.resolveOptions)||void 0===n?void 0:n.knowledgeBaseIds)||[],signal:null==t?void 0:t.signal}),i={};for(const e of o)i[e.knowledgeBaseId]||(i[e.knowledgeBaseId]=[]),i[e.knowledgeBaseId].push(e);const a={name:this.name,value:[]};for(const[e,t]of Object.entries(i))a.value.push({knowledgeBaseId:e,references:t});return a}};t.KnowledgeBaseContextVariableResolver=s,n([(0,i.Autowired)(c.KnowledgeBaseManager),o("design:type",Object)],s.prototype,"knowledgeBaseManager",void 0),t.KnowledgeBaseContextVariableResolver=s=n([(0,i.Component)(a.ContextVariableResolver)],s)},91635:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.FileSearchViewServiceImpl=void 0;const o=r(15985),i=r(69022),a=r(58127),c=r(76243);let s=class FileSearchViewServiceImpl{get service(){return a.RpcUtils.getProxy(i.FileSearchService)}clearRecentOpend(){return this.service.clearRecentOpend()}getRecentFiles(e){return this.service.getRecentFiles(e)}getWorkspaceFiles(e){return this.service.getWorkspaceFiles(e)}openFile(e,t){return this.service.openFile(e,t)}checkWorkspace(e){return this.service.checkWorkspace(e)}createWorkspace(e,t){return this.service.createWorkspace(e,t)}};t.FileSearchViewServiceImpl=s,t.FileSearchViewServiceImpl=s=n([(0,o.Component)({id:c.FileSearchViewService,scope:o.Scope.Request})],s)},92253:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.KnowledgeBaseManagerImpl=void 0;const i=r(15985),a=r(39322),c=r(26020),s=r(72396);let l=class KnowledgeBaseManagerImpl{constructor(){this.knowledgeBaseProviderFactories=[],this.lastKnowledgeBaseConfiguration=[],this.activeKnowledgeBaseProviders=[]}initialize(){this.doInitialize()}async doInitialize(){await(0,i.timeout)(s.INITIALIZE_DELAY),this.productManager.configuration.subscribe((e=>{const t=(null==e?void 0:e.knowledgeBases)||[];a.ObjectUtils.isChanged(this.lastKnowledgeBaseConfiguration,t)&&(this.initKnowledgeBaseProviders(t),this.lastKnowledgeBaseConfiguration=t)})),this.scheduleSync()}async scheduleSync(){await(0,i.timeout)(s.MAX_CACHE_TTL),this.sync(),this.scheduleSync()}sync(){for(const e of this.activeKnowledgeBaseProviders)e.list()}async list(){const e=[];for(const t of this.activeKnowledgeBaseProviders)e.push(...await t.list()||[]);return e}listSync(){const e=[];for(const t of this.activeKnowledgeBaseProviders)e.push(...t.listSync()||[]);return e}async query(e){const t=[];for(const r of this.activeKnowledgeBaseProviders)t.push(...await r.query(e)||[]);return t.sort(((e,t)=>t.score-e.score))}async initKnowledgeBaseProviders(e){const t=[],r=Object.fromEntries(e.filter((e=>e.provider)).map((e=>[e.provider,e])));for(const e of Object.values(r)){const r=await this.createKnowledgeBaseProvider(e);r&&t.push(r)}this.activeKnowledgeBaseProviders=t}async createKnowledgeBaseProvider(e){for(const t of this.knowledgeBaseProviderFactories)if(await t.support(e))return t.create(e)}};t.KnowledgeBaseManagerImpl=l,n([(0,i.Autowired)(c.ProductManager),o("design:type",Object)],l.prototype,"productManager",void 0),n([(0,i.Autowired)(s.KnowledgeBaseProviderFactory),(0,i.Optional)(),o("design:type",Array)],l.prototype,"knowledgeBaseProviderFactories",void 0),t.KnowledgeBaseManagerImpl=l=n([(0,i.Component)(s.KnowledgeBaseManager,i.ApplicationLifecycle)],l)}}]);
//# sourceMappingURL=7942.46e200486e94f44c5d91.js.map